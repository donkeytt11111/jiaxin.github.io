{"singlePage": [], "startSite": "", "filingNum": "", "onePageListNum": 15, "commentLabelColor": "#006b75", "yearColorList": ["#bc4c00", "#0969da", "#1f883d", "#A333D0"], "i18n": "CN", "themeMode": "manual", "dayTheme": "light", "nightTheme": "dark", "urlMode": "pinyin", "script": "", "style": "", "indexScript": "", "indexStyle": "", "bottomText": "", "showPostSource": 1, "iconList": {}, "UTC": 8, "rssSplit": "sentence", "exlink": {}, "title": "\u5218\u4f73\u946b\u7b14\u8bb0", "subTitle": "\u6b22\u8fce\u60a8", "avatarUrl": "https://github.githubassets.com/favicons/favicon.svg", "GMEEK_VERSION": "last", "postListJson": {"P1": {"htmlDir": "docs/post/harbor-zi-dong-hua-la-qu-jing-xiang-fang-an.html", "labels": ["\u90e8\u7f72"], "postTitle": "harbor\u81ea\u52a8\u5316\u62c9\u53d6\u955c\u50cf\u65b9\u6848", "postUrl": "post/harbor-zi-dong-hua-la-qu-jing-xiang-fang-an.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/1", "commentNum": 0, "wordCount": 2315, "description": "grep data_volume  /app/harbor/harbor.yml    #\u6839\u636e\u914d\u7f6e\u6587\u4ef6\u67e5\u627e\u6570\u636e\u5b58\u50a8\u76ee\u5f55\r\ndata_volume: /data\r\n\r\ncd /data/registry     #\u8fdb\u5165\u5230Harbor\u7684\u6570\u636e\u76ee\u5f55\u4e0b\r\n\r\nfind  docker/   -type  d  -name 'current'  | sed  's|docker/registry/v2/repositories/||g;s|/_manifests/tags/|:|g;s|/current||g'  >  images.list\r\n\r\ncat images.list\r\n\r\ncurl https://192.168.2.250:443/api/version  -k\r\n{'version':'v2.0'}\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/2390402e-6803-45a1-bf0d-e99f0347395d)\r\n\r\n\r\n\r\n```shell\r\n#!/bin/bash\r\nHarbor_Address=172.16.1.200       #Harbor\u4e3b\u673a\u5730\u5740\r\nHarbor_User=admin                      #\u767b\u5f55Harbor\u7684\u7528\u6237\r\nHarbor_Passwd=Harbor12345              #\u767b\u5f55Harbor\u7684\u7528\u6237\u5bc6\u7801\r\nImages_File=./images.list   # \u955c\u50cf\u6e05\u5355\u6587\u4ef6\r\nTar_File=/backup/Harbor-backup/                 #\u955c\u50cftar\u5305\u5b58\u653e\u8def\u5f84\r\nset -x\r\n# \u83b7\u53d6Harbor\u4e2d\u6240\u6709\u7684\u9879\u76ee\uff08Projects\uff09\r\nProject_List=$(curl -u admin:Harbor12345  -H 'Content-Type: application/json' -X GET  https://172.16.1.200/api/v2.0/projects  -k  | python3 -m json.tool | grep name | awk '/'name': /' | awk -F ''' '{print $4}')\r\n\r\nfor Project in $Project_List;do\r\n   # \u5faa\u73af\u83b7\u53d6\u9879\u76ee\u4e0b\u6240\u6709\u7684\u955c\u50cf\r\n    Image_Names=$(curl -u admin:Harbor12345 -H 'Content-Type: application/json' -X GET https://172.16.1.200/api/v2.0/projects/$Project/repositories -k | python3 -m json.tool | grep name | awk '/'name': /' | awk -F ''' '{print $4}')\r\n    for Image in $Image_Names;do\r\n        # \u5faa\u73af\u83b7\u53d6\u955c\u50cf\u7684\u7248\u672c\uff08tag)\r\n        Image_Tags=$(curl -u admin:Harbor12345  -H 'Content-Type: application/json'   -X GET  https://172.16.1.200/v2/$Image/tags/list  -k |  awk -F '''  '{print $8,$10,$12}')\r\n       for Tag in $Image_Tags;do\r\n            # \u683c\u5f0f\u5316\u8f93\u51fa\u955c\u50cf\u4fe1\u606f\r\n            echo '$Harbor_Address/$Image:$Tag'   >> harbor-images-`date '+%Y-%m-%d'`.txt\r\n        done\r\n    done\r\ndone\r\nImage_tags=$(uniq $Images_File)\r\nfor image_tag in $Image_tags;do\r\n    image_Name=$(echo $image_tag | awk -F/ '{print $3}' |  awk -F: '{print $1}')\r\n    image_Lable=$(echo $image_tag | awk -F/ '{print $3}' |  awk -F: '{print $2}')\r\n    #image_Name=$(echo $image_tag | awk -F ' +' '{print $1}')\r\n    #image_Lable=$(echo $image_tag | awk -F ' +' '{print $2}')\r\n    docker pull 172.16.1.200/$image_tag\r\n    docker tag  172.16.1.200/$image_tag $image_tag\r\n    docker save $image_tag  -o $image_Name.tar\r\n    docker rmi  172.16.1.200/$image_tag\r\n    docker rmi  $image_tag\r\n    mv $image_Name.tar  $Tar_File\r\ndone\u3002", "top": 0, "createdAt": 1717483058, "style": "", "script": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-04", "dateLabelColor": "#bc4c00"}, "P2": {"htmlDir": "docs/post/PXE-xi-tong-bu-shu.html", "labels": ["\u90e8\u7f72"], "postTitle": "PXE\u7cfb\u7edf\u90e8\u7f72", "postUrl": "post/PXE-xi-tong-bu-shu.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/2", "commentNum": 0, "wordCount": 2057, "description": "\u2727 \u4f7f\u7528http\u7528\u6765\u53d1\u5e03linux\u7cfb\u7edf\u7684\u5b89\u88c5\u6811\uff08\u4e5f\u53ef\u4ee5\u4f7f\u7528NFS\u3001FTP server\u6216HTTPS\uff09\r\n\u2727 DHCP server\u4e3a\u5ba2\u6237\u7aef\u5206\u914dip\u5e76\u63d0\u4f9bTFTP\u670d\u52a1\u5668\u5730\u5740\u53caPXE\u542f\u52a8\u6587\u4ef6\u4f4d\u7f6e\r\n\u2727 TFTP server\u4e3a\u5ba2\u6237\u7aef\u63d0\u4f9b\u5f15\u5bfc\u6587\u4ef6\u3002", "top": 0, "createdAt": 1717492033, "style": "", "script": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-04", "dateLabelColor": "#bc4c00"}}, "singeListJson": {}, "labelColorDict": {"help wanted": "#008672", "invalid": "#e4e669", "question": "#d876e3", "wontfix": "#ffffff", "\u57f9\u8bad": "#7057ff", "\u90e8\u7f72": "#a2eeef"}, "displayTitle": "\u5218\u4f73\u946b\u7b14\u8bb0", "faviconUrl": "https://github.githubassets.com/favicons/favicon.svg", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "homeUrl": "https://donkeytt11111.github.io/jiaxin.github.io", "prevUrl": "disabled", "nextUrl": "disabled"}