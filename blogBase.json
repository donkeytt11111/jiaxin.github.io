{"singlePage": [], "startSite": "", "filingNum": "", "onePageListNum": 15, "commentLabelColor": "#006b75", "yearColorList": ["#bc4c00", "#0969da", "#1f883d", "#A333D0"], "i18n": "CN", "themeMode": "manual", "dayTheme": "light", "nightTheme": "dark", "urlMode": "pinyin", "script": "", "style": "", "head": "", "indexScript": "", "indexStyle": "", "bottomText": "", "showPostSource": 1, "iconList": {}, "UTC": 8, "rssSplit": "sentence", "exlink": {}, "needComment": 1, "allHead": "", "title": "\u5218\u4f73\u946b\u7b14\u8bb0", "subTitle": "\u6b22\u8fce\u60a8", "avatarUrl": "https://github.githubassets.com/favicons/favicon.svg", "GMEEK_VERSION": "last", "postListJson": {"P1": {"htmlDir": "docs/post/harbor-zi-dong-hua-la-qu-jing-xiang-fang-an.html", "labels": ["shell", "\u95ee\u9898\u89e3\u51b3\u65b9\u6848", "DevOps", "\u7cfb\u7edf\u67b6\u6784"], "postTitle": "harbor\u81ea\u52a8\u5316\u62c9\u53d6\u955c\u50cf\u65b9\u6848", "postUrl": "post/harbor-zi-dong-hua-la-qu-jing-xiang-fang-an.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/1", "commentNum": 0, "wordCount": 3422, "description": "grep data_volume  /app/harbor/harbor.yml    #\u6839\u636e\u914d\u7f6e\u6587\u4ef6\u67e5\u627e\u6570\u636e\u5b58\u50a8\u76ee\u5f55\r\ndata_volume: /data\r\n\r\ncd /data/registry     #\u8fdb\u5165\u5230Harbor\u7684\u6570\u636e\u76ee\u5f55\u4e0b\r\n\r\nfind  docker/   -type  d  -name 'current'  | sed  's|docker/registry/v2/repositories/||g;s|/_manifests/tags/|:|g;s|/current||g'  >  images.list\r\n\r\ncat images.list\r\n \r\ncurl https://192.168.2.250:443/api/version  -k\r\n{'version':'v2.0'}\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/2390402e-6803-45a1-bf0d-e99f0347395d)\r\n\r\n\r\n\r\n```shell\r\n#!/bin/bash\r\nHarbor_Address=172.16.1.200       #Harbor\u4e3b\u673a\u5730\u5740\r\nHarbor_User=admin                      #\u767b\u5f55Harbor\u7684\u7528\u6237\r\nHarbor_Passwd=Harbor12345              #\u767b\u5f55Harbor\u7684\u7528\u6237\u5bc6\u7801\r\nImages_File=./images.list   # \u955c\u50cf\u6e05\u5355\u6587\u4ef6\r\nTar_File=/backup/Harbor-backup/                 #\u955c\u50cftar\u5305\u5b58\u653e\u8def\u5f84\r\nset -x\r\n# \u83b7\u53d6Harbor\u4e2d\u6240\u6709\u7684\u9879\u76ee\uff08Projects\uff09\r\nProject_List=$(curl -u admin:Harbor12345  -H 'Content-Type: application/json' -X GET  https://172.16.1.200/api/v2.0/projects  -k  | python3 -m json.tool | grep name | awk '/'name': /' | awk -F ''' '{print $4}')\r\n\r\nfor Project in $Project_List;do\r\n   # \u5faa\u73af\u83b7\u53d6\u9879\u76ee\u4e0b\u6240\u6709\u7684\u955c\u50cf\r\n    Image_Names=$(curl -u admin:Harbor12345 -H 'Content-Type: application/json' -X GET https://172.16.1.200/api/v2.0/projects/$Project/repositories -k | python3 -m json.tool | grep name | awk '/'name': /' | awk -F ''' '{print $4}')\r\n    for Image in $Image_Names;do\r\n        # \u5faa\u73af\u83b7\u53d6\u955c\u50cf\u7684\u7248\u672c\uff08tag)\r\n        Image_Tags=$(curl -u admin:Harbor12345  -H 'Content-Type: application/json'   -X GET  https://172.16.1.200/v2/$Image/tags/list  -k |  awk -F '''  '{print $8,$10,$12}')\r\n       for Tag in $Image_Tags;do\r\n            # \u683c\u5f0f\u5316\u8f93\u51fa\u955c\u50cf\u4fe1\u606f\r\n            echo '$Harbor_Address/$Image:$Tag'   >> harbor-images-`date '+%Y-%m-%d'`.txt\r\n        done\r\n    done\r\ndone\r\nImage_tags=$(uniq $Images_File)\r\nfor image_tag in $Image_tags;do\r\n    image_Name=$(echo $image_tag | awk -F/ '{print $3}' |  awk -F: '{print $1}')\r\n    image_Lable=$(echo $image_tag | awk -F/ '{print $3}' |  awk -F: '{print $2}')\r\n    #image_Name=$(echo $image_tag | awk -F ' +' '{print $1}')\r\n    #image_Lable=$(echo $image_tag | awk -F ' +' '{print $2}')\r\n    docker pull 172.16.1.200/$image_tag\r\n    docker tag  172.16.1.200/$image_tag $image_tag\r\n    docker save $image_tag  -o $image_Name.tar\r\n    docker rmi  172.16.1.200/$image_tag\r\n    docker rmi  $image_tag\r\n    mv $image_Name.tar  $Tar_File\r\ndone\r\n```\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/cdad1ceb-eb50-42ab-b84e-7e6fe15f9cb1)\r\n\r\n\ud83d\udc4d \r\n\u5c06errorlist\u6587\u4ef6\u4fee\u6539\u4e3a\u955c\u50cf\u4ed3\u5e93\u5730\u5740\r\n\r\n\u4f7f\u7528\u4ee5\u4e0b\u811a\u672c\u5b8c\u6210errorimage\u62c9\u53d6\r\n\r\n```shell\r\n#!/bin/bash\r\n\r\n# \u4ece\u6587\u4ef6\u8bfb\u53d6\u955c\u50cf\u5217\u8868\r\nwhile IFS= read -r image; do\r\n    echo '\u6b63\u5728\u62c9\u53d6\u955c\u50cf: $image'\r\n    docker pull '$image'\r\n\r\n    # \u6b63\u786e\u63d0\u53d6\u57df\u540d\u540e\u9762\u76f4\u5230\u6807\u7b7e\u524d\u7684\u90e8\u5206\uff08\u4fdd\u7559\u659c\u6760\u540e\u7684\u6240\u6709\u5185\u5bb9\u76f4\u5230\u5192\u53f7\uff09\r\n    new_repo_name=$(echo '$image' | cut -d/ -f2- | cut -d: -f1)\r\n    new_tag_name=$(echo '$new_repo_name' | awk -F/ '{print $NF}')\r\n    echo '$new_repo_name'\r\n    echo '$new_tag_name'\r\n    version=$(echo '$image' | awk -F: '{print $NF}') # \u83b7\u53d6\u7248\u672c\u53f7\r\n\r\n    # \u6784\u5efa\u65b0\u7684\u6807\u7b7e\uff08\u5305\u542b\u5b8c\u6574\u8def\u5f84\u548c\u7248\u672c\u53f7\uff09\r\n    new_tag='${new_repo_name}:${version}'\r\n    \r\n    echo '\u4e3a\u955c\u50cf\u6253\u6807\u7b7e: $image -> $new_tag'\r\n    docker tag '$image' '$new_tag'\r\n\r\n    echo '\u5bfc\u51fa\u955c\u50cf\u4e3atar\u5305: $new_tag'\r\n    docker save '$new_tag' > '/backup/Harbor-backup/${new_tag_name}_${version}.tar'\r\n\r\n    # \u5220\u9664\u539f\u955c\u50cf\uff08\u6839\u636e\u9700\u8981\u53ef\u9009\u62e9\u6027\u6267\u884c\u6b64\u6b65\u9aa4\uff09\r\n    echo '\u5220\u9664\u539f\u955c\u50cf: $image'\r\n    docker rmi '$image'\r\n    docker rmi '$new_tag'\r\ndone < error_images.txt\r\n\r\n# \u68c0\u67e5\u662f\u5426\u6709\u4efb\u4f55\u64cd\u4f5c\u5931\u8d25\r\nif [ $? -eq 0 ]; then\r\n    echo '\u6240\u6709\u955c\u50cf\u5df2\u6210\u529f\u5904\u7406\u5e76\u5907\u4efd\u3002", "top": 0, "createdAt": 1717483058, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-04", "dateLabelColor": "#bc4c00"}, "P2": {"htmlDir": "docs/post/PXE-xi-tong-bu-shu.html", "labels": ["\u90e8\u7f72"], "postTitle": "PXE\u7cfb\u7edf\u90e8\u7f72", "postUrl": "post/PXE-xi-tong-bu-shu.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/2", "commentNum": 0, "wordCount": 2057, "description": "\u2727 \u4f7f\u7528http\u7528\u6765\u53d1\u5e03linux\u7cfb\u7edf\u7684\u5b89\u88c5\u6811\uff08\u4e5f\u53ef\u4ee5\u4f7f\u7528NFS\u3001FTP server\u6216HTTPS\uff09\r\n\u2727 DHCP server\u4e3a\u5ba2\u6237\u7aef\u5206\u914dip\u5e76\u63d0\u4f9bTFTP\u670d\u52a1\u5668\u5730\u5740\u53caPXE\u542f\u52a8\u6587\u4ef6\u4f4d\u7f6e\r\n\u2727 TFTP server\u4e3a\u5ba2\u6237\u7aef\u63d0\u4f9b\u5f15\u5bfc\u6587\u4ef6\u3002", "top": 0, "createdAt": 1717492033, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-04", "dateLabelColor": "#bc4c00"}, "P3": {"htmlDir": "docs/post/Gitlab-bu-shu.html", "labels": ["\u90e8\u7f72", "yaml"], "postTitle": "Gitlab\u90e8\u7f72", "postUrl": "post/Gitlab-bu-shu.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/3", "commentNum": 0, "wordCount": 739, "description": "vim /etc/ssh/sshd_config\r\nPort = 2424\r\n\r\nsystemctl restart sshd\r\n\r\nmkdir -p /srv/gitlab\r\n\r\nexport GITLAB_HOME=/srv/gitlab\r\n\r\n```golang\r\n\r\nversion: '3.6'\r\nservices:\r\n  gitlab:\r\n    image: gitlab/gitlab-ce:latest\r\n    container_name: gitlab\r\n    restart: always\r\n    hostname: '172.16.8.3'\r\n    environment:\r\n      GITLAB_OMNIBUS_CONFIG: |\r\n        external_url 'http://172.16.8.3:8929'\r\n        gitlab_rails['gitlab_shell_ssh_port'] = 2424\r\n    ports:\r\n      - '8929:8929'\r\n      - '4443:443'\r\n      - '2424:22'\r\n    volumes:\r\n      - '/srv/config:/etc/gitlab'\r\n      - '/srv/logs:/var/log/gitlab'\r\n      - '/srv/data:/var/opt/gitlab'\r\n    shm_size: '256m'\r\n\r\nsudo docker exec -it gitlab grep 'Password:' /etc/gitlab/initial_root_password\r\n\u3002", "top": 0, "createdAt": 1717547991, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-05", "dateLabelColor": "#bc4c00"}, "P4": {"htmlDir": "docs/post/jenkins-bu-shu.html", "labels": ["\u90e8\u7f72"], "postTitle": "jenkins\u90e8\u7f72", "postUrl": "post/jenkins-bu-shu.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/4", "commentNum": 0, "wordCount": 247, "description": "docker pull jenkins/jenkins\r\n\r\ndocker run \\\r\n  -u root \\\r\n  --rm \\\r\n  -d \\\r\n  -p 8080:8080 \\\r\n  -p 50000:50000 \\\r\n  -v jenkins-data:/var/jenkins_home \\\r\n  -v /var/run/docker.sock:/var/run/docker.sock \\\r\n  --name jenkins \\\r\n  jenkins/jenkins:latest\u3002", "top": 0, "createdAt": 1717548104, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-05", "dateLabelColor": "#bc4c00"}, "P5": {"htmlDir": "docs/post/K8S-ji-qun-IP-qian-yi-fang-an.html", "labels": ["\u95ee\u9898\u89e3\u51b3\u65b9\u6848", "K8S"], "postTitle": "K8S\u96c6\u7fa4IP\u8fc1\u79fb\u65b9\u6848", "postUrl": "post/K8S-ji-qun-IP-qian-yi-fang-an.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/5", "commentNum": 0, "wordCount": 866, "description": "![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/df4eac8d-85f4-4e83-bc69-c4b2f34ef6e0)\r\n\ud83d\udc4d \u5148\u4fee\u6539master3\r\n\ud83d\udc4d :%s/172.16.8.70/172.16.102.70/g\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/44e9920b-3a94-45bf-bc96-d3d7ccc9ff9f)\r\n\ud83d\udc4d \u65b0\u589e\r\nmaster2 master1 \u540c\u7406\r\n\ud83d\udc4d master1\u6ce8\u610fnetwork\u4e0b\u9762\u7684IP\u8981\u6539\u56de\u4e4b\u524d\u7684\u53c2\u7167\u4e0b\u56fe(\u56e0\u4e3a\u5168\u5c40\u66ff\u6362\u4e86)\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/ca265ed9-9a8b-498d-9066-ae19f96467de)\r\n\ud83d\udc4d \u5c06 /root/.tallos \u548ckube \u6539\u4e3a\u65b0\u8282\u70b9master1\u7684IP\r\n\ud83d\udc4d kubectl edit configmap  cluster-config -n kube-system \u5c06IP\u6539\u4e3a\u65b0\u5730\u5740IP\r\n\ud83d\udc4d talosctl reboot -n ms1,ms2,ms3(IP)\r\n\ud83d\udc4d \u91cd\u542f\u5b8c\u6210\u540e\uff0c\u5c06\u7f51\u5173\u4fee\u6539\u65b0\u7684\u7f51\u5173\uff0c\u65e7IP\u5220\u9664\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/814dcc35-22fd-429f-bd60-ac0b7417fe18)\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/817a5bf1-9c84-434c-8d4e-caa9e35205ce)\r\n\u3002", "top": 0, "createdAt": 1717565217, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-05", "dateLabelColor": "#bc4c00"}, "P6": {"htmlDir": "docs/post/email.html", "labels": ["shell"], "postTitle": "email", "postUrl": "post/email.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/6", "commentNum": 0, "wordCount": 4881, "description": "```shell\r\n#!/bin/bash\r\n\r\n\r\n\r\n# \u53d1\u9001\u90ae\u4ef6\u65b9\u6cd5\r\nfunction send_config_files_by_email() {\r\n    project_name=$1\r\n\r\n    echo '\u8bf7\u8f93\u5165\u4f60\u90e8\u7f72\u7684\u9879\u76ee\u7684\u540d\u5b57\uff0c\u82f1\u6587\uff0c\u82e5\u8f93\u5165\u9519\u8bef \u8bf7\u7528ctrl+w\u64a4\u56de\u540e\u91cd\u65b0\u8f93\u5165'\r\n    read project_name\r\n\r\n    # \u5b9a\u4e49\u63a5\u6536\u8005\u5217\u8868\r\n    recipients=('1553232697@qq.com' '18640549232@163.com' '442283241@qq.com' '2505584859@qq.com' '1223645860@qq.com')\r\n\r\n    # \u5b9a\u4e49\u8981\u53d1\u9001\u7684\u914d\u7f6e\u6587\u4ef6\u5217\u8868\r\n    config_files=('/root/.kube/config' '/root/.talos/config')\r\n\r\n    # \u5b89\u88c5msmtp\u548cmailx\r\n    install_deps() {\r\n        if command -v yum &> /dev/null; then\r\n            echo '\u6b63\u5728\u4e3aCentOS/RHEL\u7cfb\u7edf\u5b89\u88c5\u5fc5\u8981\u8f6f\u4ef6...'\r\n            sudo yum install -y msmtp ca-certificates mailx\r\n        else\r\n            echo '\u65e0\u6cd5\u8bc6\u522b\u7684\u5305\u7ba1\u7406\u5668\uff0c\u8bf7\u624b\u52a8\u5b89\u88c5msmtp\u548cmailx\u3002", "top": 0, "createdAt": 1717571466, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-05", "dateLabelColor": "#bc4c00"}, "P7": {"htmlDir": "docs/post/hb_docker.sh.html", "labels": ["Docker"], "postTitle": "hb_docker.sh", "postUrl": "post/hb_docker.sh.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/7", "commentNum": 0, "wordCount": 2152, "description": "```shell\r\n#!/bin/bash\r\nHarbor_Address=172.16.1.200       #Harbor\u4e3b\u673a\u5730\u5740\r\nHarbor_User=admin                      #\u767b\u5f55Harbor\u7684\u7528\u6237\r\nHarbor_Passwd=Harbor12345              #\u767b\u5f55Harbor\u7684\u7528\u6237\u5bc6\u7801\r\nImages_File=./images.list      # \u955c\u50cf\u6e05\u5355\u6587\u4ef6\r\nTar_File=/backup/Harbor-backup/                 #\u955c\u50cftar\u5305\u5b58\u653e\u8def\u5f84\r\nset -x\r\n\r\n# \u83b7\u53d6Harbor\u4e2d\u6240\u6709\u7684\u9879\u76ee\uff08Projects\uff09\r\nProject_List=$(curl -u admin:Harbor12345  -H 'Content-Type: application/json' -X GET  https://$Harbor_Address/api/v2.0/projects  -k  | python3 -m json.tool | grep name | awk '/'name': /' | awk -F ''' '{print $4}')\r\n\r\nfor Project in $Project_List;do\r\n   # \u5faa\u73af\u83b7\u53d6\u9879\u76ee\u4e0b\u6240\u6709\u7684\u955c\u50cf\r\n    Image_Names=$(curl -u admin:Harbor12345 -H 'Content-Type: application/json' -X GET https://$Harbor_Address/api/v2.0/projects/$Project/repositories -k | python3 -m json.tool | grep name | awk '/'name': /' | awk -F ''' '{print $4}')\r\n    for Image in $Image_Names;do\r\n        # \u5faa\u73af\u83b7\u53d6\u955c\u50cf\u7684\u7248\u672c\uff08tag)\r\n        Image_Tags=$(curl -u admin:Harbor12345  -H 'Content-Type: application/json'   -X GET  https://$Harbor_Address/v2/$Image/tags/list  -k |  awk -F '''  '{print $8,$10,$12}')\r\n       for Tag in $Image_Tags;do\r\n            # \u683c\u5f0f\u5316\u8f93\u51fa\u955c\u50cf\u4fe1\u606f\r\n            echo '$Harbor_Address/$Image:$Tag'   >> harbor-images-`date '+%Y-%m-%d'`.txt\r\n        done\r\n    done\r\ndone\r\n\r\n# \u8bfb\u53d6Images_File\u6587\u4ef6\u4e2d\u7684\u955c\u50cf\u540d\u79f0\r\nwhile read -r image_tag; do\r\n    # \u4f7f\u7528awk\u63d0\u53d6\u955c\u50cf\u540d\u79f0\u548c\u6807\u7b7e\uff0c\u540c\u65f6\u5904\u7406\u7279\u6b8a\u5b57\u7b26\r\n    image_Name=$(echo $image_tag | awk -F/ '{print $3}' |  awk -F: '{print $1}' | sed 's/\\//-/g')\r\n    image_Lable=$(echo $image_tag | awk -F/ '{print $3}' |  awk -F: '{print $2}' | sed 's/:/_/g')\r\n\r\n    # \u68c0\u67e5image_Name\u548cimage_Lable\u662f\u5426\u4e3a\u7a7a\r\n    if [ -z '$image_Name' ]; then\r\n        echo 'Error: Empty image_Name for $image_tag' >> error_images.txt\r\n        continue\r\n    fi\r\n    if [ -z '$image_Lable' ]; then\r\n        echo 'Error: Empty image_Lable for $image_tag' >> error_images.txt\r\n        continue\r\n    fi\r\n\r\n    # \u521b\u5efa\u5b89\u5168\u7684\u6587\u4ef6\u540d\r\n    image_save='$image_Name-$image_Lable'\r\n\r\n    docker pull $Harbor_Address/$image_tag\r\n    docker tag $Harbor_Address/$image_tag $image_tag\r\n    docker save $image_tag -o '$Tar_File/$image_save.tar'\r\n    docker rmi $Harbor_Address/$image_tag\r\n    docker rmi $image_tag\r\ndone < '$Images_File'\r\n\u3002", "top": 0, "createdAt": 1717571817, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-05", "dateLabelColor": "#bc4c00"}, "P8": {"htmlDir": "docs/post/ji-qun-zheng-shu-ti-huan-fang-an.html", "labels": ["\u95ee\u9898\u89e3\u51b3\u65b9\u6848", "K8S"], "postTitle": "\u96c6\u7fa4\u8bc1\u4e66\u66ff\u6362\u65b9\u6848", "postUrl": "post/ji-qun-zheng-shu-ti-huan-fang-an.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/8", "commentNum": 0, "wordCount": 265, "description": "\u5148\u770b\u662f\u51e0\u4e2a\u8282\u70b9\u7684\u96c6\u7fa4\uff0c\u9700\u8981\u5728\u6bcf\u4e2a\u8282\u70b9\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\u3002", "top": 0, "createdAt": 1717639228, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-06", "dateLabelColor": "#bc4c00"}, "P9": {"htmlDir": "docs/post/ji-qun-kuai-zhao-bei-fen.html", "labels": ["K8S"], "postTitle": "\u96c6\u7fa4\u5feb\u7167\u5907\u4efd", "postUrl": "post/ji-qun-kuai-zhao-bei-fen.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/9", "commentNum": 0, "wordCount": 962, "description": "snap install yq\r\n\r\n#\u521b\u5efaetcd\u8282\u70b9\u6570\u636e\u5e93\u5907\u4efd\r\ntalosctl -n 172.16.8.70 etcd snapshot db.snapshot\r\n\r\n#\u82e5etcd\u72b6\u6001\u5f02\u5e38\u5219\u901a\u8fc7\u76ee\u5f55\u6302\u8f7d\u65b9\u5f0f\u5907\u4efd\u5feb\u7167\r\ntalosctl -n 172.16.8.70 cp /var/lib/etcd/member/snap/db .\r\n\r\n#\u5907\u4efdyaml\u6587\u4ef6\r\ntalosctl -n 172.16.8.70 get mc v1alpha1 -o yaml | yq eval '.spec' - > machine_config.yaml\r\n\r\n\u786e\u4fdd\u6ca1\u6709\u5177\u6709\u673a\u5668\u7c7b\u578b\u7684\u63a7\u5236\u5e73\u9762\u8282\u70b9init\uff1a\r\n\r\ntalosctl -n 172.16.8.70,172.16.8.71,172.16.8.72 get machinetype\r\nNODE         NAMESPACE   TYPE          ID             VERSION   TYPE\r\n172.20.0.2   config      MachineType   machine-type   2         controlplane\r\n172.20.0.4   config      MachineType   machine-type   2         controlplane\r\n172.20.0.3   config      MachineType   machine-type   2         controlplane\r\n\r\n#\u91cd\u7f6e\u5e76\u91cd\u542f\r\ntalosctl -n 172.16.8.70 reset --graceful=false --reboot --system-labels-to-wipe=EPHEMERAL\r\n\r\n#\u6062\u590d\u5907\u4efd\r\ntalosctl -n 172.16.8.70 bootstrap --recover-from=./db.snapshot\r\n\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/f5dfde30-bce8-4ff7-900b-f5d99af109ac)\u3002", "top": 0, "createdAt": 1717641037, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-06", "dateLabelColor": "#bc4c00"}, "P10": {"htmlDir": "docs/post/helm-zhuan-yaml-fang-fa.html", "labels": ["K8S"], "postTitle": "helm\u8f6cyaml\u65b9\u6cd5", "postUrl": "post/helm-zhuan-yaml-fang-fa.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/10", "commentNum": 0, "wordCount": 2215, "description": "#1.\u9996\u5148\u9700\u8981\u4e00\u4e2ahttp\u670d\u52a1\u5668\uff0c\u901a\u8fc7docker\u6216\u8005\u5728centos\u4e0a\u76f4\u63a5yum install \u90e8\u7f72\u90fd\u53ef\u4ee5\r\ndocker run -d -p 8081:80 -v /var/www:/usr/local/apache2/htdocs httpd\r\n\u8fd9\u4e2adocker\u547d\u4ee4\u4f1a\u521b\u5efa\u5e76\u8fd0\u884c\u4e00\u4e2ahttpd\u5bb9\u5668,\u53c2\u6570\u8bf4\u660e\u5982\u4e0b: \r\n\r\n-d: \u540e\u53f0\u8fd0\u884c\u5bb9\u5668\r\n-p 8081:80: \u6620\u5c04\u5bb9\u5668\u518580\u7aef\u53e3\u5230\u5bbf\u4e3b\u673a8081\u7aef\u53e3\r\n-v /var/www:/usr/local/apache2/htdocs: \u628a\u5bbf\u4e3b\u673a/var/www\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684/usr/local/apache2/htdocs,\u4f5c\u4e3a\u7f51\u9875\u6587\u6863\u6839\u76ee\u5f55\r\nhttpd: \u4f7f\u7528httpd\u955c\u50cf\u542f\u52a8\u5bb9\u5668\r\n\u8fd9\u6837\u5c31\u5728\u5bbf\u4e3b\u673a8081\u7aef\u53e3\u542f\u52a8\u4e86\u4e00\u4e2ahttpd\u670d\u52a1\u5668,\u7f51\u9875\u6587\u6863\u6765\u81ea\u5bbf\u4e3b\u673a\u7684/var/www\u76ee\u5f55\u3002", "top": 0, "createdAt": 1717641376, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-06", "dateLabelColor": "#bc4c00"}, "P11": {"htmlDir": "docs/post/shan-dao-bu-shu.html", "labels": ["\u90e8\u7f72"], "postTitle": "\u7985\u9053\u90e8\u7f72", "postUrl": "post/shan-dao-bu-shu.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/11", "commentNum": 0, "wordCount": 341, "description": "docker pull hub.zentao.net/app/zentao:18.5 \r\n\r\n\r\n\r\ndocker run \\\r\n--name zentao \\\r\n-p 80:8888 \\\r\n--network=tt \\\r\n-v /data/zentao:/home/ljx/data \\\r\n-e MYSQL_INTERNAL=true \\\r\nhub.zentao.net/app/zentao:18.5\r\n\r\n\r\n\r\ndocker run -d -v /home/data:/data -p 8888:80 -e MYSQL_INTERNAL=true hub.zentao.net/app/zentao:18.5\r\n\r\nhttp://120.46.211.167:8888/\r\n\u3002", "top": 0, "createdAt": 1717641639, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-06", "dateLabelColor": "#bc4c00"}, "P12": {"htmlDir": "docs/post/harbor-bu-shu.html", "labels": ["\u90e8\u7f72"], "postTitle": "harbor\u90e8\u7f72", "postUrl": "post/harbor-bu-shu.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/12", "commentNum": 0, "wordCount": 1424, "description": "wget https://github.com/goharbor/harbor/releases/download/v2.11.0/harbor-offline-installer-v2.11.0.tgz\r\n\u89e3\u538b\u538b\u7f29\u5305\r\n\u590d\u5236compose\u6587\u4ef6\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/fcc2629c-8bd9-4889-97b3-c4c5cf1e88a0)\r\n#\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u7aef\u53e3\u548chostname\r\nvim harbor.yml\r\n\ud83d\udc4d \r\n# \u751f\u6210\u79c1\u94a5\r\nopenssl genrsa -out 172.16.8.3.key 2048\r\n# \u751f\u6210CSR\uff08\u8bc1\u4e66\u7b7e\u7f72\u8bf7\u6c42\uff09\r\nopenssl req -new -key 172.16.8.3.key -out 172.16.8.3.csr\r\n# \u7528\u79c1\u94a5\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\r\nopenssl x509 -req -days 365 -in 172.16.8.3.csr -signkey 172.16.8.3.key -out 172.16.8.3.crt\r\n\r\n\ud83d\udcaf #\u65b0\u7248\u4fee\u590d\r\nopenssl x509 -req -days 365 -in 172.16.8.3.csr -CA 172.16.8.3.crt -CAkey 172.16.8.3.key -set_serial 01 -out 172.16.8.3.crt -extfile <(echo -e 'subjectAltName = IP:172.16.8.3')\r\n\ud83d\udc4d \r\n#\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\r\nhttps:\r\n  enabled: true\r\n  port: 443\r\n  certificate: /home/test/harbor/harbor/172.16.8.3.crt\r\n  private_key: /home/test/harbor/harbor/172.16.8.3.key\r\n\ud83d\udc4d \r\n#\u6267\u884c\u811a\u672c\r\n./prepre\r\n\ud83d\udc4d \r\n#\u6267\u884c\u5b89\u88c5\u811a\u672c\r\ninstall\r\n#\u914d\u7f6e\u767b\u5f55\u6a21\u5757\r\nsudo tee /etc/docker/daemon.json <<-'EOF'\r\n> {\r\n> 'insecure-registries':['172.16.8.3']\r\n> }\r\n> EOF\r\n\ud83d\udc4d \u5bc6\u94a5\u65b9\u6cd5\r\n\u751f\u6210\r\nopenssl genpkey -algorithm RSA -out 10.42.13.200.key -pkeyopt rsa_keygen_bits:2048\r\n\u751f\u6210csr\r\nopenssl req -new -key 10.42.13.200.key -out 10.42.13.200.csr -subj '/C=XX/ST=State/L=Location/O=Organization/OU=OrganizationalUnit/CN=10.42.13.200'\r\n\u751f\u6210\u8bc1\u4e66\r\nopenssl x509 -req -days 365 -in 10.42.13.200.csr -signkey 10.42.13.200.key -out 10.42.13.200.crt -extfile <(echo 'subjectAltName = IP:10.42.13.200')\r\n\r\n\u3002", "top": 0, "createdAt": 1717745066, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-07", "dateLabelColor": "#bc4c00"}, "P13": {"htmlDir": "docs/post/k8s_delete.sh.html", "labels": ["K8S"], "postTitle": "k8s_delete.sh", "postUrl": "post/k8s_delete.sh.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/13", "commentNum": 0, "wordCount": 821, "description": "```shell\r\n#!/bin/bash\r\nfunction delete_pods_by_status {\r\n    local namespace='$1'\r\n    local status='$2'\r\n    kubectl -n '$namespace' get pods | grep '$status' | awk '{print $1}' | xargs kubectl -n '$namespace' delete pods\r\n}\r\n\r\n#ERROR\r\ndelete_pods_by_status 'default' 'Error'\r\ndelete_pods_by_status 'cncp-system' 'Error'\r\ndelete_pods_by_status 'metallb-system' 'Error'\r\ndelete_pods_by_status 'kubernetes-dashboard' 'Error'\r\ndelete_pods_by_status 'openebs' 'Error'\r\ndelete_pods_by_status 'kube-system' 'Error'\r\n\r\n#completed\r\ndelete_pods_by_status 'default' 'Completed'\r\ndelete_pods_by_status 'cncp-system' 'Completed'\r\ndelete_pods_by_status 'metallb-system' 'Completed'\r\ndelete_pods_by_status 'kubernetes-dashboard' 'Completed'\r\ndelete_pods_by_status 'openebs' 'Completed'\r\ndelete_pods_by_status 'kube-system' 'Completed'\u3002", "top": 0, "createdAt": 1717751267, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-07", "dateLabelColor": "#bc4c00"}, "P14": {"htmlDir": "docs/post/talos_master.html", "labels": ["shell"], "postTitle": "talos_master", "postUrl": "post/talos_master.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/14", "commentNum": 0, "wordCount": 7183, "description": "```shell\r\n#!/bin/bash\r\n# \u53c2\u6570\u68c0\u67e5\r\ntalosctl_version='talosctl version'\r\ntalosctl_service='talosctl service'\r\ncommand_jiqun='talosctl kubeconfig'\r\nkubectl_version='kubectl get pods -A'\r\n#\u751f\u6210\u914d\u7f6e\u6587\u4ef6\r\ncommand_token='talosctl  gen  config  mingyang https://172.16.102.102:6443  --config-patch-control-plane @patch.yaml --config-patch-worker @patch-worker.yaml'\r\nall_file_name=*\r\npatch_name=patch*\r\nk8s_path=/home/k8s\r\nfailpath=/opt\r\njituan_path=$1\r\ntalos_path=$2\r\ncncp_path=$3\r\nipv46_patch=$4\r\nlinshi_ip=$5\r\ntalos_cfg=$6\r\ndel_jt=${failpath}/${jituan_path}\r\nctrl_file=${failpath}/${jituan_path}/${talos_path}/controlplane.yaml\r\ntaloscfg_file=${failpath}/${jituan_path}/${talos_path}/talosconfig\r\ntalos_file_path=${failpath}/${jituan_path}/${talos_path}\r\n\r\n\r\n# \u68c0\u67e5\u53c2\u6570\u4e2a\u6570\u662f\u5426\u6ee1\u8db3\u8981\u6c42\r\nif [[ $# -lt 6 ]]; then\r\n    echo '\u4f7f\u7528\u9519\u8bef\uff01\u4f7f\u7528\u65b9\u6cd5 sh danji.sh \u96c6\u56e2\u540d talos cncp-helm \u8981\u4fee\u6539\u7684IP\u5730\u5740!\u4e3b\u673a\u4f4d! \u4e34\u65f6IP\u5730\u5740\u7ed1\u5b9a\u7684\u5730\u5740!\u4e3b\u673a\u4f4d! talosconfig\u4e2d\u7684IP\u5730\u5740!\u4e3b\u673a\u4f4d!'\r\n    exit 1\r\nfi\r\n\r\n# \u9010\u4e2a\u68c0\u67e5\u53c2\u6570\u662f\u5426\u5408\u6cd5\uff08\u4ee5\u68c0\u67e5\u975e\u7a7a\u4e14\u975e\u4ec5\u7a7a\u683c\u5b57\u7b26\u4e3a\u4f8b\uff09\r\nfor ((i=1; i<=6; i++)); do\r\n    param='${!i}'\r\n    if [[ -z '$param' || '$param' =~ ^\\s+$ ]]; then\r\n        echo '\u4f7f\u7528\u9519\u8bef\uff01\u4f7f\u7528\u65b9\u6cd5 sh danji.sh \u96c6\u56e2\u540d talos cncp-helm \u8981\u4fee\u6539\u7684IP\u5730\u5740!\u4e3b\u673a\u4f4d! \u4e34\u65f6IP\u5730\u5740\u7ed1\u5b9a\u7684\u5730\u5740!\u4e3b\u673a\u4f4d! talosconfig\u4e2d\u7684IP\u5730\u5740!\u4e3b\u673a\u4f4d!'\r\n        exit 1\r\n    fi\r\ndone\r\n\r\n# \u6240\u6709\u53c2\u6570\u68c0\u67e5\u901a\u8fc7\uff0c\u8bb0\u5f55\u65e5\u5fd7\u5e76\u7ee7\u7eed\u6267\u884c\r\n\r\nkubecfg_path='/root/.kube/config'\r\nif rm '$kubecfg_path'; then\r\n  echo '\u6587\u4ef6 '$kubecfg_path' \u5df2\u6210\u529f\u5220\u9664\u3002", "top": 0, "createdAt": 1718097108, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-11", "dateLabelColor": "#bc4c00"}, "P15": {"htmlDir": "docs/post/project_ddi.html", "labels": ["shell"], "postTitle": "project_ddi", "postUrl": "post/project_ddi.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/15", "commentNum": 0, "wordCount": 16209, "description": "```shell\r\n#!/bin/bash\r\n#\u96c6\u56e2\u6587\u4ef6\u5939\u4e0b\u65b9\u6267\u884c\r\n#\u6267\u884c\u4e4b\u524d\u786e\u5b9a/path/to/dhcpdb_create.pgsql\u6709\u6ca1\u6709\u8fd9\u4e2a\u6587\u4ef6\r\n\r\n\r\n\r\nsource_config_path='/root/.kube/config'\r\nhelm_path='cncp-helm'\r\nservices_path='cncp-helm/cncp-basic-services/values.yaml'\r\ncore_path='cncp-helm/cncp-core-components/values.yaml'\r\none_path=$1\r\ntow_path=$2\r\nipv4_path='172.16.102.240-172.16.102.244'\r\nipv6_path='2408:8631:c02:ffa2::240-2408:8631:c02:ffa2::244'\r\ndns_path=$3\r\ndhcp_path=$4\r\nddi_file_path='cncp-helm/ddi-components/values.yaml'\r\nddi_dns_path=$5\r\nddi_dhcp_path=$6\r\nsql_path=$7\r\n\r\n\r\n# bak\r\n#backup_suffix='_$(date +%Y%m%d%H%M%S).bak'\r\n#cp '$services_path' '${services_path}${backup_suffix}'\r\n#cp '$core_path' '${core_path}${backup_suffix}'\r\n\r\n#echo '\u670d\u52a1\u8def\u5f84\uff08$services_path\uff09\u548c\u6838\u5fc3\u8def\u5f84\uff08$core_path\uff09\u7684\u5907\u4efd\u5df2\u5b8c\u6210\u3002", "top": 0, "createdAt": 1718097178, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-11", "dateLabelColor": "#bc4c00"}, "P16": {"htmlDir": "docs/post/k8s_status.html", "labels": ["K8S"], "postTitle": "k8s_status", "postUrl": "post/k8s_status.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/16", "commentNum": 0, "wordCount": 1143, "description": "echo '\u5f00\u59cb\u68c0\u67e5k8s\u96c6\u7fa4\u72b6\u6001'\r\nwhile true; do\r\n  # \u5c1d\u8bd5\u83b7\u53d6\u6240\u6709Pod\u7684\u72b6\u6001\u4fe1\u606f\uff0c\u76f4\u5230\u6210\u529f\r\n  while true; do\r\n    pod_statuses=$(kubectl get pods -A --output=json 2>&1)\r\n    if [[ $(echo '$pod_statuses' | jq -r '.items[] | select(.metadata.namespace == 'kube-system')') ]]; then  # \u68c0\u67e5kube-system\u662f\u5426\u5b58\u5728\r\n      echo '\u6210\u529f\u8fde\u63a5\u5230Kubernetes\u96c6\u7fa4'\r\n      break\r\n    fi\r\n    echo '\u65e0\u6cd5\u83b7\u53d6kube-system\u547d\u540d\u7a7a\u95f4\u7684Pod\u4fe1\u606f\u3002", "top": 0, "createdAt": 1718097224, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-11", "dateLabelColor": "#bc4c00"}, "P17": {"htmlDir": "docs/post/test_auto.html", "labels": ["python"], "postTitle": "test_auto", "postUrl": "post/test_auto.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/17", "commentNum": 0, "wordCount": 87, "description": "[case_test.zip](https://github.com/user-attachments/files/15785392/case_test.zip)\r\n\r\n\r\n\u3002", "top": 0, "createdAt": 1718097472, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-11", "dateLabelColor": "#bc4c00"}, "P18": {"htmlDir": "docs/post/talos.html", "labels": ["\u7cfb\u7edf\u67b6\u6784"], "postTitle": "talos", "postUrl": "post/talos.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/18", "commentNum": 0, "wordCount": 119, "description": "![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/86f3f38b-b49e-4fa7-b7b6-47d3507d76a1)\r\n\r\n\r\n\u3002", "top": 0, "createdAt": 1718098255, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-11", "dateLabelColor": "#bc4c00"}, "P19": {"htmlDir": "docs/post/K8S-zai-nan-hui-fu.html", "labels": ["K8S"], "postTitle": "K8S\u707e\u96be\u6062\u590d", "postUrl": "post/K8S-zai-nan-hui-fu.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/19", "commentNum": 0, "wordCount": 115, "description": "![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/4817925f-e8c4-4e62-a983-b1439f36ac84)\r\n\u3002", "top": 0, "createdAt": 1718152741, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-12", "dateLabelColor": "#bc4c00"}, "P20": {"htmlDir": "docs/post/gitlab.yaml.html", "labels": ["yaml"], "postTitle": "gitlab.yaml", "postUrl": "post/gitlab.yaml.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/20", "commentNum": 0, "wordCount": 526, "description": "```yaml\r\nversion: '3.6'\r\nservices:\r\n  gitlab:\r\n    image: gitlab/gitlab-ce:latest\r\n    container_name: gitlab\r\n    restart: always\r\n    hostname: '172.16.8.3'\r\n    environment:\r\n      GITLAB_OMNIBUS_CONFIG: |\r\n        external_url 'http://172.16.8.3:8929'\r\n        gitlab_rails['gitlab_shell_ssh_port'] = 2424\r\n    ports:\r\n      - '8929:8929'\r\n      - '4443:443'\r\n      - '2424:22'\r\n    volumes:\r\n      - '/srv/config:/etc/gitlab'\r\n      - '/srv/logs:/var/log/gitlab'\r\n      - '/srv/data:/var/opt/gitlab'\r\n    shm_size: '256m'\u3002", "top": 0, "createdAt": 1718160016, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-12", "dateLabelColor": "#bc4c00"}, "P21": {"htmlDir": "docs/post/harbor.yaml.html", "labels": ["yaml"], "postTitle": "harbor.yaml", "postUrl": "post/harbor.yaml.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/21", "commentNum": 0, "wordCount": 14619, "description": "```yaml\r\n# Configuration file of Harbor\r\n\r\n# The IP address or hostname to access admin UI and registry service.\r\n# DO NOT use localhost or 127.0.0.1, because Harbor needs to be accessed by external clients.\r\nhostname: 172.16.8.3\r\n# http related config\r\nhttp:\r\n  # port for http, default is 80. If https enabled, this port will redirect to https port\r\n  port: 80\r\n\r\n# https related config\r\nhttps:\r\n  # https port for harbor, default is 443\r\n  port: 443\r\n  # The path of cert and key files for nginx\r\n  certificate: /home/test/harbor/harbor/172.16.8.3.crt\r\n  private_key: /home/test/harbor/harbor/172.16.8.3.key\r\n  # enable strong ssl ciphers (default: false)\r\n  # strong_ssl_ciphers: false\r\n\r\n# # Harbor will set ipv4 enabled only by default if this block is not configured\r\n# # Otherwise, please uncomment this block to configure your own ip_family stacks\r\n# ip_family:\r\n#   # ipv6Enabled set to true if ipv6 is enabled in docker network, currently it affected the nginx related component\r\n#   ipv6:\r\n#     enabled: false\r\n#   # ipv4Enabled set to true by default, currently it affected the nginx related component\r\n#   ipv4:\r\n#     enabled: true\r\n\r\n# # Uncomment following will enable tls communication between all harbor components\r\n# internal_tls:\r\n#   # set enabled to true means internal tls is enabled\r\n#   enabled: true\r\n#   # put your cert and key files on dir\r\n#   dir: /etc/harbor/tls/internal\r\n\r\n\r\n# Uncomment external_url if you want to enable external proxy\r\n# And when it enabled the hostname will no longer used\r\n# external_url: https://reg.mydomain.com:8433\r\n\r\n# The initial password of Harbor admin\r\n# It only works in first time to install harbor\r\n# Remember Change the admin password from UI after launching Harbor.\r\nharbor_admin_password: Harbor12345\r\n\r\n# Harbor DB configuration\r\ndatabase:\r\n  # The password for the root user of Harbor DB. Change this before any production use.\r\n  password: root123\r\n  # The maximum number of connections in the idle connection pool. If it <=0, no idle connections are retained.\r\n  max_idle_conns: 100\r\n  # The maximum number of open connections to the database. If it <= 0, then there is no limit on the number of open connections.\r\n  # Note: the default number of connections is 1024 for postgres of harbor.\r\n  max_open_conns: 900\r\n  # The maximum amount of time a connection may be reused. Expired connections may be closed lazily before reuse. If it <= 0, connections are not closed due to a connection's age.\r\n  # The value is a duration string. A duration string is a possibly signed sequence of decimal numbers, each with optional fraction and a unit suffix, such as '300ms', '-1.5h' or '2h45m'. Valid time units are 'ns', 'us' (or '\u00b5s'), 'ms', 's', 'm', 'h'.\r\n  conn_max_lifetime: 5m\r\n  # The maximum amount of time a connection may be idle. Expired connections may be closed lazily before reuse. If it <= 0, connections are not closed due to a connection's idle time.\r\n  # The value is a duration string. A duration string is a possibly signed sequence of decimal numbers, each with optional fraction and a unit suffix, such as '300ms', '-1.5h' or '2h45m'. Valid time units are 'ns', 'us' (or '\u00b5s'), 'ms', 's', 'm', 'h'.\r\n  conn_max_idle_time: 0\r\n\r\n# The default data volume\r\ndata_volume: /data\r\n\r\n# Harbor Storage settings by default is using /data dir on local filesystem\r\n# Uncomment storage_service setting If you want to using external storage\r\n# storage_service:\r\n#   # ca_bundle is the path to the custom root ca certificate, which will be injected into the truststore\r\n#   # of registry's containers.  This is usually needed when the user hosts a internal storage with self signed certificate.\r\n#   ca_bundle:\r\n\r\n#   # storage backend, default is filesystem, options include filesystem, azure, gcs, s3, swift and oss\r\n#   # for more info about this configuration please refer https://distribution.github.io/distribution/about/configuration/\r\n#   # and https://distribution.github.io/distribution/storage-drivers/\r\n#   filesystem:\r\n#     maxthreads: 100\r\n#   # set disable to true when you want to disable registry redirect\r\n#   redirect:\r\n#     disable: false\r\n\r\n# Trivy configuration\r\n#\r\n# Trivy DB contains vulnerability information from NVD, Red Hat, and many other upstream vulnerability databases.\r\n# It is downloaded by Trivy from the GitHub release page https://github.com/aquasecurity/trivy-db/releases and cached\r\n# in the local file system. In addition, the database contains the update timestamp so Trivy can detect whether it\r\n# should download a newer version from the Internet or use the cached one. Currently, the database is updated every\r\n# 12 hours and published as a new release to GitHub.\r\ntrivy:\r\n  # ignoreUnfixed The flag to display only fixed vulnerabilities\r\n  ignore_unfixed: false\r\n  # skipUpdate The flag to enable or disable Trivy DB downloads from GitHub\r\n  #\r\n  # You might want to enable this flag in test or CI/CD environments to avoid GitHub rate limiting issues.\r\n  # If the flag is enabled you have to download the `trivy-offline.tar.gz` archive manually, extract `trivy.db` and\r\n  # `metadata.json` files and mount them in the `/home/scanner/.cache/trivy/db` path.\r\n  skip_update: false\r\n  #\r\n  # skipJavaDBUpdate If the flag is enabled you have to manually download the `trivy-java.db` file and mount it in the\r\n  # `/home/scanner/.cache/trivy/java-db/trivy-java.db` path\r\n  skip_java_db_update: false\r\n  #\r\n  # The offline_scan option prevents Trivy from sending API requests to identify dependencies.\r\n  # Scanning JAR files and pom.xml may require Internet access for better detection, but this option tries to avoid it.\r\n  # For example, the offline mode will not try to resolve transitive dependencies in pom.xml when the dependency doesn't\r\n  # exist in the local repositories. It means a number of detected vulnerabilities might be fewer in offline mode.\r\n  # It would work if all the dependencies are in local.\r\n  # This option doesn't affect DB download. You need to specify 'skip-update' as well as 'offline-scan' in an air-gapped environment.\r\n  offline_scan: false\r\n  #\r\n  # Comma-separated list of what security issues to detect. Possible values are `vuln`, `config` and `secret`. Defaults to `vuln`.\r\n  security_check: vuln\r\n  #\r\n  # insecure The flag to skip verifying registry certificate\r\n  insecure: false\r\n  #\r\n  # timeout The duration to wait for scan completion.\r\n  # There is upper bound of 30 minutes defined in scan job. So if this `timeout` is larger than 30m0s, it will also timeout at 30m0s.\r\n  timeout: 5m0s\r\n  #\r\n  # github_token The GitHub access token to download Trivy DB\r\n  #\r\n  # Anonymous downloads from GitHub are subject to the limit of 60 requests per hour. Normally such rate limit is enough\r\n  # for production operations. If, for any reason, it's not enough, you could increase the rate limit to 5000\r\n  # requests per hour by specifying the GitHub access token. For more details on GitHub rate limiting please consult\r\n  # https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\r\n  #\r\n  # You can create a GitHub token by following the instructions in\r\n  # https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line\r\n  #\r\n  # github_token: xxx\r\n\r\njobservice:\r\n  # Maximum number of job workers in job service\r\n  max_job_workers: 10\r\n  # The jobLoggers backend name, only support 'STD_OUTPUT', 'FILE' and/or 'DB'\r\n  job_loggers:\r\n    - STD_OUTPUT\r\n    - FILE\r\n    # - DB\r\n  # The jobLogger sweeper duration (ignored if `jobLogger` is `stdout`)\r\n  logger_sweeper_duration: 1 #days\r\n\r\nnotification:\r\n  # Maximum retry count for webhook job\r\n  webhook_job_max_retry: 3\r\n  # HTTP client timeout for webhook job\r\n  webhook_job_http_client_timeout: 3 #seconds\r\n\r\n# Log configurations\r\nlog:\r\n  # options are debug, info, warning, error, fatal\r\n  level: info\r\n  # configs for logs in local storage\r\n  local:\r\n    # Log files are rotated log_rotate_count times before being removed. If count is 0, old versions are removed rather than rotated.\r\n    rotate_count: 50\r\n    # Log files are rotated only if they grow bigger than log_rotate_size bytes. If size is followed by k, the size is assumed to be in kilobytes.\r\n    # If the M is used, the size is in megabytes, and if G is used, the size is in gigabytes. So size 100, size 100k, size 100M and size 100G\r\n    # are all valid.\r\n    rotate_size: 200M\r\n    # The directory on your host that store log\r\n    location: /var/log/harbor\r\n\r\n  # Uncomment following lines to enable external syslog endpoint.\r\n  # external_endpoint:\r\n  #   # protocol used to transmit log to external endpoint, options is tcp or udp\r\n  #   protocol: tcp\r\n  #   # The host of external endpoint\r\n  #   host: localhost\r\n  #   # Port of external endpoint\r\n  #   port: 5140\r\n\r\n#This attribute is for migrator to detect the version of the .cfg file, DO NOT MODIFY!\r\n_version: 2.11.0\r\n\r\n# Uncomment external_database if using external database.\r\n# external_database:\r\n#   harbor:\r\n#     host: harbor_db_host\r\n#     port: harbor_db_port\r\n#     db_name: harbor_db_name\r\n#     username: harbor_db_username\r\n#     password: harbor_db_password\r\n#     ssl_mode: disable\r\n#     max_idle_conns: 2\r\n#     max_open_conns: 0\r\n\r\n# Uncomment redis if need to customize redis db\r\n# redis:\r\n#   # db_index 0 is for core, it's unchangeable\r\n#   # registry_db_index: 1\r\n#   # jobservice_db_index: 2\r\n#   # trivy_db_index: 5\r\n#   # it's optional, the db for harbor business misc, by default is 0, uncomment it if you want to change it.\r\n#   # harbor_db_index: 6\r\n#   # it's optional, the db for harbor cache layer, by default is 0, uncomment it if you want to change it.\r\n#   # cache_layer_db_index: 7\r\n\r\n# Uncomment external_redis if using external Redis server\r\n# external_redis:\r\n#   # support redis, redis+sentinel\r\n#   # host for redis: <host_redis>:<port_redis>\r\n#   # host for redis+sentinel:\r\n#   #  <host_sentinel1>:<port_sentinel1>,<host_sentinel2>:<port_sentinel2>,<host_sentinel3>:<port_sentinel3>\r\n#   host: redis:6379\r\n#   password: \r\n#   # Redis AUTH command was extended in Redis 6, it is possible to use it in the two-arguments AUTH <username> <password> form.\r\n#   # there's a known issue when using external redis username ref:https://github.com/goharbor/harbor/issues/18892\r\n#   # if you care about the image pull/push performance, please refer to this https://github.com/goharbor/harbor/wiki/Harbor-FAQs#external-redis-username-password-usage\r\n#   # username:\r\n#   # sentinel_master_set must be set to support redis+sentinel\r\n#   #sentinel_master_set:\r\n#   # db_index 0 is for core, it's unchangeable\r\n#   registry_db_index: 1\r\n#   jobservice_db_index: 2\r\n#   trivy_db_index: 5\r\n#   idle_timeout_seconds: 30\r\n#   # it's optional, the db for harbor business misc, by default is 0, uncomment it if you want to change it.\r\n#   # harbor_db_index: 6\r\n#   # it's optional, the db for harbor cache layer, by default is 0, uncomment it if you want to change it.\r\n#   # cache_layer_db_index: 7\r\n\r\n# Uncomment uaa for trusting the certificate of uaa instance that is hosted via self-signed cert.\r\n# uaa:\r\n#   ca_file: /path/to/ca\r\n\r\n# Global proxy\r\n# Config http proxy for components, e.g. http://my.proxy.com:3128\r\n# Components doesn't need to connect to each others via http proxy.\r\n# Remove component from `components` array if want disable proxy\r\n# for it. If you want use proxy for replication, MUST enable proxy\r\n# for core and jobservice, and set `http_proxy` and `https_proxy`.\r\n# Add domain to the `no_proxy` field, when you want disable proxy\r\n# for some special registry.\r\nproxy:\r\n  http_proxy:\r\n  https_proxy:\r\n  no_proxy:\r\n  components:\r\n    - core\r\n    - jobservice\r\n    - trivy\r\n\r\n# metric:\r\n#   enabled: false\r\n#   port: 9090\r\n#   path: /metrics\r\n\r\n# Trace related config\r\n# only can enable one trace provider(jaeger or otel) at the same time,\r\n# and when using jaeger as provider, can only enable it with agent mode or collector mode.\r\n# if using jaeger collector mode, uncomment endpoint and uncomment username, password if needed\r\n# if using jaeger agetn mode uncomment agent_host and agent_port\r\n# trace:\r\n#   enabled: true\r\n#   # set sample_rate to 1 if you wanna sampling 100% of trace data; set 0.5 if you wanna sampling 50% of trace data, and so forth\r\n#   sample_rate: 1\r\n#   # # namespace used to differentiate different harbor services\r\n#   # namespace:\r\n#   # # attributes is a key value dict contains user defined attributes used to initialize trace provider\r\n#   # attributes:\r\n#   #   application: harbor\r\n#   # # jaeger should be 1.26 or newer.\r\n#   # jaeger:\r\n#   #   endpoint: http://hostname:14268/api/traces\r\n#   #   username:\r\n#   #   password:\r\n#   #   agent_host: hostname\r\n#   #   # export trace data by jaeger.thrift in compact mode\r\n#   #   agent_port: 6831\r\n#   # otel:\r\n#   #   endpoint: hostname:4318\r\n#   #   url_path: /v1/traces\r\n#   #   compression: false\r\n#   #   insecure: true\r\n#   #   # timeout is in seconds\r\n#   #   timeout: 10\r\n\r\n# Enable purge _upload directories\r\nupload_purging:\r\n  enabled: true\r\n  # remove files in _upload directories which exist for a period of time, default is one week.\r\n  age: 168h\r\n  # the interval of the purge operations\r\n  interval: 24h\r\n  dryrun: false\r\n\r\n# Cache layer configurations\r\n# If this feature enabled, harbor will cache the resource\r\n# `project/project_metadata/repository/artifact/manifest` in the redis\r\n# which can especially help to improve the performance of high concurrent\r\n# manifest pulling.\r\n# NOTICE\r\n# If you are deploying Harbor in HA mode, make sure that all the harbor\r\n# instances have the same behaviour, all with caching enabled or disabled,\r\n# otherwise it can lead to potential data inconsistency.\r\ncache:\r\n  # not enabled by default\r\n  enabled: false\r\n  # keep cache for one day by default\r\n  expire_hours: 24\r\n\r\n# Harbor core configurations\r\n# Uncomment to enable the following harbor core related configuration items.\r\n# core:\r\n#   # The provider for updating project quota(usage), there are 2 options, redis or db,\r\n#   # by default is implemented by db but you can switch the updation via redis which\r\n#   # can improve the performance of high concurrent pushing to the same project,\r\n#   # and reduce the database connections spike and occupies.\r\n#   # By redis will bring up some delay for quota usage updation for display, so only\r\n#   # suggest switch provider to redis if you were ran into the db connections spike around\r\n#   # the scenario of high concurrent pushing to same project, no improvement for other scenes.\r\n#   quota_update_provider: redis # Or db\r\n\u3002", "top": 0, "createdAt": 1718160292, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-12", "dateLabelColor": "#bc4c00"}, "P22": {"htmlDir": "docs/post/harbor_docker_compose.yaml.html", "labels": ["yaml"], "postTitle": "harbor_docker_compose.yaml", "postUrl": "post/harbor_docker_compose.yaml.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/22", "commentNum": 0, "wordCount": 6164, "description": "```yaml\r\nversion: '2.3'\r\nservices:\r\n  log:\r\n    image: goharbor/harbor-log:v2.11.0\r\n    container_name: harbor-log\r\n    restart: always\r\n    cap_drop:\r\n      - ALL\r\n    cap_add:\r\n      - CHOWN\r\n      - DAC_OVERRIDE\r\n      - SETGID\r\n      - SETUID\r\n    volumes:\r\n      - /var/log/harbor/:/var/log/docker/:z\r\n      - type: bind\r\n        source: ./common/config/log/logrotate.conf\r\n        target: /etc/logrotate.d/logrotate.conf\r\n      - type: bind\r\n        source: ./common/config/log/rsyslog_docker.conf\r\n        target: /etc/rsyslog.d/rsyslog_docker.conf\r\n    ports:\r\n      - 127.0.0.1:1514:10514\r\n    networks:\r\n      - harbor\r\n  registry:\r\n    image: goharbor/registry-photon:v2.11.0\r\n    container_name: registry\r\n    restart: always\r\n    cap_drop:\r\n      - ALL\r\n    cap_add:\r\n      - CHOWN\r\n      - SETGID\r\n      - SETUID\r\n    volumes:\r\n      - /data/registry:/storage:z\r\n      - ./common/config/registry/:/etc/registry/:z\r\n      - type: bind\r\n        source: /data/secret/registry/root.crt\r\n        target: /etc/registry/root.crt\r\n      - type: bind\r\n        source: ./common/config/shared/trust-certificates\r\n        target: /harbor_cust_cert\r\n    networks:\r\n      - harbor\r\n    depends_on:\r\n      - log\r\n    logging:\r\n      driver: 'syslog'\r\n      options:\r\n        syslog-address: 'tcp://localhost:1514'\r\n        tag: 'registry'\r\n  registryctl:\r\n    image: goharbor/harbor-registryctl:v2.11.0\r\n    container_name: registryctl\r\n    env_file:\r\n      - ./common/config/registryctl/env\r\n    restart: always\r\n    cap_drop:\r\n      - ALL\r\n    cap_add:\r\n      - CHOWN\r\n      - SETGID\r\n      - SETUID\r\n    volumes:\r\n      - /data/registry:/storage:z\r\n      - ./common/config/registry/:/etc/registry/:z\r\n      - type: bind\r\n        source: ./common/config/registryctl/config.yml\r\n        target: /etc/registryctl/config.yml\r\n      - type: bind\r\n        source: ./common/config/shared/trust-certificates\r\n        target: /harbor_cust_cert\r\n    networks:\r\n      - harbor\r\n    depends_on:\r\n      - log\r\n    logging:\r\n      driver: 'syslog'\r\n      options:\r\n        syslog-address: 'tcp://localhost:1514'\r\n        tag: 'registryctl'\r\n  postgresql:\r\n    image: goharbor/harbor-db:v2.11.0\r\n    container_name: harbor-db\r\n    restart: always\r\n    cap_drop:\r\n      - ALL\r\n    cap_add:\r\n      - CHOWN\r\n      - DAC_OVERRIDE\r\n      - SETGID\r\n      - SETUID\r\n    volumes:\r\n      - /data/database:/var/lib/postgresql/data:z\r\n    networks:\r\n      harbor:\r\n    env_file:\r\n      - ./common/config/db/env\r\n    depends_on:\r\n      - log\r\n    logging:\r\n      driver: 'syslog'\r\n      options:\r\n        syslog-address: 'tcp://localhost:1514'\r\n        tag: 'postgresql'\r\n    shm_size: '1gb'\r\n  core:\r\n    image: goharbor/harbor-core:v2.11.0\r\n    container_name: harbor-core\r\n    env_file:\r\n      - ./common/config/core/env\r\n    restart: always\r\n    cap_drop:\r\n      - ALL\r\n    cap_add:\r\n      - SETGID\r\n      - SETUID\r\n    volumes:\r\n      - /data/ca_download/:/etc/core/ca/:z\r\n      - /data/:/data/:z\r\n      - ./common/config/core/certificates/:/etc/core/certificates/:z\r\n      - type: bind\r\n        source: ./common/config/core/app.conf\r\n        target: /etc/core/app.conf\r\n      - type: bind\r\n        source: /data/secret/core/private_key.pem\r\n        target: /etc/core/private_key.pem\r\n      - type: bind\r\n        source: /data/secret/keys/secretkey\r\n        target: /etc/core/key\r\n      - type: bind\r\n        source: ./common/config/shared/trust-certificates\r\n        target: /harbor_cust_cert\r\n    networks:\r\n      harbor:\r\n    depends_on:\r\n      - log\r\n      - registry\r\n      - redis\r\n      - postgresql\r\n    logging:\r\n      driver: 'syslog'\r\n      options:\r\n        syslog-address: 'tcp://localhost:1514'\r\n        tag: 'core'\r\n  portal:\r\n    image: goharbor/harbor-portal:v2.11.0\r\n    container_name: harbor-portal\r\n    restart: always\r\n    cap_drop:\r\n      - ALL\r\n    cap_add:\r\n      - CHOWN\r\n      - SETGID\r\n      - SETUID\r\n      - NET_BIND_SERVICE\r\n    volumes:\r\n      - type: bind\r\n        source: ./common/config/portal/nginx.conf\r\n        target: /etc/nginx/nginx.conf\r\n    networks:\r\n      - harbor\r\n    depends_on:\r\n      - log\r\n    logging:\r\n      driver: 'syslog'\r\n      options:\r\n        syslog-address: 'tcp://localhost:1514'\r\n        tag: 'portal'\r\n\r\n  jobservice:\r\n    image: goharbor/harbor-jobservice:v2.11.0\r\n    container_name: harbor-jobservice\r\n    env_file:\r\n      - ./common/config/jobservice/env\r\n    restart: always\r\n    cap_drop:\r\n      - ALL\r\n    cap_add:\r\n      - CHOWN\r\n      - SETGID\r\n      - SETUID\r\n    volumes:\r\n      - /data/job_logs:/var/log/jobs:z\r\n      - type: bind\r\n        source: ./common/config/jobservice/config.yml\r\n        target: /etc/jobservice/config.yml\r\n      - type: bind\r\n        source: ./common/config/shared/trust-certificates\r\n        target: /harbor_cust_cert\r\n    networks:\r\n      - harbor\r\n    depends_on:\r\n      - core\r\n    logging:\r\n      driver: 'syslog'\r\n      options:\r\n        syslog-address: 'tcp://localhost:1514'\r\n        tag: 'jobservice'\r\n  redis:\r\n    image: goharbor/redis-photon:v2.11.0\r\n    container_name: redis\r\n    restart: always\r\n    cap_drop:\r\n      - ALL\r\n    cap_add:\r\n      - CHOWN\r\n      - SETGID\r\n      - SETUID\r\n    volumes:\r\n      - /data/redis:/var/lib/redis\r\n    networks:\r\n      harbor:\r\n    depends_on:\r\n      - log\r\n    logging:\r\n      driver: 'syslog'\r\n      options:\r\n        syslog-address: 'tcp://localhost:1514'\r\n        tag: 'redis'\r\n  proxy:\r\n    image: goharbor/nginx-photon:v2.11.0\r\n    container_name: nginx\r\n    restart: always\r\n    cap_drop:\r\n      - ALL\r\n    cap_add:\r\n      - CHOWN\r\n      - SETGID\r\n      - SETUID\r\n      - NET_BIND_SERVICE\r\n    volumes:\r\n      - ./common/config/nginx:/etc/nginx:z\r\n      - /data/secret/cert:/etc/cert:z\r\n      - type: bind\r\n        source: ./common/config/shared/trust-certificates\r\n        target: /harbor_cust_cert\r\n    networks:\r\n      - harbor\r\n    ports:\r\n      - 8888:8080\r\n      - 443:8443\r\n    depends_on:\r\n      - registry\r\n      - core\r\n      - portal\r\n      - log\r\n    logging:\r\n      driver: 'syslog'\r\n      options:\r\n        syslog-address: 'tcp://localhost:1514'\r\n        tag: 'proxy'\r\nnetworks:\r\n  harbor:\r\n    external: false\u3002", "top": 0, "createdAt": 1718160326, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-12", "dateLabelColor": "#bc4c00"}, "P23": {"htmlDir": "docs/post/k8s_master.yaml.html", "labels": ["yaml"], "postTitle": "k8s_master.yaml", "postUrl": "post/k8s_master.yaml.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/23", "commentNum": 0, "wordCount": 37509, "description": "version: v1alpha1 # Indicates the schema used to decode the contents.\r\ndebug: false # Enable verbose logging to the console.\r\npersist: true # description: |\r\n# Provides machine specific configuration options.\r\nmachine:\r\n    type: controlplane # Defines the role of the machine within the cluster.\r\n    token: jj2db4.b6zct20qwbjgcj9a # The `token` is used by a machine to join the PKI of the cluster.\r\n    # The root certificate authority of the PKI.\r\n    ca:\r\n        crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJQekNCOHFBREFnRUNBaEVBdk5GTHhGdjArMWdGcVNoUnV4Mkl6REFGQmdNclpYQXdFREVPTUF3R0ExVUUKQ2hNRmRHRnNiM013SGhjTk1qUXdORE13TURFek5UTXpXaGNOTXpRd05ESTRNREV6TlRNeldqQVFNUTR3REFZRApWUVFLRXdWMFlXeHZjekFxTUFVR0F5dGxjQU1oQUdUV0d1VW5hZk9naVlyNjJvTVZNZ3p2TzFNeTQ0d3NmWGloClBjVWpPODN5bzJFd1h6QU9CZ05WSFE4QkFmOEVCQU1DQW9Rd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSEF3RUcKQ0NzR0FRVUZCd01DTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3SFFZRFZSME9CQllFRk5uM3QvY2s0NUgvZHAwZQpITWdpMDVjNHRiYzZNQVVHQXl0bGNBTkJBUEJobVJYenlSSHFwQ2I4ZzFLUjIrMEVyL1h2WjNVR1JkZW9NZzk0CkMzMGVzb3RVdE9xSnFsM0FGZmxia1IxOHZqWkhOaDRvNjJKOGxuaWRQL1h1aFFNPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==\r\n        key: LS0tLS1CRUdJTiBFRDI1NTE5IFBSSVZBVEUgS0VZLS0tLS0KTUM0Q0FRQXdCUVlESzJWd0JDSUVJREJVYzNJcXJrdVFmTjdQTzcycytrVE5DY3hXVFBzMTV5RFpIWWFNRW5OMgotLS0tLUVORCBFRDI1NTE5IFBSSVZBVEUgS0VZLS0tLS0K\r\n    # Extra certificate subject alternative names for the machine's certificate.\r\n    certSANs: []\r\n    #   # Uncomment this to enable SANs.\r\n    #   - 10.0.0.10\r\n    #   - 172.16.0.10\r\n    #   - 192.168.0.10\r\n\r\n    # Used to provide additional options to the kubelet.\r\n    kubelet:\r\n        image: ghcr.io/siderolabs/kubelet:v1.28.5 # The `image` field is an optional reference to an alternative kubelet image.\r\n        # The `extraMounts` field is used to add additional mounts to the kubelet container.\r\n        extraMounts:\r\n            - destination: /var/openebs/local\r\n              type: bind\r\n              source: /var/openebs/local\r\n              options:\r\n                - bind\r\n                - rshared\r\n                - rw\r\n            - destination: /var/local-storage\r\n              type: bind\r\n              source: /var/local-storage\r\n              options:\r\n                - bind\r\n                - rshared\r\n                - rw\r\n        # The `extraConfig` field is used to provide kubelet configuration overrides.\r\n        extraConfig:\r\n            containerLogMaxFiles: 5\r\n            containerLogMaxSize: 30Mi\r\n        defaultRuntimeSeccompProfileEnabled: true # Enable container runtime default Seccomp profile.\r\n        disableManifestsDirectory: true # The `disableManifestsDirectory` field configures the kubelet to get static pod manifests from the /etc/kubernetes/manifests directory.\r\n        \r\n        # # The `ClusterDNS` field is an optional reference to an alternative kubelet clusterDNS ip list.\r\n        # clusterDNS:\r\n        #     - 10.96.0.10\r\n        #     - 169.254.2.53\r\n\r\n        # # The `extraArgs` field is used to provide additional flags to the kubelet.\r\n        # extraArgs:\r\n        #     key: value\r\n\r\n        # # The `nodeIP` field is used to configure `--node-ip` flag for the kubelet.\r\n        # nodeIP:\r\n        #     # The `validSubnets` field configures the networks to pick kubelet node IP from.\r\n        #     validSubnets:\r\n        #         - 10.0.0.0/8\r\n        #         - '!10.0.0.3/32'\r\n        #         - fdc7::/16\r\n    # Used to provide static pod definitions to be run by the kubelet directly bypassing the kube-apiserver.\r\n    pods:\r\n        - apiVersion: v1\r\n          kind: Pod\r\n          metadata:\r\n            name: manager\r\n            namespace: kube-system\r\n          spec:\r\n            containers:\r\n                - image: mingyangtech.com.cn/mingyang/centos7:v1.0.0\r\n                  imagePullPolicy: IfNotPresent\r\n                  name: manager\r\n                  resources:\r\n                    limits:\r\n                        cpu: 50m\r\n                        memory: 200Mi\r\n                  securityContext:\r\n                    privileged: true\r\n                  volumeMounts:\r\n                    - mountPath: /etc/cni\r\n                      name: cni\r\n            hostNetwork: true\r\n            priorityClassName: system-node-critical\r\n            restartPolicy: Always\r\n            volumes:\r\n                - hostPath:\r\n                    path: /etc/cni\r\n                    type: DirectoryOrCreate\r\n                  name: cni\r\n    # Provides machine specific network configuration options.\r\n    network:\r\n        hostname: cncp-ms-01 # Used to statically set the hostname for the machine.\r\n        # `interfaces` is used to define the network interface configuration.\r\n        interfaces:\r\n            - interface: bond-cluster # The interface name.\r\n              # Assigns static IP addresses to the interface.\r\n              addresses:\r\n                - 10.1.13.214/27\r\n                - 2001:da8:9002:c400::1003/112\r\n              # A list of routes associated with the interface.\r\n              routes:\r\n                - network: 0.0.0.0/0 # The route's network (destination).\r\n                  gateway: 10.1.13.222 # The route's gateway (if empty, creates link scope route).\r\n                - network: ::/0 # The route's network (destination).\r\n                  gateway: 2001:da8:9002:c400::fffe # The route's gateway (if empty, creates link scope route).\r\n              # Bond specific options.\r\n              bond:\r\n                # The interfaces that make up the bond.\r\n                interfaces: []\r\n                # Picks a network device using the selector.\r\n                deviceSelectors:\r\n                    - busPath: 0000:19:00.0 # PCI, USB bus prefix, supports matching by wildcard.\r\n                mode: active-backup # A bond option.\r\n              mtu: 1500 # The interface's MTU.\r\n              \r\n              # # Picks a network device using the selector.\r\n\r\n              # # select a device with bus prefix 00:*.\r\n              # deviceSelector:\r\n              #     busPath: 00:* # PCI, USB bus prefix, supports matching by wildcard.\r\n              # # select a device with mac address matching `*:f0:ab` and `virtio` kernel driver.\r\n              # deviceSelector:\r\n              #     hardwareAddr: '*:f0:ab' # Device hardware address, supports matching by wildcard.\r\n              #     driver: virtio # Kernel driver, supports matching by wildcard.\r\n              # # select a device with bus prefix 00:*, a device with mac address matching `*:f0:ab` and `virtio` kernel driver.\r\n              # deviceSelector:\r\n              #     - busPath: 00:* # PCI, USB bus prefix, supports matching by wildcard.\r\n              #     - hardwareAddr: '*:f0:ab' # Device hardware address, supports matching by wildcard.\r\n              #       driver: virtio # Kernel driver, supports matching by wildcard.\r\n\r\n              # # Bridge specific options.\r\n              # bridge:\r\n              #     # The interfaces that make up the bridge.\r\n              #     interfaces:\r\n              #         - enxda4042ca9a51\r\n              #         - enxae2a6774c259\r\n              #     # A bridge option.\r\n              #     stp:\r\n              #         enabled: true # Whether Spanning Tree Protocol (STP) is enabled.\r\n\r\n              # # Indicates if DHCP should be used to configure the interface.\r\n              # dhcp: true\r\n\r\n              # # DHCP specific options.\r\n              # dhcpOptions:\r\n              #     routeMetric: 1024 # The priority of all routes received via DHCP.\r\n\r\n              # # Wireguard specific configuration.\r\n\r\n              # # wireguard server example\r\n              # wireguard:\r\n              #     privateKey: ABCDEF... # Specifies a private key configuration (base64 encoded).\r\n              #     listenPort: 51111 # Specifies a device's listening port.\r\n              #     # Specifies a list of peer configurations to apply to a device.\r\n              #     peers:\r\n              #         - publicKey: ABCDEF... # Specifies the public key of this peer.\r\n              #           endpoint: 192.168.1.3 # Specifies the endpoint of this peer entry.\r\n              #           # AllowedIPs specifies a list of allowed IP addresses in CIDR notation for this peer.\r\n              #           allowedIPs:\r\n              #             - 192.168.1.0/24\r\n              # # wireguard peer example\r\n              # wireguard:\r\n              #     privateKey: ABCDEF... # Specifies a private key configuration (base64 encoded).\r\n              #     # Specifies a list of peer configurations to apply to a device.\r\n              #     peers:\r\n              #         - publicKey: ABCDEF... # Specifies the public key of this peer.\r\n              #           endpoint: 192.168.1.2:51822 # Specifies the endpoint of this peer entry.\r\n              #           persistentKeepaliveInterval: 10s # Specifies the persistent keepalive interval for this peer.\r\n              #           # AllowedIPs specifies a list of allowed IP addresses in CIDR notation for this peer.\r\n              #           allowedIPs:\r\n              #             - 192.168.1.0/24\r\n\r\n              # # Virtual (shared) IP address configuration.\r\n\r\n              # # layer2 vip example\r\n              # vip:\r\n              #     ip: 172.16.199.55 # Specifies the IP address to be used.\r\n            - interface: bond-oob # The interface name.\r\n              # Bond specific options.\r\n              bond:\r\n                # The interfaces that make up the bond.\r\n                interfaces: []\r\n                # Picks a network device using the selector.\r\n                deviceSelectors:\r\n                    - busPath: 0000:05:00.0 # PCI, USB bus prefix, supports matching by wildcard.\r\n                    - busPath: 0000:06:00.0 # PCI, USB bus prefix, supports matching by wildcard.\r\n                mode: active-backup # A bond option.\r\n              mtu: 1500 # The interface's MTU.\r\n              dhcp: false # Indicates if DHCP should be used to configure the interface.\r\n              \r\n              # # Picks a network device using the selector.\r\n\r\n              # # select a device with bus prefix 00:*.\r\n              # deviceSelector:\r\n              #     busPath: 00:* # PCI, USB bus prefix, supports matching by wildcard.\r\n              # # select a device with mac address matching `*:f0:ab` and `virtio` kernel driver.\r\n              # deviceSelector:\r\n              #     hardwareAddr: '*:f0:ab' # Device hardware address, supports matching by wildcard.\r\n              #     driver: virtio # Kernel driver, supports matching by wildcard.\r\n              # # select a device with bus prefix 00:*, a device with mac address matching `*:f0:ab` and `virtio` kernel driver.\r\n              # deviceSelector:\r\n              #     - busPath: 00:* # PCI, USB bus prefix, supports matching by wildcard.\r\n              #     - hardwareAddr: '*:f0:ab' # Device hardware address, supports matching by wildcard.\r\n              #       driver: virtio # Kernel driver, supports matching by wildcard.\r\n\r\n              # # Assigns static IP addresses to the interface.\r\n              # addresses:\r\n              #     - 10.5.0.0/16\r\n              #     - 192.168.3.7\r\n\r\n              # # A list of routes associated with the interface.\r\n              # routes:\r\n              #     - network: 0.0.0.0/0 # The route's network (destination).\r\n              #       gateway: 10.5.0.1 # The route's gateway (if empty, creates link scope route).\r\n              #     - network: 10.2.0.0/16 # The route's network (destination).\r\n              #       gateway: 10.2.0.1 # The route's gateway (if empty, creates link scope route).\r\n\r\n              # # Bridge specific options.\r\n              # bridge:\r\n              #     # The interfaces that make up the bridge.\r\n              #     interfaces:\r\n              #         - enxda4042ca9a51\r\n              #         - enxae2a6774c259\r\n              #     # A bridge option.\r\n              #     stp:\r\n              #         enabled: true # Whether Spanning Tree Protocol (STP) is enabled.\r\n\r\n              # # DHCP specific options.\r\n              # dhcpOptions:\r\n              #     routeMetric: 1024 # The priority of all routes received via DHCP.\r\n\r\n              # # Wireguard specific configuration.\r\n\r\n              # # wireguard server example\r\n              # wireguard:\r\n              #     privateKey: ABCDEF... # Specifies a private key configuration (base64 encoded).\r\n              #     listenPort: 51111 # Specifies a device's listening port.\r\n              #     # Specifies a list of peer configurations to apply to a device.\r\n              #     peers:\r\n              #         - publicKey: ABCDEF... # Specifies the public key of this peer.\r\n              #           endpoint: 192.168.1.3 # Specifies the endpoint of this peer entry.\r\n              #           # AllowedIPs specifies a list of allowed IP addresses in CIDR notation for this peer.\r\n              #           allowedIPs:\r\n              #             - 192.168.1.0/24\r\n              # # wireguard peer example\r\n              # wireguard:\r\n              #     privateKey: ABCDEF... # Specifies a private key configuration (base64 encoded).\r\n              #     # Specifies a list of peer configurations to apply to a device.\r\n              #     peers:\r\n              #         - publicKey: ABCDEF... # Specifies the public key of this peer.\r\n              #           endpoint: 192.168.1.2:51822 # Specifies the endpoint of this peer entry.\r\n              #           persistentKeepaliveInterval: 10s # Specifies the persistent keepalive interval for this peer.\r\n              #           # AllowedIPs specifies a list of allowed IP addresses in CIDR notation for this peer.\r\n              #           allowedIPs:\r\n              #             - 192.168.1.0/24\r\n\r\n              # # Virtual (shared) IP address configuration.\r\n\r\n              # # layer2 vip example\r\n              # vip:\r\n              #     ip: 172.16.199.55 # Specifies the IP address to be used.\r\n        # Used to statically set the nameservers for the machine.\r\n        nameservers:\r\n            - 223.5.5.5\r\n            - 223.6.6.6\r\n            - 2400:3200::1\r\n            - 2400:3200:baba::1\r\n        # Allows for extra entries to be added to the `/etc/hosts` file\r\n        extraHostEntries:\r\n            - ip: 10.1.13.214 # The IP of the host.\r\n              # The host alias.\r\n              aliases:\r\n                - endpoint\r\n        \r\n        # # Configures KubeSpan feature.\r\n        # kubespan:\r\n        #     enabled: true # Enable the KubeSpan feature.\r\n    # Used to provide instructions for installations.\r\n    install:\r\n        disk: /dev/sda # The disk used for installations.\r\n        image: ghcr.io/siderolabs/installer:v1.5.5-mycos1 # Allows for supplying the image used to perform the installation.\r\n        # Allows for supplying additional system extension images to install on top of base Talos image.\r\n        extensions:\r\n            - image: ghcr.io/siderolabs/iscsi-tools:v0.1.1 # System extension image.\r\n            - image: ghcr.io/nanfei-chen/hello-world-service:v1.4.0 # System extension image.\r\n        wipe: false # Indicates if the installation disk should be wiped at installation time.\r\n        \r\n        # # Look up disk using disk attributes like model, size, serial and others.\r\n        # diskSelector:\r\n        #     size: 4GB # Disk size.\r\n        #     model: WDC* # Disk model `/sys/block/<dev>/device/model`.\r\n        #     busPath: /pci0000:00/0000:00:17.0/ata1/host0/target0:0:0/0:0:0:0 # Disk bus path.\r\n\r\n        # # Allows for supplying extra kernel args via the bootloader.\r\n        # extraKernelArgs:\r\n        #     - talos.platform=metal\r\n        #     - reboot=k\r\n    # Used to configure the machine's time settings.\r\n    time:\r\n        disabled: false # Indicates if the time service is disabled for the machine.\r\n        # Specifies time (NTP) servers to use for setting the system time.\r\n        servers:\r\n            - 10.1.13.207\r\n    # Used to configure the machine's sysctls.\r\n    sysctls:\r\n        vm.max_map_count: '262144'\r\n    # Used to configure the machine's container image registry mirrors.\r\n    registries:\r\n        # Specifies mirror configuration for each registry host namespace.\r\n        mirrors:\r\n            '*':\r\n                # List of endpoints (URLs) for registry mirrors to use.\r\n                endpoints:\r\n                    - https://10.1.13.207/v2/\r\n            docker.io:\r\n                # List of endpoints (URLs) for registry mirrors to use.\r\n                endpoints:\r\n                    - https://10.1.13.207/v2/docker.io\r\n                overridePath: true # Use the exact path specified for the endpoint (don't append /v2/).\r\n            gcr.io:\r\n                # List of endpoints (URLs) for registry mirrors to use.\r\n                endpoints:\r\n                    - https://10.1.13.207/v2/gcr.io\r\n                overridePath: true # Use the exact path specified for the endpoint (don't append /v2/).\r\n            ghcr.io:\r\n                # List of endpoints (URLs) for registry mirrors to use.\r\n                endpoints:\r\n                    - https://10.1.13.207/v2/ghcr.io\r\n                overridePath: true # Use the exact path specified for the endpoint (don't append /v2/).\r\n            k8s.gcr.io:\r\n                # List of endpoints (URLs) for registry mirrors to use.\r\n                endpoints:\r\n                    - https://10.1.13.207/v2/k8s.gcr.io\r\n                overridePath: true # Use the exact path specified for the endpoint (don't append /v2/).\r\n            mingyangtech.com.cn:\r\n                # List of endpoints (URLs) for registry mirrors to use.\r\n                endpoints:\r\n                    - http://10.1.13.207/v2/mingyangtech.com.cn\r\n                overridePath: true # Use the exact path specified for the endpoint (don't append /v2/).\r\n            nvcr.io:\r\n                # List of endpoints (URLs) for registry mirrors to use.\r\n                endpoints:\r\n                    - https://10.1.13.207/v2/nvcr.io\r\n                overridePath: true # Use the exact path specified for the endpoint (don't append /v2/).\r\n            quay.io:\r\n                # List of endpoints (URLs) for registry mirrors to use.\r\n                endpoints:\r\n                    - https://10.1.13.207/v2/quay.io\r\n                overridePath: true # Use the exact path specified for the endpoint (don't append /v2/).\r\n            registry.k8s.io:\r\n                # List of endpoints (URLs) for registry mirrors to use.\r\n                endpoints:\r\n                    - https://10.1.13.207/v2/registry.k8s.io\r\n                overridePath: true # Use the exact path specified for the endpoint (don't append /v2/).\r\n        # Specifies TLS & auth configuration for HTTPS image registries.\r\n        config:\r\n            10.1.13.207:\r\n                # The TLS configuration for the registry.\r\n                tls:\r\n                    insecureSkipVerify: true # Skip TLS server certificate verification (not recommended).\r\n                    \r\n                    # # Enable mutual TLS authentication with the registry.\r\n                    # clientIdentity:\r\n                    #     crt: LS0tIEVYQU1QTEUgQ0VSVElGSUNBVEUgLS0t\r\n                    #     key: LS0tIEVYQU1QTEUgS0VZIC0tLQ==\r\n                \r\n                # # The auth configuration for this registry.\r\n                # auth:\r\n                #     username: username # Optional registry authentication.\r\n                #     password: password # Optional registry authentication.\r\n            10.1.13.207:10080:\r\n                # The auth configuration for this registry.\r\n                auth:\r\n                    username: admin # Optional registry authentication.\r\n                    password: Passw0rd@MY # Optional registry authentication.\r\n                \r\n                # # The TLS configuration for the registry.\r\n                # tls:\r\n                #     # Enable mutual TLS authentication with the registry.\r\n                #     clientIdentity:\r\n                #         crt: LS0tIEVYQU1QTEUgQ0VSVElGSUNBVEUgLS0t\r\n                #         key: LS0tIEVYQU1QTEUgS0VZIC0tLQ==\r\n                # tls:\r\n                #     # Enable mutual TLS authentication with the registry.\r\n                #     clientIdentity:\r\n                #         crt: LS0tIEVYQU1QTEUgQ0VSVElGSUNBVEUgLS0t\r\n                #         key: LS0tIEVYQU1QTEUgS0VZIC0tLQ==\r\n                #     insecureSkipVerify: true # Skip TLS server certificate verification (not recommended).\r\n    # Features describe individual Talos features that can be switched on or off.\r\n    features:\r\n        rbac: true # Enable role-based access control (RBAC).\r\n        stableHostname: true # Enable stable default hostname.\r\n        apidCheckExtKeyUsage: true # Enable checks for extended key usage of client certificates in apid.\r\n        diskQuotaSupport: true # Enable XFS project quota support for EPHEMERAL partition and user disks.\r\n        \r\n        # # Configure Talos API access from Kubernetes pods.\r\n        # kubernetesTalosAPIAccess:\r\n        #     enabled: true # Enable Talos API access from Kubernetes pods.\r\n        #     # The list of Talos API roles which can be granted for access from Kubernetes pods.\r\n        #     allowedRoles:\r\n        #         - os:reader\r\n        #     # The list of Kubernetes namespaces Talos API access is available from.\r\n        #     allowedKubernetesNamespaces:\r\n        #         - kube-system\r\n    # Configures the kernel.\r\n    kernel:\r\n        # Kernel modules to load.\r\n        modules:\r\n            - name: jool # Module name.\r\n            - name: jool_siit # Module name.\r\n            - name: jool_common # Module name.\r\n            - name: nfsd # Module name.\r\n    \r\n    # # Provides machine specific control plane configuration options.\r\n\r\n    # # ControlPlane definition example.\r\n    # controlPlane:\r\n    #     # Controller manager machine specific configuration options.\r\n    #     controllerManager:\r\n    #         disabled: false # Disable kube-controller-manager on the node.\r\n    #     # Scheduler machine specific configuration options.\r\n    #     scheduler:\r\n    #         disabled: true # Disable kube-scheduler on the node.\r\n\r\n    # # Used to partition, format and mount additional disks.\r\n\r\n    # # MachineDisks list example.\r\n    # disks:\r\n    #     - device: /dev/sdb # The name of the disk to use.\r\n    #       # A list of partitions to create on the disk.\r\n    #       partitions:\r\n    #         - mountpoint: /var/mnt/extra # Where to mount the partition.\r\n    #           \r\n    #           # # The size of partition: either bytes or human readable representation. If `size:` is omitted, the partition is sized to occupy the full disk.\r\n\r\n    #           # # Human readable representation.\r\n    #           # size: 100 MB\r\n    #           # # Precise value in bytes.\r\n    #           # size: 1073741824\r\n\r\n    # # Allows the addition of user specified files.\r\n\r\n    # # MachineFiles usage example.\r\n    # files:\r\n    #     - content: '...' # The contents of the file.\r\n    #       permissions: 0o666 # The file's permissions in octal.\r\n    #       path: /tmp/file.txt # The path of the file.\r\n    #       op: append # The operation to use\r\n\r\n    # # The `env` field allows for the addition of environment variables.\r\n\r\n    # # Environment variables definition examples.\r\n    # env:\r\n    #     GRPC_GO_LOG_SEVERITY_LEVEL: info\r\n    #     GRPC_GO_LOG_VERBOSITY_LEVEL: '99'\r\n    #     https_proxy: http://SERVER:PORT/\r\n    # env:\r\n    #     GRPC_GO_LOG_SEVERITY_LEVEL: error\r\n    #     https_proxy: https://USERNAME:PASSWORD@SERVER:PORT/\r\n    # env:\r\n    #     https_proxy: http://DOMAIN\\USERNAME:PASSWORD@SERVER:PORT/\r\n\r\n    # # Used to configure the machine's sysfs.\r\n\r\n    # # MachineSysfs usage example.\r\n    # sysfs:\r\n    #     devices.system.cpu.cpu0.cpufreq.scaling_governor: performance\r\n\r\n    # # Machine system disk encryption configuration.\r\n    # systemDiskEncryption:\r\n    #     # Ephemeral partition encryption.\r\n    #     ephemeral:\r\n    #         provider: luks2 # Encryption provider to use for the encryption.\r\n    #         # Defines the encryption keys generation and storage method.\r\n    #         keys:\r\n    #             - # Deterministically generated key from the node UUID and PartitionLabel.\r\n    #               nodeID: {}\r\n    #               slot: 0 # Key slot number for LUKS2 encryption.\r\n    #               \r\n    #               # # KMS managed encryption key.\r\n    #               # kms:\r\n    #               #     endpoint: https://192.168.88.21:4443 # KMS endpoint to Seal/Unseal the key.\r\n    #         \r\n    #         # # Cipher kind to use for the encryption. Depends on the encryption provider.\r\n    #         # cipher: aes-xts-plain64\r\n\r\n    #         # # Defines the encryption sector size.\r\n    #         # blockSize: 4096\r\n\r\n    #         # # Additional --perf parameters for the LUKS2 encryption.\r\n    #         # options:\r\n    #         #     - no_read_workqueue\r\n    #         #     - no_write_workqueue\r\n\r\n    # # Configures the udev system.\r\n    # udev:\r\n    #     # List of udev rules to apply to the udev system\r\n    #     rules:\r\n    #         - SUBSYSTEM=='drm', KERNEL=='renderD*', GROUP='44', MODE='0660'\r\n\r\n    # # Configures the logging system.\r\n    # logging:\r\n    #     # Logging destination.\r\n    #     destinations:\r\n    #         - endpoint: tcp://1.2.3.4:12345 # Where to send logs. Supported protocols are 'tcp' and 'udp'.\r\n    #           format: json_lines # Logs format.\r\n\r\n    # # Configures the seccomp profiles for the machine.\r\n    # seccompProfiles:\r\n    #     - name: audit.json # The `name` field is used to provide the file name of the seccomp profile.\r\n    #       # The `value` field is used to provide the seccomp profile.\r\n    #       value:\r\n    #         defaultAction: SCMP_ACT_LOG\r\n\r\n    # # Configures the node labels for the machine.\r\n\r\n    # # node labels example.\r\n    # nodeLabels:\r\n    #     exampleLabel: exampleLabelValue\r\n# Provides cluster specific configuration options.\r\ncluster:\r\n    id: I9fUXHhy5mqFVSAQV_lsuwwUxx3O-drZcStM16d62-E= # Globally unique identifier for this cluster (base64 encoded random 32 bytes).\r\n    secret: 8YE+YZiG8lnSRDkYcouBhMI1Dl+safRsfarKxydViBo= # Shared secret of cluster (base64 encoded random 32 bytes).\r\n    # Provides control plane specific configuration options.\r\n    controlPlane:\r\n        endpoint: https://10.1.13.214:6443 # Endpoint is the canonical controlplane endpoint, which can be an IP address or a DNS hostname.\r\n    clusterName: mingyang # Configures the cluster's name.\r\n    # Provides cluster specific network configuration options.\r\n    network:\r\n        # The CNI used.\r\n        cni:\r\n            name: custom # Name of CNI to use.\r\n            # URLs containing manifests to apply for the CNI.\r\n            urls:\r\n                - http://10.1.13.207:8088/mingyang/cncp/cilium-dsr.yaml\r\n        dnsDomain: cluster.local # The domain used by Kubernetes DNS.\r\n        # The pod subnet CIDR.\r\n        podSubnets:\r\n            - 10.32.0.0/16\r\n            - fd00:1032::/48\r\n        # The service subnet CIDR.\r\n        serviceSubnets:\r\n            - 10.64.0.0/16\r\n            - fd00:1064::/112\r\n    token: 1f1vya.rhaai2peuebr05su # The [bootstrap token](https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/) used to join the cluster.\r\n    secretboxEncryptionSecret: zp3K6SyWptnHMI6yw9RX5EMJIe8A8/5jcFTdauUY6WQ= # A key used for the [encryption of secret data at rest](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/).\r\n    # The base64 encoded root certificate authority used by Kubernetes.\r\n    ca:\r\n        crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJpekNDQVRDZ0F3SUJBZ0lSQU1TdnNFNmtXZmR4RUJDSjE2dWNNNVF3Q2dZSUtvWkl6ajBFQXdJd0ZURVQKTUJFR0ExVUVDaE1LYTNWaVpYSnVaWFJsY3pBZUZ3MHlOREEwTXpBd01UTTFNek5hRncwek5EQTBNamd3TVRNMQpNek5hTUJVeEV6QVJCZ05WQkFvVENtdDFZbVZ5Ym1WMFpYTXdXVEFUQmdjcWhrak9QUUlCQmdncWhrak9QUU1CCkJ3TkNBQVRibjRaOWdOVEorMVhPNStjdWNHWDJCMks3RitCbzhub0crWHNWeHRicjhodmhudytzalNQakN6cXAKN29tYnBUUzArR044TjZrcVRrUitZQVFQUVhqcm8yRXdYekFPQmdOVkhROEJBZjhFQkFNQ0FvUXdIUVlEVlIwbApCQll3RkFZSUt3WUJCUVVIQXdFR0NDc0dBUVVGQndNQ01BOEdBMVVkRXdFQi93UUZNQU1CQWY4d0hRWURWUjBPCkJCWUVGR2wwSE1CRE5nNk53NTZGeFFJNHhGREtvYVdZTUFvR0NDcUdTTTQ5QkFNQ0Ewa0FNRVlDSVFEVWI0OHAKdHRjNGdQZk9mV2ZlWitoRUY3VnJuNTZSQ3lEQlBvSW5ENnhjZkFJaEFQSklyT2FSdUV1Z25GbU1GSnlDdVE0LwpuWnBzYXlxa1JQOU9WR1RRY0IyZgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==\r\n        key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUw0eUd4QnZ3eFp5M1g3QmdXSXBtQ0VoV1lqTkRsdW9yRFBPc25zaEpmRUFvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFMjUrR2ZZRFV5ZnRWenVmbkxuQmw5Z2RpdXhmZ2FQSjZCdmw3RmNiVzYvSWI0WjhQckkwago0d3M2cWU2Sm02VTB0UGhqZkRlcEtrNUVmbUFFRDBGNDZ3PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=\r\n    # The base64 encoded aggregator certificate authority used by Kubernetes for front-proxy certificate generation.\r\n    aggregatorCA:\r\n        crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJYakNDQVFXZ0F3SUJBZ0lRYkVYcmQvOUxhMmM4a2xWMzBqR0xBekFLQmdncWhrak9QUVFEQWpBQU1CNFgKRFRJME1EUXpNREF4TXpVek0xb1hEVE0wTURReU9EQXhNelV6TTFvd0FEQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxRwpTTTQ5QXdFSEEwSUFCTDFJbGVlaTBYOTlwY0poOHcwT2tSWHRlK1luMVhzSkc5bk51MC8xcGkwaHEzUVdJMUdpCkVsL0RsZHdGQ2hjV21DcXRDUmY2OC9zdlZkNlNId1JtWEkyallUQmZNQTRHQTFVZER3RUIvd1FFQXdJQ2hEQWQKQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZApCZ05WSFE0RUZnUVU3cmVBRytpdGRXQTdYeXkrS25rb1g2K0VVV1l3Q2dZSUtvWkl6ajBFQXdJRFJ3QXdSQUlnCmZnRHAzQ0Qxa094SWpmNVRpUHZlOVlZY2tqWENmQmZ5dlpKYmFBdExiVFlDSUdoZlNoVGtjaWVuNUhWUE1PVzIKN3FoeDJXVjFLdXhheEVtQ0Y0dXd5d3BLCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\r\n        key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSU5aeG52MHNwMEdZaVQ1Z2ozb0JhSWQxTW00ZXlraVpnR1NqaUQ3dCszWGRvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFdlVpVjU2TFJmMzJsd21IekRRNlJGZTE3NWlmVmV3a2IyYzI3VC9XbUxTR3JkQllqVWFJUwpYOE9WM0FVS0Z4YVlLcTBKRi9yeit5OVYzcElmQkdaY2pRPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=\r\n    # The base64 encoded private key for service account token generation.\r\n    serviceAccount:\r\n        key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSU5kYmpCR1h2dFkyVCt3RVF5bW83UTNqSElBcTZRaTEvQlNLWU44eExTOVFvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFT0JVOFVmUmVNbWVobkY2U0FaS3JLMXhUNEZWT0FDVnpabFI2TnVDZlp1RzNuK21Hdko4ZgpVbFJTaUw5aDl4L1NIZ2JvN20xMWtLOGFFOE5kczBaRjN3PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=\r\n    # API server specific configuration options.\r\n    apiServer:\r\n        image: registry.k8s.io/kube-apiserver:v1.28.5 # The container image used in the API server manifest.\r\n        # Extra certificate subject alternative names for the API server's certificate.\r\n        certSANs:\r\n            - 10.1.13.214\r\n        disablePodSecurityPolicy: true # Disable PodSecurityPolicy in the API server and default manifests.\r\n        # Configure the API server audit policy.\r\n        auditPolicy:\r\n            apiVersion: audit.k8s.io/v1\r\n            kind: Policy\r\n            rules:\r\n                - level: Metadata\r\n        \r\n        # # Configure the API server admission plugins.\r\n        # admissionControl:\r\n        #     - name: PodSecurity # Name is the name of the admission controller.\r\n        #       # Configuration is an embedded configuration object to be used as the plugin's\r\n        #       configuration:\r\n        #         apiVersion: pod-security.admission.config.k8s.io/v1alpha1\r\n        #         defaults:\r\n        #             audit: restricted\r\n        #             audit-version: latest\r\n        #             enforce: baseline\r\n        #             enforce-version: latest\r\n        #             warn: restricted\r\n        #             warn-version: latest\r\n        #         exemptions:\r\n        #             namespaces:\r\n        #                 - kube-system\r\n        #             runtimeClasses: []\r\n        #             usernames: []\r\n        #         kind: PodSecurityConfiguration\r\n    # Controller manager server specific configuration options.\r\n    controllerManager:\r\n        image: registry.k8s.io/kube-controller-manager:v1.28.5 # The container image used in the controller manager manifest.\r\n    # Kube-proxy server-specific configuration options\r\n    proxy:\r\n        disabled: true # Disable kube-proxy deployment on cluster bootstrap.\r\n        \r\n        # # The container image used in the kube-proxy manifest.\r\n        # image: registry.k8s.io/kube-proxy:v1.28.3\r\n    # Scheduler server specific configuration options.\r\n    scheduler:\r\n        image: registry.k8s.io/kube-scheduler:v1.28.5 # The container image used in the scheduler manifest.\r\n    # Configures cluster member discovery.\r\n    discovery:\r\n        enabled: true # Enable the cluster membership discovery feature.\r\n        # Configure registries used for cluster member discovery.\r\n        registries:\r\n            # Kubernetes registry uses Kubernetes API server to discover cluster members and stores additional information\r\n            kubernetes:\r\n                disabled: true # Disable Kubernetes discovery registry.\r\n            # Service registry is using an external service to push and pull information about cluster members.\r\n            service: {}\r\n            # # External service endpoint.\r\n            # endpoint: https://discovery.talos.dev/\r\n    # Etcd specific configuration options.\r\n    etcd:\r\n        # The `ca` is the root certificate authority of the PKI.\r\n        ca:\r\n            crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJmakNDQVNTZ0F3SUJBZ0lSQU9XQ0JTWXNibU5pVEJQVnllajNXQmd3Q2dZSUtvWkl6ajBFQXdJd0R6RU4KTUFzR0ExVUVDaE1FWlhSalpEQWVGdzB5TkRBME16QXdNVE0xTXpOYUZ3MHpOREEwTWpnd01UTTFNek5hTUE4eApEVEFMQmdOVkJBb1RCR1YwWTJRd1dUQVRCZ2NxaGtqT1BRSUJCZ2dxaGtqT1BRTUJCd05DQUFUY0NXUEhheUM1CnE2T2FBcDdUSlRQZEgrM2FPeTFSdDN5NVFvNHJwMFprdlY5UU9uVUw3S3ZoSEVIa2ZBeGE4Tyt0eGZBNUtCMVoKQlhxeWhERWhQWmpKbzJFd1h6QU9CZ05WSFE4QkFmOEVCQU1DQW9Rd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSApBd0VHQ0NzR0FRVUZCd01DTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3SFFZRFZSME9CQllFRkFMbUo3NGNsVE5BCi9SMHlRWno1UVhIUDFkVmVNQW9HQ0NxR1NNNDlCQU1DQTBnQU1FVUNJUURqNmk0SklPdE1XMzRWWisxTndyWG8KcDZPTE0yM0o0b1g5T1ZFekU3eGltZ0lnVUozaDk3MUNKV0FmUmJFSG1qd1BGcXJvMXhUZTRxekJtZXYvTytFRgp1NVk9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\r\n            key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUdpOXZkK24rN3NWM2wzZTBZcGR6UEVhNWtiaVlsY0JVZENCbmFWYTZFTUZvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFM0Fsangyc2d1YXVqbWdLZTB5VXozUi90MmpzdFViZDh1VUtPSzZkR1pMMWZVRHAxQyt5cgo0UnhCNUh3TVd2RHZyY1h3T1NnZFdRVjZzb1F4SVQyWXlRPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=\r\n        \r\n        # # The container image used to create the etcd service.\r\n        # image: gcr.io/etcd-development/etcd:v3.5.10\r\n\r\n        # # The `advertisedSubnets` field configures the networks to pick etcd advertised IP from.\r\n        # advertisedSubnets:\r\n        #     - 10.0.0.0/8\r\n    # A list of urls that point to additional manifests.\r\n    extraManifests:\r\n        - http://10.1.13.207:8088/mingyang/cncp/cni-installation-ds.yaml\r\n        - http://10.1.13.207:8088/mingyang/cncp/multus-ds.yaml\r\n        - http://10.1.13.207:8088/mingyang/cncp/openebs.yaml\r\n        - http://10.1.13.207:8088/mingyang/cncp/openebs-sc.yaml\r\n        - http://10.1.13.207:8088/mingyang/cncp/dashboard-deploy.yaml\r\n        - http://10.1.13.207:8088/mingyang/cncp/metallb-native.yaml\r\n        - http://10.1.13.207:8088/mingyang/cncp/reloader.yaml\r\n        - http://10.1.13.207:8088/mingyang/cncp/cncp-namespaces.yaml\r\n        - http://10.1.13.207:8088/mingyang/cncp/nfs-server-deploy.yaml\r\n    # A list of inline Kubernetes manifests.\r\n    inlineManifests:\r\n        - name: cluster-config-cm # Name of the manifest.\r\n          contents: |- # Manifest contents as a string.\r\n            kind: ConfigMap\r\n            apiVersion: v1\r\n            metadata:\r\n              name: cluster-config\r\n              namespace: kube-system\r\n            data:\r\n              KUBERNETES_API_SERVER_ADDRESS: '10.1.13.214'\r\n              KUBERNETES_API_SERVER_PORT: '6443'\r\n    # Settings for admin kubeconfig generation.\r\n    adminKubeconfig:\r\n        certLifetime: 87600h0m0s # Admin kubeconfig certificate lifetime (default is 1 year).\r\n    allowSchedulingOnControlPlanes: true # Allows running workload on control-plane nodes.\r\n    \r\n    # # A key used for the [encryption of secret data at rest](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/).\r\n\r\n    # # Decryption secret example (do not use in production!).\r\n    # aescbcEncryptionSecret: z01mye6j16bspJYtTB/5SFX8j7Ph4JXxM2Xuu4vsBPM=\r\n\r\n    # # Core DNS specific configuration options.\r\n    # coreDNS:\r\n    #     image: registry.k8s.io/coredns/coredns:v1.10.1 # The `image` field is an override to the default coredns image.\r\n\r\n    # # External cloud provider configuration.\r\n    # externalCloudProvider:\r\n    #     enabled: true # Enable external cloud provider.\r\n    #     # A list of urls that point to additional manifests for an external cloud provider.\r\n    #     manifests:\r\n    #         - https://raw.githubusercontent.com/kubernetes/cloud-provider-aws/v1.20.0-alpha.0/manifests/rbac.yaml\r\n    #         - https://raw.githubusercontent.com/kubernetes/cloud-provider-aws/v1.20.0-alpha.0/manifests/aws-cloud-controller-manager-daemonset.yaml\r\n\r\n    # # A map of key value pairs that will be added while fetching the extraManifests.\r\n    # extraManifestHeaders:\r\n    #     Token: '1234567'\r\n    #     X-ExtraInfo: info\r\n\u3002", "top": 0, "createdAt": 1718160451, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-12", "dateLabelColor": "#bc4c00"}, "P24": {"htmlDir": "docs/post/patch.yaml.html", "labels": ["yaml"], "postTitle": "patch.yaml", "postUrl": "post/patch.yaml.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/24", "commentNum": 0, "wordCount": 6105, "description": "```yaml\r\n- op: add\r\n  path: /machine/install/extensions\r\n  value:\r\n    - image: ghcr.io/siderolabs/iscsi-tools:v0.1.1\r\n    - image: ghcr.io/nanfei-chen/hello-world-service:v1.4.0\r\n- op: replace\r\n  path: /machine/install/image\r\n  value: ghcr.io/siderolabs/installer:v1.5.5-mycos1\r\n- op: add\r\n  path: /machine/kubelet/extraMounts\r\n  value:\r\n    - destination: /var/openebs/local\r\n      type: bind\r\n      source: /var/openebs/local\r\n      options:\r\n        - bind\r\n        - rshared\r\n        - rw\r\n    - destination: /var/local-storage\r\n      type: bind\r\n      source: /var/local-storage\r\n      options:\r\n        - bind\r\n        - rshared\r\n        - rw\r\n- op: add\r\n  path: /machine/kubelet/extraConfig\r\n  value:\r\n    containerLogMaxFiles: 5\r\n    containerLogMaxSize: 30Mi\r\n- op: add\r\n  path: /machine/network/hostname\r\n  value: cncp-ms-01\r\n- op: add\r\n  path: /machine/network/interfaces\r\n  value: \r\n    - interface: bond-cluster\r\n      addresses:\r\n      - 172.16.102.102/24\r\n      - 2408:8631:c02:ffa2::102/64\r\n      routes:\r\n      - network: 0.0.0.0/0\r\n        gateway: 172.16.102.1\r\n      - network: ::/0\r\n        gateway: 2408:8631:c02:ffa2::1\r\n      mtu: 1500\r\n      bond:\r\n        deviceSelectors:\r\n        - busPath: 0000:07:00.0\r\n        - busPath: 0000:08:00.0\r\n        mode: active-backup\r\n    - interface: bond-ip6\r\n      bond:\r\n        deviceSelectors:\r\n        - busPath: 0000:0b:00.0\r\n        - busPath: 0000:0c:00.0\r\n        mode: active-backup\r\n    - interface: bond-ip4\r\n      bond:\r\n        deviceSelectors:\r\n        - busPath: 0000:12:00.0\r\n        - busPath: 0000:13:00.0\r\n        mode: active-backup\r\n- op: replace\r\n  path: /machine/registries\r\n  value:\r\n    mirrors:\r\n      '*':\r\n        endpoints:\r\n          - https://172.16.1.200/v2/\r\n      docker.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/docker.io\r\n        overridePath: true\r\n      gcr.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/gcr.io\r\n        overridePath: true\r\n      ghcr.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/ghcr.io\r\n        overridePath: true\r\n      k8s.gcr.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/k8s.gcr.io\r\n        overridePath: true\r\n      nvcr.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/nvcr.io\r\n        overridePath: true\r\n      quay.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/quay.io\r\n        overridePath: true\r\n      registry.k8s.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/registry.k8s.io\r\n        overridePath: true\r\n      mingyangtech.com.cn:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/mingyangtech.com.cn\r\n        overridePath: true\r\n    config:\r\n      172.16.1.200:\r\n        tls:\r\n          insecureSkipVerify: true\r\n      172.16.106.11:10080:\r\n        auth:\r\n          username: admin\r\n          password: Passw0rd@MY\r\n- op: add\r\n  path: /machine/kernel\r\n  value: \r\n    modules:\r\n      - name: nfsd\r\n      - name: ngbe\r\n      - name: txgbe\r\n      - name: jool\r\n      - name: jool_siit\r\n      - name: jool_common\r\n- op: add\r\n  path: /machine/network/nameservers\r\n  value: \r\n    - 114.114.114.114\r\n    - 8.8.8.8\r\n    - 2400:3200::1\r\n    - 2400:3200:baba::1\r\n- op: add\r\n  path: /machine/network/extraHostEntries\r\n  value: \r\n    - ip: 172.16.102.102\r\n      aliases:\r\n        - endpoint\r\n        - cncp-ms-01\r\n- op: add\r\n  path: /machine/pods\r\n  value:\r\n  - kind: Pod\r\n    apiVersion: v1\r\n    metadata:\r\n      name: manager\r\n      namespace: kube-system\r\n    spec:\r\n      volumes:\r\n      - name: cni\r\n        hostPath:\r\n          path: /etc/cni\r\n          type: DirectoryOrCreate  \r\n      containers:\r\n      - name: manager\r\n        image: mingyangtech.com.cn/mingyang/centos7:v1.0.0\r\n        imagePullPolicy: IfNotPresent\r\n        resources:\r\n          limits:\r\n            cpu: 50m\r\n            memory: 200Mi\r\n        volumeMounts:\r\n        - name: cni\r\n          mountPath: /etc/cni\r\n        securityContext:\r\n          privileged: true\r\n      restartPolicy: Always\r\n      hostNetwork: true\r\n      priorityClassName: system-node-critical\r\n- op: add\r\n  path: /machine/time\r\n  value:\r\n    disabled: false\r\n    servers:\r\n    - cn.ntp.org.cn\r\n- op: add\r\n  path: /machine/nodeLabels   \r\n  value:\r\n    node-role.kubernetes.io/master: '' \r\n- op: add\r\n  path: /machine/sysctls \r\n  value:\r\n    vm.max_map_count: '262144'\r\n- op: replace\r\n  path: /cluster/network/podSubnets\r\n  value:\r\n    - 10.32.0.0/16\r\n    - fd00:1032::/48\r\n- op: replace\r\n  path: /cluster/network/serviceSubnets\r\n  value:\r\n    - 10.64.0.0/16\r\n    - fd00:1064::/112\r\n- op: add\r\n  path: /cluster/network/cni\r\n  value:\r\n    name: custom\r\n    urls:\r\n      - http://172.16.106.11:8088/mingyang/cncp/cilium-dsr.yaml\r\n- op: replace\r\n  path: /cluster/apiServer/admissionControl\r\n  value:\r\n   []\r\n- op: replace\r\n  path: /cluster/proxy\r\n  value:\r\n    disabled: true\r\n    image: registry.k8s.io/kube-proxy:v1.27.1\r\n    mode: ipvs\r\n    extraArgs:\r\n      ipvs-strict-arp: true\r\n- op: add\r\n  path: /cluster/extraManifests\r\n  value:\r\n  - http://172.16.106.11:8088/mingyang/cncp/cni-installation-ds.yaml\r\n  - http://172.16.106.11:8088/mingyang/cncp/multus-with-patch.yaml\r\n  - http://172.16.106.11:8088/mingyang/cncp/openebs.yaml\r\n  - http://172.16.106.11:8088/mingyang/cncp/openebs-sc.yaml\r\n  - http://172.16.106.11:8088/mingyang/cncp/dashboard-deploy.yaml\r\n  - http://172.16.106.11:8088/mingyang/cncp/metallb-native.yaml\r\n  - http://172.16.106.11:8088/mingyang/cncp/reloader.yaml\r\n  - http://172.16.106.11:8088/mingyang/cncp/cncp-namespaces.yaml\r\n  - http://172.16.106.11:8088/mingyang/cncp/nfs-server-deploy.yaml\r\n- op: add\r\n  path: /cluster/inlineManifests\r\n  value:\r\n  - name: cluster-config-cm\r\n    contents: |-\r\n      kind: ConfigMap\r\n      apiVersion: v1\r\n      metadata:\r\n        name: cluster-config\r\n        namespace: kube-system\r\n      data:\r\n        KUBERNETES_API_SERVER_ADDRESS: '172.16.102.102'\r\n        KUBERNETES_API_SERVER_PORT: '6443'\r\n- op: add\r\n  path: /cluster/adminKubeconfig\r\n  value:\r\n    certLifetime: 87600h0m0s\r\n- op: add\r\n  path: /cluster/allowSchedulingOnControlPlanes\r\n  value: true\r\n  \u3002", "top": 0, "createdAt": 1718160552, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-12", "dateLabelColor": "#bc4c00"}, "P25": {"htmlDir": "docs/post/nginx-deployment.yaml.html", "labels": ["yaml"], "postTitle": "nginx-deployment.yaml", "postUrl": "post/nginx-deployment.yaml.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/25", "commentNum": 0, "wordCount": 10182, "description": "```yaml\r\n---\r\nkind: PersistentVolume\r\napiVersion: v1\r\nmetadata:\r\n  name: nginx\r\n  annotations:\r\n    helm.sh/resource-policy: keep\r\nspec:\r\n  capacity:\r\n    storage: 20Gi\r\n  nfs:\r\n    server: endpoint\r\n    path: /var/local-storage\r\n  accessModes:\r\n  - ReadWriteMany\r\n  persistentVolumeReclaimPolicy: Retain\r\n  storageClassName: nginxstorageclass\r\n\r\n---\r\nkind: PersistentVolumeClaim\r\napiVersion: v1\r\nmetadata:\r\n  name: nginx\r\n  namespace: cncp-production\r\n  annotations:\r\n    helm.sh/resource-policy: keep\r\nspec:\r\n  accessModes:\r\n  - ReadWriteMany\r\n  resources:\r\n    requests:\r\n      storage: 20Gi\r\n  storageClassName: nginxstorageclass\r\n\r\n---\r\nkind: ConfigMap\r\napiVersion: v1\r\nmetadata:\r\n  name: nginx\r\n  namespace: cncp-production\r\ndata:\r\n  nginx.conf: |-\r\n    events {\r\n        worker_connections 50000;\r\n    }\r\n    pid /var/run/nginx.pid;\r\n    http {\r\n        include       mime.types;\r\n        default_type  application/octet-stream;\r\n        client_max_body_size 1000m;\r\n        sendfile        on;\r\n        keepalive_timeout  65;\r\n        log_format app_access_log 'logstart|$time_iso8601|$remote_addr|$remote_port|$server_addr|$server_port|$host|$http_host$uri|$status|$http_x_forwarded_for|$http_referer|$http_user_agent|$upstream_cache_status|$bytes_sent|$proxy_add_x_forwarded_for|$connection_requests|$request_length|';\r\n    }\r\n    stream {\r\n    }\r\n  init-entrypoint.sh: |-\r\n    #!/usr/bin/env sh\r\n    set -e -u\r\n    NGINX_INIT_PATH='/opt/nginx'\r\n    NGINX_CONFIG_PATH='/usr/local/nginx/conf/nginxconf'\r\n    config_files=(nginx.conf)\r\n    for file in ${config_files[@]}\r\n    do\r\n        if [ ! -f $NGINX_CONFIG_PATH/$file ]; then\r\n            cp $NGINX_INIT_PATH/$file $NGINX_CONFIG_PATH\r\n        fi\r\n    done\r\n  handle-outerchains.sh: |-\r\n    #!/usr/bin/env sh\r\n    set +e +u\r\n    cd /usr/local/nginx/conf/nginxconf\r\n    declare -A filesTime\r\n    label=0\r\n    while true\r\n    do\r\n        label=0\r\n        echo 'label'$label\r\n        filesname=`ls -lR |grep -v ^d|awk '{print $9}' | tr -s '\\n'`\r\n        echo 'allfilename'$filesname\r\n        for filestr in ${filesname[@]};do\r\n        echo 'filename'$filestr\r\n        if [ '$filestr' != 'nginx.conf' ] && [[ $filestr != sed* ]];then\r\n        echo 'filename'$filestr\r\n          old_modified_time=`stat -c %y $filestr`\r\n          echo 'new time'$old_modified_time\r\n          if [ '${filesTime['$filestr']}' != '$old_modified_time' ];then\r\n          echo 'first time'${filesTime[$filestr]}\r\n          label=1\r\n          echo 'label'$label\r\n          sed -i 's/'/\\'/g' $filestr\r\n          new_modified_time=`stat -c %y $filestr`\r\n          filesTime[$filestr]=$new_modified_time\r\n          echo 'first time2'${filesTime[$filestr]}\r\n          echo 'new time2'$new_modified_time\r\n          fi\r\n        fi\r\n        done\r\n        if [ '$label' == 1 ];then\r\n        nginx -s reload\r\n        fi\r\n        sleep 3\r\n    done\r\n  docker-entrypoint.sh: |-\r\n    #!/usr/bin/env sh\r\n    set -e -u\r\n    #\ufffd\ufffd\ufffdcache\u0228\ufffd\u07b1\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\r\n    chmod 777 /usr/local/nginx/cache\r\n    nohup /usr/local/bin/handle-outerchains.sh > /var/log/handle-outerchains.log 2>&1 &\r\n    /usr/local/nginx/sbin/nginx\r\n    /opt/reload.sh\r\n  fluent.conf: |\r\n    <system>\r\n        enable_filter_chain_optimization false\r\n    </system>\r\n    <source>\r\n      @id fluentd-containers.log\r\n      @type tail\r\n      path /usr/local/nginx/logs/*.log\r\n      pos_file /var/log/nginx/nginx.pos\r\n      pos_file_compaction_interval 24h\r\n      tag nginx.*\r\n      read_from_head true\r\n      follow_inodes true\r\n      <parse>\r\n        @type none\r\n      </parse>\r\n    </source>\r\n    <match nginx.**>\r\n      @type opensearch \r\n      include_tag_key true \r\n      #host 172.16.100.198\r\n      host opensearch-cluster-master.cncp-system\r\n      #port 30511\r\n      port 9200\r\n      user admin\r\n      password admin\r\n      index_name cncp-log\r\n      include_timestamp true    \r\n      logstash_format false\r\n      request_timeout    30s\r\n      ssl_verify false\r\n      timezone +08:00\r\n      scheme http\r\n      <buffer>\r\n        @type file\r\n        path /var/log/fluentd-buffers/kubernetes.system.buffer\r\n        flush_mode interval\r\n        retry_type exponential_backoff\r\n        flush_thread_count 2\r\n        flush_interval 5s\r\n        retry_forever\r\n        retry_max_interval 30\r\n        chunk_limit_size 2M\r\n        queue_limit_length 8\r\n        overflow_action block\r\n        timekey 1h\r\n     </buffer>\r\n    </match>\r\n---\r\nkind: Deployment\r\napiVersion: apps/v1\r\nmetadata:\r\n  name: nginx\r\n  namespace: cncp-production\r\nspec:\r\n  replicas: 3\r\n  revisionHistoryLimit: 15\r\n  selector:\r\n    matchLabels:\r\n      cncp-component: nginx\r\n  template:\r\n    metadata:\r\n      labels:\r\n        cncp-component: nginx\r\n    spec:\r\n      volumes:\r\n      - name: localtime\r\n        hostPath:\r\n          path: /etc/localtime\r\n      - name: config\r\n        configMap:\r\n          name: nginx\r\n          defaultMode: 511\r\n      - name: storage\r\n        persistentVolumeClaim:\r\n          claimName: nginx\r\n      - name: varlog\r\n        hostPath:\r\n          path: /var/log\r\n      - name: varlibdockercontainers\r\n        hostPath:\r\n          path: /var/lib/docker/containers\r\n      - name: shared-data\r\n        emptyDir: {}\r\n      initContainers:\r\n      - name: init\r\n        image: mingyangtech.com.cn/mingyang/centos:v7.9.2009\r\n        imagePullPolicy: IfNotPresent\r\n        volumeMounts:\r\n        - name: config\r\n          mountPath: /opt/nginx/nginx.conf\r\n          subPath: nginx.conf\r\n        - name: config\r\n          mountPath: /usr/local/bin/entrypoint.sh\r\n          subPath: init-entrypoint.sh\r\n        - name: storage\r\n          mountPath: /usr/local/nginx/conf/nginxconf/\r\n          subPath: usr/local/nginx/conf/nginxconf/\r\n      containers:\r\n      - name: nginx\r\n        image: mingyangtech.com.cn/mingyang/cncp-nginx:v1.2.1\r\n        imagePullPolicy: IfNotPresent\r\n        env:\r\n        - name: TZ\r\n          value: 'Asia/Shanghai'\r\n        ports:\r\n        - containerPort: 80\r\n          protocol: TCP\r\n        volumeMounts:\r\n        - name: localtime\r\n          mountPath: /etc/localtime\r\n        - name: config\r\n          mountPath: /usr/local/bin/handle-hosts.sh\r\n          subPath: handle-hosts.sh\r\n        - name: config\r\n          mountPath: /usr/local/bin/handle-outerchains.sh\r\n          subPath: handle-outerchains.sh\r\n        - name: config\r\n          mountPath: /usr/local/bin/docker-entrypoint.sh\r\n          subPath: docker-entrypoint.sh\r\n        - name: storage\r\n          mountPath: /usr/local/nginx/conf/nginxconf/\r\n          subPath: usr/local/nginx/conf/nginxconf/\r\n        - name: storage\r\n          mountPath: /usr/local/nginx/cert\r\n          subPath: usr/local/nginx/cert\r\n        - name: storage\r\n          mountPath: /usr/local/nginx/cache\r\n          subPath: usr/local/nginx/cache\r\n        #- name: storage\r\n        #  mountPath: /usr/local/nginx/logs\r\n        #  subPath: usr/local/nginx/logs\r\n        - name: shared-data\r\n          mountPath: /usr/local/nginx/logs\r\n      - name: fluentd\r\n        image: mingyangtech.com.cn/mingyang/fluentd:v1.0.0\r\n        imagePullPolicy: IfNotPresent\r\n        env:\r\n        - name: TZ\r\n          value: 'Asia/Shanghai'\r\n        env:\r\n        - name: FLUENTD_ARGS\r\n          value: --no-supervisor -q\r\n        resources:\r\n          limits:\r\n            memory: 500Mi\r\n          requests:\r\n            cpu: 100m\r\n            memory: 200Mi\r\n        volumeMounts:\r\n        - name: varlog\r\n          mountPath: /var/log\r\n        - name: varlibdockercontainers\r\n          mountPath: /var/lib/docker/containers\r\n        - name: config\r\n          mountPath: /fluentd/etc\r\n        - name: shared-data\r\n          mountPath: /usr/local/nginx/logs\r\n        securityContext:\r\n          privileged: true\r\n      nodeSelector:\r\n        kubernetes.io/os: linux\r\n      affinity:\r\n        podAntiAffinity:\r\n          requiredDuringSchedulingIgnoredDuringExecution:  # \u04f2\ufffd\ufffd\ufffd\ufffd\r\n          - labelSelector:\r\n              matchExpressions:\r\n              - key: app\r\n                operator: In\r\n                values:\r\n                - busybox-pod\r\n            topologyKey: kubernetes.io/hostname\r\n      tolerations:\r\n      - key: node.kubenetes.io/not-ready\r\n        effect: NoExecute\r\n        tolerationSeconds: 30\r\n\r\n---\r\nkind: Service\r\napiVersion: v1\r\nmetadata:\r\n  name: nginx-helper\r\n  namespace: cncp-production\r\nspec:\r\n  ports:\r\n  - protocol: TCP\r\n    port: 22\r\n    targetPort: 22\r\n    nodePort: 32004\r\n  selector:\r\n    cncp-component: nginx-helper\r\n  type: NodePort\r\n\r\n---\r\nkind: Deployment\r\napiVersion: apps/v1\r\nmetadata:\r\n  name: nginx-helper\r\n  namespace: cncp-production\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      cncp-component: nginx-helper\r\n  template: \r\n    metadata:\r\n      labels: \r\n        cncp-component: nginx-helper\r\n    spec:\r\n      volumes:\r\n      - name: localtime\r\n        hostPath:\r\n          path: /etc/localtime\r\n      - name: storage\r\n        persistentVolumeClaim:\r\n          claimName: nginx\r\n      containers:\r\n      - name: helper\r\n        image: mingyangtech.com.cn/mingyang/ssh-server:v1.0.0\r\n        imagePullPolicy: IfNotPresent\r\n        env:\r\n        - name: TZ\r\n          value: 'Asia/Shanghai'\r\n        ports:\r\n        - containerPort: 22\r\n        resources:\r\n          requests:\r\n            cpu: 10m\r\n            memory: 40Mi\r\n          limits:\r\n            cpu: 500m\r\n            memory: 2Gi\r\n        volumeMounts:\r\n        - name: localtime\r\n          mountPath: /etc/localtime\r\n        - name: storage\r\n          mountPath: /usr/local/nginx/conf/nginxconf/\r\n          subPath: usr/local/nginx/conf/nginxconf/\r\n        - name: storage\r\n          mountPath: /usr/local/nginx/cert\r\n          subPath: usr/local/nginx/cert\r\n        - name: storage\r\n          mountPath: /usr/local/nginx/cache\r\n          subPath: usr/local/nginx/cache\r\n        - name: storage\r\n          mountPath: /usr/local/nginx/logs\r\n          subPath: usr/local/nginx/logs\r\n        securityContext:\r\n          privileged: true\r\n      nodeSelector:\r\n        kubernetes.io/os: linux\r\n      tolerations:\r\n      - operator: Exists\r\n        effect: NoSchedule\r\n      - operator: Exists\r\n        effect: NoExecute\r\n  strategy:\r\n    type: Recreate\r\n\u3002", "top": 0, "createdAt": 1718160601, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-12", "dateLabelColor": "#bc4c00"}, "P26": {"htmlDir": "docs/post/bond9.html", "labels": ["\u90e8\u7f72"], "postTitle": "bond9", "postUrl": "post/bond9.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/26", "commentNum": 0, "wordCount": 790, "description": "```shell\r\nvi /etc/named.conf\r\n\r\nzone 'example.com' IN {\r\n    type master;\r\n    file '/home/ljx/example.com.zone'; // \u6307\u5b9a\u57df\u540d\u7684\u533a\u57df\u6587\u4ef6\u8def\u5f84\r\n    allow-update { none; };\r\n};\r\n#\u968f\u610f\u6587\u4ef6\u5939\r\nsudo vi /etc/named/zones/example.com.zone\r\n\r\n$TTL 86400\r\n@       IN      SOA     ns1.example.com. admin.example.com. (\r\n                        2024061301      ; Serial\r\n                        3600            ; Refresh\r\n                        1800            ; Retry\r\n                        604800          ; Expire\r\n                        86400           ; Minimum TTL\r\n                        )\r\n\r\n; \u5b9a\u4e49\u57df\u540d\u670d\u52a1\u5668\r\n@       IN      NS      ns1.example.com.\r\n\r\n; \u5b9a\u4e49\u57df\u540d\u89e3\u6790\u8bb0\u5f55\r\nns1     IN      A       192.168.1.100    ; \u66ff\u6362\u4e3a\u60a8\u7684\u670d\u52a1\u5668IP\u5730\u5740\r\nwww     IN      A       192.168.1.101    ; \u66ff\u6362\u4e3a\u60a8\u8981\u89e3\u6790\u7684\u57df\u540d\u5bf9\u5e94\u7684IP\u5730\u5740\r\n\r\nsystemctl restart named\r\n\r\n\u3002", "top": 0, "createdAt": 1718265774, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-13", "dateLabelColor": "#bc4c00"}, "P27": {"htmlDir": "docs/post/ docker-jing-xiang-jia-su.html", "labels": ["Docker"], "postTitle": " docker\u955c\u50cf\u52a0\u901f", "postUrl": "post/%20docker-jing-xiang-jia-su.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/27", "commentNum": 0, "wordCount": 214, "description": "```shell\r\nsudo mkdir -p /etc/docker\r\nsudo tee /etc/docker/daemon.json <<-'EOF'\r\n{\r\n  'registry-mirrors': ['https://nftvqaga.mirror.aliyuncs.com']\r\n}\r\nEOF\r\nsudo systemctl daemon-reload\r\nsudo systemctl restart docker\u3002", "top": 0, "createdAt": 1718609712, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-17", "dateLabelColor": "#bc4c00"}, "P28": {"htmlDir": "docs/post/docker_del_image.sh.html", "labels": ["Docker"], "postTitle": "docker_del_image.sh", "postUrl": "post/docker_del_image.sh.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/28", "commentNum": 0, "wordCount": 617, "description": "#!/bin/bash\r\n\r\nkeyword=$1\r\nversion=$2\r\n\r\nif [ -z '$keyword' ] || [ -z '$version' ]; then\r\n    echo 'Usage: $0 <keyword> <version>'\r\n    exit 1\r\nfi\r\n\r\n# \u5217\u51fa\u6240\u6709\u7b26\u5408\u5173\u952e\u8bcd\u7684\u955c\u50cf\r\nimages=$(docker image ls --format '{{.Repository}}:{{.Tag}}' | grep '$keyword')\r\n\r\n# \u5faa\u73af\u5220\u9664\u7b26\u5408\u6761\u4ef6\u7684\u955c\u50cf\r\nfor image in $images\r\ndo\r\n    repo=$(echo '$image' | cut -d ':' -f 1)\r\n    tag=$(echo '$image' | cut -d ':' -f 2)\r\n\r\n    # \u68c0\u67e5\u955c\u50cf\u7248\u672c\u662f\u5426\u5305\u542b\u6307\u5b9a\u7684\u7248\u672c\u53f7\r\n    if [[ '$tag' == *'$version'* ]]; then\r\n        docker image rm '$repo:$tag'\r\n    fi\r\ndone\r\n\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/27f074f3-68c8-42a6-9eec-9af23f3f6e77)\r\n\u3002", "top": 0, "createdAt": 1718766746, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-19", "dateLabelColor": "#bc4c00"}, "P29": {"htmlDir": "docs/post/docker_push.sh.html", "labels": ["Docker"], "postTitle": "docker_push.sh", "postUrl": "post/docker_push.sh.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/29", "commentNum": 0, "wordCount": 986, "description": "```shell\r\n#!/bin/bash\r\n\r\n# \u5b9a\u4e49\u76ee\u6807\u4ed3\u5e93\u524d\u7f00\r\nTARGET_IP='172.16.8.3'\r\n\r\n# \u83b7\u53d6\u6240\u6709\u672c\u5730\u955c\u50cf\u7684\u4fe1\u606f\r\nIMAGES=$(docker images --format '{{.Repository}}:{{.Tag}}')\r\n\r\n# \u904d\u5386\u6240\u6709\u672c\u5730\u955c\u50cf\r\nfor IMAGE in $IMAGES\r\ndo\r\n    # \u83b7\u53d6\u955c\u50cf\u7684\u539f\u59cb\u4ed3\u5e93\u548c\u6807\u7b7e\r\n    REPO=$(echo $IMAGE | cut -d':' -f1)\r\n    TAG=$(echo $IMAGE | cut -d':' -f2)\r\n\r\n    # \u6784\u9020\u65b0\u7684\u4ed3\u5e93\u5730\u5740\r\n    NEW_REPO='$TARGET_IP/$REPO'\r\n\r\n    # \u6784\u9020\u65b0\u7684\u5b8c\u6574\u6807\u7b7e\r\n    NEW_IMAGE='$NEW_REPO:$TAG'\r\n\r\n    echo 'Tagging image $IMAGE as $NEW_IMAGE'\r\n    docker tag $IMAGE $NEW_IMAGE\r\n\r\n    if [ $? -eq 0 ]; then\r\n        echo 'Successfully tagged $IMAGE as $NEW_IMAGE'\r\n\r\n        echo 'Pushing image $NEW_IMAGE to remote repository...'\r\n        docker push $NEW_IMAGE\r\n\r\n        if [ $? -eq 0 ]; then\r\n            echo 'Successfully pushed $NEW_IMAGE'\r\n        else\r\n            echo 'Failed to push $NEW_IMAGE'\r\n        fi\r\n    else\r\n        echo 'Failed to tag $IMAGE'\r\n    fi\r\ndone\r\n```\r\n![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/cb4089e5-c5b0-4687-999d-d58a8c97050b)\r\n\u3002", "top": 0, "createdAt": 1719198431, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-24", "dateLabelColor": "#bc4c00"}, "P30": {"htmlDir": "docs/post/K8S_-shi-jian-tong-bu.html", "labels": ["K8S"], "postTitle": "K8S_\u65f6\u95f4\u540c\u6b65", "postUrl": "post/K8S_-shi-jian-tong-bu.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/30", "commentNum": 0, "wordCount": 1983, "description": "\u5728 Kubernetes \u96c6\u7fa4\u4e2d\u90e8\u7f72 NTP DaemonSet \u4ee5\u540c\u6b65\u65f6\u95f4\r\n\u4ee5\u4e0b\u662f\u8be6\u7ec6\u6b65\u9aa4\uff0c\u521b\u5efa\u548c\u90e8\u7f72\u4e00\u4e2a NTP DaemonSet \u6765\u540c\u6b65\u6240\u6709 Pod \u7684\u65f6\u95f4\u3002", "top": 0, "createdAt": 1719207734, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-24", "dateLabelColor": "#bc4c00"}, "P31": {"htmlDir": "docs/post/ji-qun-xi-tong-shi-jian-tong-bu.html", "labels": ["\u95ee\u9898\u89e3\u51b3\u65b9\u6848"], "postTitle": "\u96c6\u7fa4\u7cfb\u7edf\u65f6\u95f4\u540c\u6b65", "postUrl": "post/ji-qun-xi-tong-shi-jian-tong-bu.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/31", "commentNum": 0, "wordCount": 115, "description": "![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/71acb7a0-fd8b-4e75-b38c-350b7cad84ef)\r\n\u3002", "top": 0, "createdAt": 1719298874, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-25", "dateLabelColor": "#bc4c00"}, "P32": {"htmlDir": "docs/post/li-xian-geng-xin-jing-xiang-fang-an.html", "labels": ["\u95ee\u9898\u89e3\u51b3\u65b9\u6848"], "postTitle": "\u79bb\u7ebf\u66f4\u65b0\u955c\u50cf\u65b9\u6848", "postUrl": "post/li-xian-geng-xin-jing-xiang-fang-an.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/32", "commentNum": 0, "wordCount": 117, "description": "![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/0a0a15a9-632a-41d8-bc05-16adde424fec)\r\n\r\n\u3002", "top": 0, "createdAt": 1719298923, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-25", "dateLabelColor": "#bc4c00"}, "P33": {"htmlDir": "docs/post/ji-qun-zai-nan-hui-fu-fang-an.html", "labels": ["\u95ee\u9898\u89e3\u51b3\u65b9\u6848"], "postTitle": "\u96c6\u7fa4\u707e\u96be\u6062\u590d\u65b9\u6848", "postUrl": "post/ji-qun-zai-nan-hui-fu-fang-an.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/33", "commentNum": 0, "wordCount": 115, "description": "![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/ba658f4b-645a-462c-a316-910cd60b5682)\r\n\u3002", "top": 0, "createdAt": 1719298980, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-25", "dateLabelColor": "#bc4c00"}, "P34": {"htmlDir": "docs/post/ji-qun-fa-huo-qian-zhu-yi-shi-xiang.html", "labels": ["\u95ee\u9898\u89e3\u51b3\u65b9\u6848"], "postTitle": "\u96c6\u7fa4\u53d1\u8d27\u524d\u6ce8\u610f\u4e8b\u9879", "postUrl": "post/ji-qun-fa-huo-qian-zhu-yi-shi-xiang.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/34", "commentNum": 0, "wordCount": 115, "description": "![image](https://github.com/donkeytt11111/jiaxin.github.io/assets/167744103/281c6300-2ef0-400c-8ae0-0382faf9602a)\r\n\u3002", "top": 0, "createdAt": 1719377028, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-26", "dateLabelColor": "#bc4c00"}, "P35": {"htmlDir": "docs/post/ji-qun-shi-jian-tong-bu-zhu-ru-qi-.yaml.html", "labels": ["\u95ee\u9898\u89e3\u51b3\u65b9\u6848", "K8S"], "postTitle": "\u96c6\u7fa4\u65f6\u95f4\u540c\u6b65\u6ce8\u5165\u5668.yaml", "postUrl": "post/ji-qun-shi-jian-tong-bu-zhu-ru-qi-.yaml.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/35", "commentNum": 0, "wordCount": 11160, "description": "```yaml\r\n---\r\n# Source: k8tz/templates/namespace.yaml\r\napiVersion: v1\r\nkind: Namespace\r\nmetadata:\r\n  name: k8tz\r\n  labels:\r\n    k8tz.io/controller-namespace: 'true'\r\n    helm.sh/chart: k8tz-0.16.1\r\n    app.kubernetes.io/name: k8tz\r\n    app.kubernetes.io/instance: k8tz\r\n    app.kubernetes.io/version: '0.16.1'\r\n    app.kubernetes.io/managed-by: Helm\r\n---\r\n# Source: k8tz/templates/serviceaccount.yaml\r\napiVersion: v1\r\nkind: ServiceAccount\r\nmetadata:\r\n  name: k8tz\r\n  namespace: k8tz\r\n  labels:\r\n    helm.sh/chart: k8tz-0.16.1\r\n    app.kubernetes.io/name: k8tz\r\n    app.kubernetes.io/instance: k8tz\r\n    app.kubernetes.io/version: '0.16.1'\r\n    app.kubernetes.io/managed-by: Helm\r\n---\r\n# Source: k8tz/templates/admission-webhook.yaml\r\napiVersion: v1\r\ndata:\r\n  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURFekNDQWZ1Z0F3SUJBZ0lRVmVxclBqazRQYmQ2TndYdDJRRE5pVEFOQmdrcWhraUc5dzBCQVFzRkFEQVkKTVJZd0ZBWURWUVFERXcxck9IUjZMbXM0ZEhvdWMzWmpNQjRYRFRJME1EWXdOREExTVRBMU5Gb1hEVE00TURZdwpOVEExTVRBMU5Gb3dHREVXTUJRR0ExVUVBeE1OYXpoMGVpNXJPSFI2TG5OMll6Q0NBU0l3RFFZSktvWklodmNOCkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFOZmhNSU11ZGZDdzdjcFpWdW9pZ1Z3VGNUQjZzWFVrT1RJSHdUUU8KZU9HN1hRMWJoNWFmZ1NVZUhkK3FUdTIvZFFVaWp3VjNkSjJ1THoxY0dhSU1UNGNIbzVTMXF4L3haRFRsbjljUQpxaE82Q1NXMHVTekg4UUh2KzRIU2pJWEhGS0toSEFEZ2ROUkRHdVNrM2wwZDJjeGhVREVPNFY3R2xEZEhKTUg5ClFRVWNibFYvS0ZLcE5GZU1UM1pPM2VjbEVUQ2kvaDlscVhvSDNRbDNkZUNTMkpaLy9sTW9SeTczYlBCY0h2TFEKWmlFTUVRTjdyWnIvNXI1WU1qWVNPdFdGemI2WjR3c05nUW1saStUV2xIUWNNK283UmVQTXNLYS9nZ0xWaDUrYQozcVpHRzFNNGdZZS8zZTRGaXlSZ3ZENStWbDErUzlYMFpNTXc5a3VJbmljZGN0OENBd0VBQWFOWk1GY3dEZ1lEClZSMFBBUUgvQkFRREFnV2dNQjBHQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01CQmdnckJnRUZCUWNEQWpBTUJnTlYKSFJNQkFmOEVBakFBTUJnR0ExVWRFUVFSTUErQ0RXczRkSG91YXpoMGVpNXpkbU13RFFZSktvWklodmNOQVFFTApCUUFEZ2dFQkFOT2trNnlVdW4vU2d1Ynp2QUZRN25OalVvRXhQYmM3bXNmZDJsZ0JmczFUc04zaFE5S2tJNTRuCmU5TVhNRFI5RkVUUFVwZW5vMDF0ZnNaQXgwODJMMXIya1BlenhNN2QxZ0wvUjhJdHJjRDZoWG5ldzAxVWhDMisKZUJWTDN5endBRld4SXRab0xVR1orcEJlaWxWcDBraDBrVUxJWHF0ZG9meEZrbFYyMSsxdjlFWXZrSjdySm1lVwp5Tm0rWWttbmxocjNSY3cyZWkzQVpKU0VJSktzaHhacmZHaEhNSTBFcmE3SkxzUEJWMm9JMW5nYWR3amltdEMzCjdPWGRtcW1KYlBZemRxdi9TUXFCOTVwS1kvWUhtVjZ5d1YvM0toUmI1ZXZMT05hczZ6ZFk0MTg2NkpsdGoxR0IKU2ZyQmRmekJ4VnBrSTM4QnBncTJNQUNBU2VaNlRmND0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQ==\r\n  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcFFJQkFBS0NBUUVBMStFd2d5NTE4TER0eWxsVzZpS0JYQk54TUhxeGRTUTVNZ2ZCTkE1NDRidGREVnVICmxwK0JKUjRkMzZwTzdiOTFCU0tQQlhkMG5hNHZQVndab2d4UGh3ZWpsTFdySC9Ga05PV2YxeENxRTdvSkpiUzUKTE1meEFlLzdnZEtNaGNjVW9xRWNBT0IwMUVNYTVLVGVYUjNaekdGUU1RN2hYc2FVTjBja3dmMUJCUnh1Vlg4bwpVcWswVjR4UGRrN2Q1eVVSTUtMK0gyV3BlZ2ZkQ1hkMTRKTFlsbi8rVXloSEx2ZHM4RndlOHRCbUlRd1JBM3V0Cm12L212bGd5TmhJNjFZWE52cG5qQ3cyQkNhV0w1TmFVZEJ3ejZqdEY0OHl3cHIrQ0F0V0huNXJlcGtZYlV6aUIKaDcvZDdnV0xKR0M4UG41V1hYNUwxZlJrd3pEMlM0aWVKeDF5M3dJREFRQUJBb0lCQVFDUW42TkJidUhDVXJXcgpSdmpNT0R1VGRNN3luRy9BTzNrNXhDb3g5clFTL2RPVC9FcTBwTHovSWRML29YZnBITWVIbmlSVWxEZUMzMHQwCmZ2d0pMTmdtYlA2d3hKZ1UrVUdaa20vbnc1azlSL2VTMUNUdUZEQ29qSjVnMWE0Z2ZVT2N3L1Fmdmo5bWFHSmUKNVBpM1J5VS9INzU2Ynk2YXNNeGd6LytYR2xQeDJHT0ZSamUvMjBMcVltN1k2UEo0SXJZblhnTEx2cGRRMk16SAozUUl0VjhSOU1SU1hDdmZEYmRuTkw0NXk1K2tyK0pPdDhkMXZocVpuY1ZPSitBeVFMSkNtMGZVUmpGYkFBb1EvCm5SdGNRdnI2RmNTS0IvbFh3Y3NxOG02ak4rZE03M2E1a2dRY2FVOWZVM3RvRkU1MFBhV0lsRWQveWZ0Vml1OXcKRnQySkFEVXBBb0dCQU53djcwbmcwQkZ6OVlGTnIvT3lZWUZYL3diaDVoQ0lLK3BMNjdNL3RHMUszY0prTVBUVAozanRacHRQeTdwWEhvREx3M0x5YUZVWXI0VXVzMm5uOVE1aThua2d3SzRsRWkxbDlUZUFncElNbk5ZUWhGOE9FCkNFSHhPVDRwd2dOb3dVQVNtZUo1ZCtqMVBpUDk3M3M0UjNRUW11RkZEVkNOMnRaZFc5UTRrOGZqQW9HQkFQcjkKNVpOR0pBS3pDNzd6Tk0zbHNSZ2E1b0Z1VVRVZEU0QUltMCtKNE4vMnJSTWxnUDVBSUtUaTJ5QUpKU1F0MGdCVQowSDZ6WU9Bc2MydHZYMVJZTDF0eEl4anN6RnQyWVNsbEp5bGRiaXJkRk9uS1BMTVFEUHlDV0U3MGVJWHhZZFBBCi9FemkxV090UzJ0QjhTWWJNdUVxK01xYXNKRDcyV3FUWk5lWmtzSFZBb0dBU2lWbUtmV25lMGtXTWkyc0E1OWQKRUVaR25kV3lPSHp5ZE5xT0MzVjNWNXB2Wk1lQ2FOOXpwWDdDRy90aGRsU2IwS3VsV1dsMW9vU2lRRzU3djdxVwphYmVTZ1hLZkpvRkxmNTRmZkVyaHV6eVgyOStjOWZ6Zkh2MlJMaXEzcDVnK0EwcUFRWEJ2L2FXZ0FGVEJzVGU1CmNBOHJhSkp0TW1RaWZpOC8vZzN6VGNzQ2dZRUE4TitmWmtKbkpzd0wxcnB6RDdLQ3paNXJYd1d2RzZrRzROWGgKcjJpa0Rtd2UxNFFqa2wyYXRvTWNSbGRnZEtNZ3FiNjd4UXlEU1VCL21EaHZKWFBvSnZxaDh6YTJQSVNVWkhTMgpLNldGcDg4NlZkQUhodFU5a1V2S1VpT2VVdlUvckVmR0drZUxBTGo3NnppQ3BNNXZldGFSbzJiblVvelFyODQ2CmRncmxZKzBDZ1lFQWg1bzJIaDRTZ2w3VjVsR3JreUtyeGVMRXk0dStQOHQ0MmFveHVBWnU3Z2dKWGJHRno3ZFMKYmxYcGRYQ21tRzNnaW1iVzNkSzgrNElJRXdJOWdrWnJKVnRvdGllaWdpWW15cityaTM1cjlQRVJSRHljNGUrVwpsMWoycnR4c2w5WjY0cXBVRTAvNllneUoyWnFlVE83UGRUSHVqQW0zSERvYmJZVTNpWStuY1VvPQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQ==\r\nkind: Secret\r\nmetadata:\r\n  namespace: k8tz\r\n  creationTimestamp: null\r\n  name: k8tz-tls\r\n  labels:\r\n    helm.sh/chart: k8tz-0.16.1\r\n    app.kubernetes.io/name: k8tz\r\n    app.kubernetes.io/instance: k8tz\r\n    app.kubernetes.io/version: '0.16.1'\r\n    app.kubernetes.io/managed-by: Helm\r\n---\r\n# Source: k8tz/templates/rbac.yaml\r\nkind: ClusterRole\r\napiVersion: rbac.authorization.k8s.io/v1\r\nmetadata:\r\n  name: k8tz-role\r\n  labels:\r\n    helm.sh/chart: k8tz-0.16.1\r\n    app.kubernetes.io/name: k8tz\r\n    app.kubernetes.io/instance: k8tz\r\n    app.kubernetes.io/version: '0.16.1'\r\n    app.kubernetes.io/managed-by: Helm\r\nrules:\r\n  - apiGroups: ['']\r\n    resources: ['namespaces']\r\n    verbs: ['get']\r\n  - apiGroups: ['']\r\n    resources: ['secrets']\r\n    verbs: ['get', 'list', 'watch']\r\n---\r\n# Source: k8tz/templates/rbac.yaml\r\nkind: ClusterRoleBinding\r\napiVersion: rbac.authorization.k8s.io/v1\r\nmetadata:\r\n  name: k8tz-role-binding\r\n  labels:\r\n    helm.sh/chart: k8tz-0.16.1\r\n    app.kubernetes.io/name: k8tz\r\n    app.kubernetes.io/instance: k8tz\r\n    app.kubernetes.io/version: '0.16.1'\r\n    app.kubernetes.io/managed-by: Helm\r\nsubjects:\r\n  - kind: ServiceAccount\r\n    name: k8tz\r\n    namespace: k8tz\r\nroleRef:\r\n  kind: ClusterRole\r\n  apiGroup: rbac.authorization.k8s.io\r\n  name: k8tz-role\r\n---\r\n# Source: k8tz/templates/service.yaml\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: k8tz\r\n  namespace: k8tz\r\n  labels:\r\n    helm.sh/chart: k8tz-0.16.1\r\n    app.kubernetes.io/name: k8tz\r\n    app.kubernetes.io/instance: k8tz\r\n    app.kubernetes.io/version: '0.16.1'\r\n    app.kubernetes.io/managed-by: Helm\r\nspec:\r\n  type: ClusterIP\r\n  ports:\r\n    - port: 443\r\n      targetPort: https\r\n      protocol: TCP\r\n      name: https\r\n  selector:\r\n    app.kubernetes.io/name: k8tz\r\n    app.kubernetes.io/instance: k8tz\r\n---\r\n# Source: k8tz/templates/controller.yaml\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: k8tz\r\n  namespace: k8tz\r\n  labels:\r\n    helm.sh/chart: k8tz-0.16.1\r\n    app.kubernetes.io/name: k8tz\r\n    app.kubernetes.io/instance: k8tz\r\n    app.kubernetes.io/version: '0.16.1'\r\n    app.kubernetes.io/managed-by: Helm\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app.kubernetes.io/name: k8tz\r\n      app.kubernetes.io/instance: k8tz\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        checksum/config: 1b65ca92e0327fa2cf61c6d2fde359f580be30a672adf6df067080e3ce04261b\r\n      labels:\r\n        app.kubernetes.io/name: k8tz\r\n        app.kubernetes.io/instance: k8tz\r\n    spec:\r\n      volumes:\r\n        - name: tls\r\n          secret:\r\n            secretName: k8tz-tls\r\n      serviceAccountName: k8tz\r\n      securityContext:\r\n        runAsNonRoot: true\r\n        seccompProfile:\r\n          type: RuntimeDefault\r\n      containers:\r\n        - name: k8tz\r\n          args:\r\n            - 'webhook'\r\n            - '--timezone'\r\n            - 'Asia/Shanghai'\r\n            - '--injection-strategy'\r\n            - 'initContainer'\r\n            - '--inject=true'\r\n            - '--container-name=k8tz'\r\n            - '--bootstrap-image'\r\n            - 'quay.io/k8tz/k8tz:0.16.1'\r\n          securityContext:\r\n            allowPrivilegeEscalation: false\r\n            capabilities:\r\n              drop:\r\n                - ALL\r\n            runAsNonRoot: true\r\n            seccompProfile:\r\n              type: RuntimeDefault\r\n          image: 'quay.io/k8tz/k8tz:0.16.1'\r\n          imagePullPolicy: IfNotPresent\r\n          volumeMounts:\r\n            - name: tls\r\n              mountPath: /run/secrets/tls\r\n              readOnly: true\r\n          ports:\r\n            - name: https\r\n              containerPort: 8443\r\n              protocol: TCP\r\n          livenessProbe:\r\n            httpGet:\r\n              path: /health\r\n              port: https\r\n              scheme: HTTPS\r\n          readinessProbe:\r\n            httpGet:\r\n              path: /health\r\n              port: https\r\n              scheme: HTTPS\r\n          resources: {}\r\n---\r\n# Source: k8tz/templates/admission-webhook.yaml\r\napiVersion: admissionregistration.k8s.io/v1\r\nkind: MutatingWebhookConfiguration\r\nmetadata:\r\n  name: k8tz\r\n  labels:\r\n    helm.sh/chart: k8tz-0.16.1\r\n    app.kubernetes.io/name: k8tz\r\n    app.kubernetes.io/instance: k8tz\r\n    app.kubernetes.io/version: '0.16.1'\r\n    app.kubernetes.io/managed-by: Helm\r\nwebhooks:\r\n  - name: admission-controller.k8tz.io\r\n    namespaceSelector:\r\n      matchExpressions:\r\n        - key: k8tz.io/controller-namespace\r\n          operator: NotIn\r\n          values: ['true']\r\n        - key: kubernetes.io/metadata.name\r\n          operator: NotIn\r\n          values:\r\n            - k8tz\r\n            - kube-system\r\n    sideEffects: None\r\n    failurePolicy: Fail\r\n    admissionReviewVersions: ['v1', 'v1beta1']\r\n    clientConfig:\r\n      service:\r\n        name: k8tz\r\n        namespace: k8tz\r\n        path: '/'\r\n        port: 443\r\n      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURFekNDQWZ1Z0F3SUJBZ0lRVmVxclBqazRQYmQ2TndYdDJRRE5pVEFOQmdrcWhraUc5dzBCQVFzRkFEQVkKTVJZd0ZBWURWUVFERXcxck9IUjZMbXM0ZEhvdWMzWmpNQjRYRFRJME1EWXdOREExTVRBMU5Gb1hEVE00TURZdwpOVEExTVRBMU5Gb3dHREVXTUJRR0ExVUVBeE1OYXpoMGVpNXJPSFI2TG5OMll6Q0NBU0l3RFFZSktvWklodmNOCkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFOZmhNSU11ZGZDdzdjcFpWdW9pZ1Z3VGNUQjZzWFVrT1RJSHdUUU8KZU9HN1hRMWJoNWFmZ1NVZUhkK3FUdTIvZFFVaWp3VjNkSjJ1THoxY0dhSU1UNGNIbzVTMXF4L3haRFRsbjljUQpxaE82Q1NXMHVTekg4UUh2KzRIU2pJWEhGS0toSEFEZ2ROUkRHdVNrM2wwZDJjeGhVREVPNFY3R2xEZEhKTUg5ClFRVWNibFYvS0ZLcE5GZU1UM1pPM2VjbEVUQ2kvaDlscVhvSDNRbDNkZUNTMkpaLy9sTW9SeTczYlBCY0h2TFEKWmlFTUVRTjdyWnIvNXI1WU1qWVNPdFdGemI2WjR3c05nUW1saStUV2xIUWNNK283UmVQTXNLYS9nZ0xWaDUrYQozcVpHRzFNNGdZZS8zZTRGaXlSZ3ZENStWbDErUzlYMFpNTXc5a3VJbmljZGN0OENBd0VBQWFOWk1GY3dEZ1lEClZSMFBBUUgvQkFRREFnV2dNQjBHQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01CQmdnckJnRUZCUWNEQWpBTUJnTlYKSFJNQkFmOEVBakFBTUJnR0ExVWRFUVFSTUErQ0RXczRkSG91YXpoMGVpNXpkbU13RFFZSktvWklodmNOQVFFTApCUUFEZ2dFQkFOT2trNnlVdW4vU2d1Ynp2QUZRN25OalVvRXhQYmM3bXNmZDJsZ0JmczFUc04zaFE5S2tJNTRuCmU5TVhNRFI5RkVUUFVwZW5vMDF0ZnNaQXgwODJMMXIya1BlenhNN2QxZ0wvUjhJdHJjRDZoWG5ldzAxVWhDMisKZUJWTDN5endBRld4SXRab0xVR1orcEJlaWxWcDBraDBrVUxJWHF0ZG9meEZrbFYyMSsxdjlFWXZrSjdySm1lVwp5Tm0rWWttbmxocjNSY3cyZWkzQVpKU0VJSktzaHhacmZHaEhNSTBFcmE3SkxzUEJWMm9JMW5nYWR3amltdEMzCjdPWGRtcW1KYlBZemRxdi9TUXFCOTVwS1kvWUhtVjZ5d1YvM0toUmI1ZXZMT05hczZ6ZFk0MTg2NkpsdGoxR0IKU2ZyQmRmekJ4VnBrSTM4QnBncTJNQUNBU2VaNlRmND0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQ==\r\n    rules:\r\n      - operations: ['CREATE']\r\n        apiGroups: ['']\r\n        apiVersions: ['v1']\r\n        resources: ['pods']\r\n      - operations: ['CREATE']\r\n        apiGroups: ['batch']\r\n        apiVersions: ['v1']\r\n        resources: ['cronjobs']\r\n---\r\n\r\n```\u3002", "top": 0, "createdAt": 1719388550, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-26", "dateLabelColor": "#bc4c00"}, "P36": {"htmlDir": "docs/post/chao-yun-wang-kou-ding-yi.html", "labels": ["\u90e8\u7f72", "\u7cfb\u7edf\u67b6\u6784"], "postTitle": "\u8d85\u4e91\u7f51\u53e3\u5b9a\u4e49", "postUrl": "post/chao-yun-wang-kou-ding-yi.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/36", "commentNum": 0, "wordCount": 1221, "description": "enp6s0 0000:06:00.0\r\nenp5s0 0000:05:00.0 \u5e26\u5916\u7ba1\u7406\r\n\r\nenp1s0f0 0000:01:00.0 \u96c6\u7fa4\u7f51\u7edcBond\r\nenp1s0f1 0000:01:00.1 \u96c6\u7fa4\u7f51\u7edcBond\r\n\r\nenp7s0f0 0000:07:00.0\r\nenp7s0f1 0000:07:00.1\r\nenp7s0f2 0000:07:00.2\r\nenp7s0f3 0000:07:00.3\r\n\r\n\r\n\ud83d\udc4d \r\nR3215\u65b0\u7248 (Master123)\r\nenp1s0f0 0000:01:00.0 \u677f\u8f7d\u5de6\u4fa7\r\nenp1s0f1 0000:01:00.1 \u677f\u8f7d\u53f3\u4fa7\r\n\r\nenp193s0f0 0000:c1:00.0 Slot 3 Port 1 10G\u5149\r\nenp193s0f1 0000:c1:00.1 Slot 3 Port 2 10G\u5149\r\nenp193s0f2 0000:c1:00.2 Slot 3 Port 3 10G\u5149\r\nenp193s0f3 0000:c1:00.3 Slot 3 Port 4 10G\u5149\r\n\r\nenp65s0f0 0000:41:00.0 Slot 5 Port 1 1G\u7535\r\nenp65s0f1 0000:41:00.1 Slot 5 Port 2 1G\u7535\r\n\r\nenp68s0f0 0000:44:00.0 Slot 6 Port 1 1G\u7535\r\nenp68s0f1 0000:44:00.1 Slot 6 Port 2 1G\u7535\r\nenp68s0f2 0000:44:00.2 Slot 6 Port 3 1G\u7535\r\nenp68s0f3 0000:44:00.3 Slot 6 Port 4 1G\u7535\r\n\r\n\ud83d\udc4d R3215\u65e7\u7248\r\nenp4s0f0 0000:04:00.0 \u677f\u8f7d\u5de6\u4fa7\r\nenp4s0f1 0000:04:00.1 \u677f\u8f7d\u53f3\u4fa7\r\n\r\nenp9s0f0 0000:09:00.0 Slot 1 Port 1 1G\u7535\r\nenp9s0f1 0000:09:00.1 Slot 1 Port 2 1G\u7535\r\nenp9s0f2 0000:09:00.2 Slot 1 Port 3 1G\u7535\r\nenp0s0f3 0000:09:00.3 Slot 1 Port 4 1G\u7535\r\n\r\nenp129s0f0 0000:81:00.0 Slot 2 Port 1 1G\u7535\r\nenp129s0f1 0000:81:00.1 Slot 2 Port 2 1G\u7535\r\n\r\nenp65s0f0 0000:41:00.0 Slot 6 Port 1 10G\u5149\r\nenp65s0f1 0000:41:00.1 Slot 6 Port 2 10G\u5149\r\n\r\nenp1s0f0 0000:01:00.0 Slot 7 Port 1 10G\u5149\r\nenp1s0f0 0000:01:00.1 Slot 7 Port 2 10G\u5149\u3002", "top": 0, "createdAt": 1719391349, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-26", "dateLabelColor": "#bc4c00"}, "P37": {"htmlDir": "docs/post/dhcp-pei-zhi-wen-jian.html", "labels": ["\u914d\u7f6e\u6587\u4ef6"], "postTitle": "dhcp\u914d\u7f6e\u6587\u4ef6", "postUrl": "post/dhcp-pei-zhi-wen-jian.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/37", "commentNum": 0, "wordCount": 239, "description": "```shell\r\nddns-update-style none;\r\nsubnet 172.16.8.0 netmask 255.255.255.0\r\n{\r\nrange 172.16.8.201 172.16.8.240;\r\noption routers 172.16.8.1;\r\ndefault-lease-time 600;\r\nmax-lease-time 7200;\r\n#filename'ipxe.efi';\r\n#next-server 172.16.8.2;\r\n}\r\n\u3002", "top": 0, "createdAt": 1719449881, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-27", "dateLabelColor": "#bc4c00"}, "P38": {"htmlDir": "docs/post/talos-ying-pan-gua-zai-fang-fa.html", "labels": ["\u7cfb\u7edf\u67b6\u6784"], "postTitle": "talos\u786c\u76d8\u6302\u8f7d\u65b9\u6cd5", "postUrl": "post/talos-ying-pan-gua-zai-fang-fa.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/38", "commentNum": 0, "wordCount": 7235, "description": "0. \u5f00\u59cb\u64cd\u4f5c\u524d\uff0c\u8bf7\u8ba4\u771f\u9605\u8bfb\u4ee5\u4e0b\u8bf4\u660e\uff1a\r\n(1) \u8c03\u6574\u78c1\u76d8\u6302\u8f7d\u914d\u7f6e\u4f1a\u88abTalos\u7cfb\u7edf\u5f3a\u5236\u89e6\u53d1\u91cd\u542f\uff0c\u8bf7\u786e\u4fdd\u96c6\u7fa4\u6ca1\u6709\u4eba\u5728\u7528\u540e\u518d\u6267\u884c\uff01\r\n(2) \u7531\u4e8e\u64cd\u4f5c\u78c1\u76d8\u4e3a\u9ad8\u5ea6\u98ce\u9669\u64cd\u4f5c\uff0c\u6570\u636e\u65e0\u4ef7\uff0c\u8bf7\u786e\u8ba4\u7cbe\u795e\u72b6\u6001\u826f\u597d\uff0c\u89c6\u529b\u6b63\u5e38\uff0c\u80fd\u770b\u6e05\u6bcf\u4e00\u4e2a\u5b57\u6bcd\u540e\u518d\u64cd\u4f5c\uff01\r\n(3) \u5982\u679c\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u53d1\u73b0\u8fd4\u56de\u7ed3\u679c\u5f02\u5e38\uff0c\u8bf7\u7acb\u5373\u505c\u6b62\u64cd\u4f5c\uff0c\u5fc5\u8981\u65f6\u8bf7\u7acb\u5373\u62d4\u6389\u8bbe\u5907\u4e0a\u7684\u7535\u6e90\u7ebf\uff0c\u5e76\u5bfb\u6c42\u5e2e\u52a9\uff01\r\n\r\n1. \u901a\u8fc7talosctl disks\u786e\u8ba4\u76ee\u6807\u78c1\u76d8\u662f\u5426\u5728\u4f4d\r\nNODE           DEV        MODEL              SERIAL   TYPE   UUID   WWID   MODALIAS      NAME   SIZE     BUS_PATH                                                                SUBSYSTEM          SYSTEM_DISK\r\n172.16.8.192   /dev/sda   D300 240G-SSDD03   -        SSD    -      -      scsi:t-0x00   -      240 GB   /pci0000:00/0000:00:08.1/0000:12:00.2/ata2/host1/target1:0:0/1:0:0:0/   /sys/class/block   *\r\n172.16.8.192   /dev/sdb   ST2000NM000B-2TD   -        HDD    -      -      scsi:t-0x00   -      2.0 TB   /pci0000:00/0000:00:08.1/0000:12:00.2/ata3/host2/target2:0:0/2:0:0:0/   /sys/class/block   \r\n172.16.8.193   /dev/sda   D300 240G-SSDD03   -        SSD    -      -      scsi:t-0x00   -      240 GB   /pci0000:00/0000:00:08.1/0000:12:00.2/ata2/host1/target1:0:0/1:0:0:0/   /sys/class/block   *\r\n172.16.8.193   /dev/sdb   ST2000NM000B-2TD   -        HDD    -      -      scsi:t-0x00   -      2.0 TB   /pci0000:00/0000:00:08.1/0000:12:00.2/ata3/host2/target2:0:0/2:0:0:0/   /sys/class/block \r\n\r\n\uff08\u6ce8\uff1a\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u56fa\u6001\u786c\u76d8(SSD)\u5e94\u8be5\u4f4d\u4e8e/dev/sda\uff0c\u673a\u68b0\u786c\u76d8(HDD)\u5e94\u8be5\u4f4d\u4e8e/dev/sdb\uff0c\u5982\u679c/dev/sdb\u786c\u76d8\u672a\u5728\u4f4d\uff0c\u6216\u8005\u4e24\u5757\u786c\u76d8\u4f4d\u7f6e\u76f8\u53cd\uff0c\u8bf7\u8054\u7cfb\u4ea7\u54c1\u786c\u4ef6\u7ec4\u8fdb\u884c\u786e\u8ba4\u68c0\u67e5\uff09\r\n\r\n2. \u901a\u8fc7talosctl mounts\u786e\u8ba4\u76ee\u6807\u78c1\u76d8\u662f\u5426\u5df2\u88ab\u6302\u8f7d\r\nNODE           FILESYSTEM                                                   SIZE(GB)   USED(GB)   AVAILABLE(GB)   PERCENT USED   MOUNTED ON\r\n172.16.8.192   devtmpfs                                                     16.73      0.00       16.73           0.00%          /dev\r\n172.16.8.192   tmpfs                                                        16.77      0.01       16.77           0.03%          /run\r\n172.16.8.192   tmpfs                                                        16.77      0.00       16.77           0.00%          /system\r\n172.16.8.192   tmpfs                                                        0.07       0.00       0.07            0.00%          /tmp\r\n172.16.8.192   overlay                                                      0.00       0.00       0.00            100.00%        /\r\n172.16.8.192   rootfs                                                       16.73      0.06       16.67           0.38%          /lib/firmware\r\n172.16.8.192   tmpfs                                                        16.77      0.00       16.77           0.00%          /dev/shm\r\n172.16.8.192   tmpfs                                                        16.77      0.00       16.77           0.00%          /etc/cri/conf.d/hosts\r\n172.16.8.192   overlay                                                      16.77      0.00       16.77           0.00%          /usr/etc/udev\r\n172.16.8.192   /dev/sda5                                                    0.10       0.01       0.09            6.30%          /system/state\r\n172.16.8.192   overlay                                                      16.77      0.00       16.77           0.00%          /usr/local/lib/containers/hello-world\r\n172.16.8.192   /dev/sda6                                                    238.68     21.56      217.12          9.03%          /var\r\n......\r\n\r\n\uff08\u6ce8\uff1a\u5feb\u901f\u786e\u8ba4\u53ef\u4ee5\u4f7f\u7528 talosctl mounts | grep /dev/sdb\uff0c\u5982\u679c\u76ee\u6807Node\u6ca1\u6709\u8f93\u51fa\u7ed3\u679c\u8bf4\u660e\u6ca1\u6709\u6302\u8f7d\uff1b\u76ee\u6807Node\u4ec5\u8f93\u51fa\u4e00\u884c /var/openebs/local2 \u8bf4\u660e\u5df2\u6302\u8f7d\u4f46\u672a\u6295\u5165\u4f7f\u7528\uff0c\u663e\u793a\u591a\u884c /var/lib/kubelet/pods \u8bf4\u660e\u5df2\u7ecf\u6709PVC\u5728\u4f4d\uff0c\u7981\u6b62\u5728\u672a\u5904\u7406PVC\u7684\u524d\u63d0\u4e0b\u89e3\u9664\u6302\u8f7d\uff0c\u5426\u5219\u6570\u636e\u4f1a\u4e22\uff09\r\n172.16.8.193   /dev/sdb1                                                    1999.42    14.03      1985.39         0.70%          /var/openebs/local2\r\n172.16.8.193   /dev/sdb1                                                    1999.42    14.03      1985.39         0.70%          /var/lib/kubelet/pods/cd77311b-b37f-4f12-9e7b-4463fcca9b3d/volumes/kubernetes.io~local-volume/pvc-7f42effa-94c8-4027-9487-f8fdd132e4af\r\n172.16.8.193   /dev/sdb1                                                    1999.42    14.03      1985.39         0.70%          /var/lib/kubelet/pods/532725e8-267d-4edd-9200-2e3b7c7e28c5/volumes/kubernetes.io~local-volume/pvc-dd6d6410-7b6f-4ae1-b1aa-d1cd4ba81ecb\r\n172.16.8.193   /dev/sdb1                                                    1999.42    14.03      1985.39         0.70%          /var/lib/kubelet/pods/b02f0998-929b-40cf-8489-ee2a3dc869ab/volumes/kubernetes.io~local-volume/pvc-f5e3468b-ea5a-4730-9308-249e0d96a753\r\n172.16.8.193   /dev/sdb1                                                    1999.42    14.03      1985.39         0.70%          /var/lib/kubelet/pods/29b9ec08-56bf-404a-8d6f-5068e7103b25/volumes/kubernetes.io~local-volume/pvc-3c06cf2a-5d91-4775-a54f-06149ba515cc\r\n\r\n3. \u4fee\u6539Talos MachineConfig\uff08\u5efa\u8bae\u4ece\u6700\u540e\u4e00\u4e2a\u96c6\u7fa4\u5f00\u59cb\uff0c\u5012\u5e8f\u4fee\u6539\uff0c\u4f7f\u7528 talosctl edit mc -n IP \u9010\u53f0\u4fee\u6539\uff0c\u7981\u6b62\u540c\u65f6\u4fee\u6539\u591a\u4e2a\u8282\u70b9\uff09\r\n\u5728 machine: \u5b57\u6bb5\u4e0b\u8865\u5145\u5982\u4e0b\u5185\u5bb9\uff1a\r\n\r\nmachine:\r\n    disks:\r\n        - device: /dev/sdb # \u8bf7\u591a\u6b21\u786e\u8ba4\uff0c\u4e25\u7981\u5199\u6210 /dev/sda\uff0c\u5426\u5219\u8282\u70b9\u5fc5\u70b8\uff01\r\n           partitions:\r\n              - mountpoint: /var/openebs/local2\r\n\r\n\uff08\u6ce8\uff1a/dev/sdb \u540e\u9762\u4e0d\u8981\u52a01\uff0c\u5982 /dev/sdb1\uff0cTalos\u4f1a\u81ea\u52a8\u8865\u5168\uff09\r\n\r\n\u5728machine.kubelet.extraMounts \u5b57\u6bb5\u4e0b\u8865\u5145\u5982\u4e0b\u5185\u5bb9\uff1a\r\n\r\nmachine:\r\n  kubelet:\r\n    extraMounts:\r\n      - destination: /var/openebs/local2\r\n        type: bind\r\n        source: /var/openebs/local2\r\n        options:\r\n          - bind\r\n          - rshared\r\n          - rw\r\n\r\n\u786e\u8ba4\u65e0\u8bef\u540e\u4fdd\u5b58\u9000\u51fa\u3002", "top": 0, "createdAt": 1720509579, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-09", "dateLabelColor": "#bc4c00"}, "P39": {"htmlDir": "docs/post/bian-yuan-guan-kong-guan-zhuang-ming-ling.html", "labels": ["\u7cfb\u7edf\u67b6\u6784", "\u914d\u7f6e\u6587\u4ef6"], "postTitle": "\u8fb9\u7f18\u7ba1\u63a7\u7f50\u88c5\u547d\u4ee4", "postUrl": "post/bian-yuan-guan-kong-guan-zhuang-ming-ling.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/39", "commentNum": 0, "wordCount": 7900, "description": "Sidero Metal Clusterctl \u5b89\u88c5\r\n\r\nexport SIDERO_CONTROLLER_MANAGER_HOST_NETWORK=true\r\nexport SIDERO_CONTROLLER_MANAGER_DEPLOYMENT_STRATEGY=Recreate\r\nexport SIDERO_CONTROLLER_MANAGER_API_ENDPOINT=172.16.102.80\r\nexport SIDERO_CONTROLLER_MANAGER_SIDEROLINK_ENDPOINT=172.16.102.80\r\nexport CLUSTERCTL_LOG_LEVEL=5\r\nexport CLUSTERCTL_DISABLE_VERSIONCHECK=true\r\n\r\nclusterctl init -b talos:v0.6.2 -c talos:v0.5.3 -i sidero:v0.6.1\r\n\r\n-----\r\n\r\nHarbor Helm Chart \u5b89\u88c5\r\n\r\nhelm install --create-namespace --namespace harbor harbor ./ \\\r\n  --set expose.type=clusterIP \\\r\n  --set expose.tls.auto.commonName=172.16.102.79 \\\r\n  --set externalURL=https://172.16.102.79 \\\r\n  --set trivy.enabled=false \\\r\n  --set metrics.enabled=true \\\r\n  --set persistence.persistentVolumeClaim.registry.storageClass=openebs-sc \\\r\n  --set persistence.persistentVolumeClaim.jobservice.jobLog.storageClass=openebs-sc \\\r\n  --set persistence.persistentVolumeClaim.database.storageClass=openebs-sc \\\r\n  --set persistence.persistentVolumeClaim.redis.storageClass=openebs-sc \\\r\n  --set persistence.persistentVolumeClaim.trivy.storageClass=openebs-sc \\\r\n  --set nginx.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set portal.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set core.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set jobservice.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set registry.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01\\\r\n  --set trivy.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set database.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set redis.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01  \\\r\n  --set exporter.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01\r\n\r\n-----\r\n\r\nHarbor Nginx Metal LB \u670d\u52a1\u66b4\u9732\u914d\u7f6e\r\n\r\ncat <<EOF | kubectl apply -f -\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: harbor-loadbalancer\r\n  namespace: harbor\r\nspec:\r\n  selector:\r\n    app: harbor\r\n    component: nginx\r\n  ipFamilies:\r\n  - IPv4\r\n  ipFamilyPolicy: SingleStack\r\n  ports:\r\n  - name: http\r\n    port: 80\r\n    targetPort: 8080\r\n  - name: https\r\n    port: 443\r\n    targetPort: 8443\r\n  type: LoadBalancer\r\n  loadBalancerIP: 172.16.102.79\r\n  allocateLoadBalancerNodePorts: false\r\nEOF\r\n\r\n-----\r\n\r\nSigNoz Helm Chart \u5b89\u88c5\r\n\r\nhelm install --create-namespace --namespace signoz signoz ./ \\\r\n  --set global.storageClass=openebs-sc \\\r\n  --set clickhouse.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set clickhouse.clickhouseOperator.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set queryService.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set frontend.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set alertmanager.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set otelCollector.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01 \\\r\n  --set otelCollectorMetrics.nodeSelector.'kubernetes\\.io/hostname'=cncp-ms-01\r\n\r\n-----\r\n\r\nSigNoz Frontend Metal LB \u670d\u52a1\u66b4\u9732\u914d\u7f6e\r\n\r\ncat <<EOF | kubectl apply -f -\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: signoz-frontend-loadbalancer\r\n  namespace: signoz\r\nspec:\r\n  selector:\r\n    app.kubernetes.io/component: frontend\r\n    app.kubernetes.io/instance: signoz\r\n    app.kubernetes.io/name: signoz\r\n  ipFamilies:\r\n  - IPv6\r\n  ipFamilyPolicy: SingleStack\r\n  ports:\r\n  - name: http\r\n    port: 3301\r\n    protocol: TCP\r\n    targetPort: http\r\n  type: LoadBalancer\r\n  loadBalancerIP: 2408:8631:c02:ffa2::78\r\n  allocateLoadBalancerNodePorts: false\r\nEOF\r\n\r\n-----\r\n\r\nSigNoz Otel-collector Metal LB \u670d\u52a1\u66b4\u9732\u914d\u7f6e\r\n\r\ncat <<EOF | kubectl apply -f -\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: signoz-otel-collector-loadbalancer\r\n  namespace: signoz\r\nspec:\r\n  selector:\r\n    app.kubernetes.io/component: otel-collector\r\n    app.kubernetes.io/instance: signoz\r\n    app.kubernetes.io/name: signoz\r\n  ipFamilies:\r\n  - IPv6\r\n  ipFamilyPolicy: SingleStack\r\n  ports:\r\n  - name: jaeger-grpc\r\n    port: 14250\r\n    protocol: TCP\r\n    targetPort: jaeger-grpc\r\n  - name: jaeger-thrift\r\n    port: 14268\r\n    protocol: TCP\r\n    targetPort: jaeger-thrift\r\n  - name: metrics\r\n    port: 8888\r\n    protocol: TCP\r\n    targetPort: metrics\r\n  - name: otlp\r\n    port: 4317\r\n    protocol: TCP\r\n    targetPort: otlp\r\n  - name: otlp-http\r\n    port: 4318\r\n    protocol: TCP\r\n    targetPort: otlp-http\r\n  type: LoadBalancer\r\n  loadBalancerIP: 2408:8631:c02:ffa2::79\r\n  allocateLoadBalancerNodePorts: false\r\nEOF\r\n\r\n---\r\n\r\n\u8fb9\u7f18\u7ba1\u63a7 HTTP\u670d\u52a1 \u90e8\u7f72\r\n\r\ncat <<EOF | kubectl apply -f -\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: ucp-http\r\n  namespace: ucp\r\nspec:\r\n  selector:\r\n    matchLabels:\r\n      app: http\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: http\r\n    spec:\r\n      nodeSelector:\r\n        kubernetes.io/hostname: cncp-ms-01\r\n      containers:\r\n        - name: http\r\n          image: mrwsydocker/ucp-http:0.12\r\n          imagePullPolicy: IfNotPresent\r\n          resources:\r\n            limits:\r\n              memory: '128Mi'\r\n              cpu: '500m'\r\n          ports:\r\n            - name: http\r\n              containerPort: 80\r\n          volumeMounts:\r\n            - name: nginx-config-default\r\n              mountPath: '/etc/nginx/conf.d/default.conf'\r\n              subPath: 'default.conf'\r\n              readOnly: true\r\n      volumes:\r\n        - name: nginx-config-default\r\n          configMap:\r\n            name: nginx-config-default\r\n---\r\napiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: nginx-config-default\r\n  namespace: ucp\r\ndata:\r\n  default.conf: |\r\n    server {\r\n      listen 80;\r\n      listen [::]:80;\r\n      server_name _;\r\n      location / {\r\n        autoindex on;\r\n        root /webroot;\r\n      }\r\n    }\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: http\r\n  namespace: ucp\r\nspec:\r\n  selector:\r\n    app: http\r\n  ports:\r\n  - name: http\r\n    port: 80\r\n    protocol: TCP\r\n    targetPort: 80\r\n    nodePort: 31080\r\n  type: NodePort \r\nEOF\r\n\r\n-----\r\n\r\n\u8fb9\u7f18\u7ba1\u63a7 NTP\u670d\u52a1 \u90e8\u7f72\r\n\r\ncat <<EOF | kubectl apply -f -\r\napiVersion: apps/v1\r\nkind: DaemonSet\r\nmetadata:\r\n  name: ntpserver\r\n  namespace: ucp\r\n  labels:\r\n    app: ntpserver\r\nspec:\r\n  selector:\r\n    matchLabels:\r\n      app: ntpserver\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: ntpserver\r\n    spec:\r\n      tolerations:\r\n        - key: node-role.kubernetes.io/control-plane\r\n          operator: Exists\r\n          effect: NoSchedule\r\n        - key: node-role.kubernetes.io/master\r\n          operator: Exists\r\n          effect: NoSchedule\r\n      containers:\r\n        - name: ntpserver\r\n          image: mrwsydocker/ntpserver:0.1\r\n          resources:\r\n            limits:\r\n              memory: 256Mi\r\n            requests:\r\n              cpu: 50m\r\n              memory: 32Mi\r\n          ports:\r\n            - name: ntp\r\n              protocol: UDP\r\n              containerPort: 123\r\n              hostPort: 123\r\n          volumeMounts:\r\n            - name: ntpserver-config\r\n              mountPath: '/etc/chrony/chrony.conf'\r\n              subPath: 'chrony.conf'\r\n              readOnly: true\r\n      terminationGracePeriodSeconds: 30\r\n      volumes:\r\n        - name: ntpserver-config\r\n          configMap:\r\n            name: ntpserver-config\r\n---\r\napiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: ntpserver-config\r\n  namespace: ucp\r\ndata:\r\n  chrony.conf: |\r\n    bindaddress 0.0.0.0\r\n    bindaddress ::\r\n    driftfile /var/lib/chrony/drift\r\n    logdir /var/log/chrony\r\n    local stratum 10\r\n    pool 0.pool.ntp.org iburst minpoll 6 maxpoll 24 maxsources 3\r\n    pool 1.pool.ntp.org iburst minpoll 6 maxpoll 24 maxsources 3\r\n    pool 2.pool.ntp.org iburst minpoll 6 maxpoll 24 maxsources 3\r\n    pool 3.pool.ntp.org iburst minpoll 6 maxpoll 24 maxsources 3\r\n    allow 0.0.0.0/0\r\n    allow ::/0\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: ntpserver\r\n  namespace: ucp\r\nspec:\r\n  selector:\r\n    app: ntpserver\r\n  ports:\r\n    - name: ntp\r\n      port: 123\r\n      protocol: TCP\r\n      targetPort: 123\r\n  type: ClusterIP\r\nEOF\u3002", "top": 0, "createdAt": 1720510558, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-09", "dateLabelColor": "#bc4c00"}, "P40": {"htmlDir": "docs/post/ying-pan-gua-zai-pei-zhi-wen-jian.html", "labels": ["\u914d\u7f6e\u6587\u4ef6"], "postTitle": "\u786c\u76d8\u6302\u8f7d\u914d\u7f6e\u6587\u4ef6", "postUrl": "post/ying-pan-gua-zai-pei-zhi-wen-jian.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/40", "commentNum": 0, "wordCount": 11570, "description": "```yaml\r\n# Editing MachineConfigs.config.talos.dev/v1alpha1 at node 172.16.8.192\r\nversion: v1alpha1\r\ndebug: false\r\npersist: true\r\nmachine:\r\n  disks:\r\n    - device: /dev/sdb\r\n      partitions:\r\n        - mountpoint: /var/openebs/local2\r\n  type: controlplane\r\n  token: 26yer4.i0q29jdpr62vpfrk\r\n  ca:\r\n    crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJQakNCOGFBREFnRUNBaEFCYUhSZmxCTnh2UUg5S1kyT1kwRVNNQVVHQXl0bGNEQVFNUTR3REFZRFZRUUsKRXdWMFlXeHZjekFlRncweU5EQTNNREV3TnpVME16WmFGdzB6TkRBMk1qa3dOelUwTXpaYU1CQXhEakFNQmdOVgpCQW9UQlhSaGJHOXpNQ293QlFZREsyVndBeUVBK0VKZXpsRmhpYTNIVGxtRDhWYnQvRTZVSUI5bkNCdGdYTHFpCjlwZEo5Q2lqWVRCZk1BNEdBMVVkRHdFQi93UUVBd0lDaERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFRWUkKS3dZQkJRVUhBd0l3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFkQmdOVkhRNEVGZ1FVWHZudmMvcjRlRHk4aTZ1aQpZWXdlTVNMVGFXSXdCUVlESzJWd0EwRUErbHIyU0hlL1NiRjB3VTlIWS9LSVFMcis5VmNBU1VTT242VHd0V1FKCnZ5VEwxTXVmRXZ4eW1WRlZ1QS9LWUFNRStkc3ZIMVkyeDVLMjdTS2w5TFFDQmc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==\r\n    key: LS0tLS1CRUdJTiBFRDI1NTE5IFBSSVZBVEUgS0VZLS0tLS0KTUM0Q0FRQXdCUVlESzJWd0JDSUVJTkMvV05XMFdDUFBaMitOdENBWk1udVhQZ2w0ckNobExQVFVzd3hCNzQvVgotLS0tLUVORCBFRDI1NTE5IFBSSVZBVEUgS0VZLS0tLS0K\r\n  certSANs: []\r\n  kubelet:\r\n    image: ghcr.io/siderolabs/kubelet:v1.28.5\r\n    extraMounts:\r\n      - destination: /var/openebs/local\r\n        type: bind\r\n        source: /var/openebs/local\r\n        options:\r\n          - bind\r\n          - rshared\r\n          - rw\r\n      - destination: /var/openebs/local2\r\n        type: bind\r\n        source: /var/openebs/local2\r\n        options:\r\n          - bind\r\n          - rshared\r\n          - rw\r\n      - destination: /var/local-storage\r\n        type: bind\r\n        source: /var/local-storage\r\n        options:\r\n          - bind\r\n          - rshared\r\n          - rw\r\n    extraConfig:\r\n      containerLogMaxFiles: 5\r\n      containerLogMaxSize: 30Mi\r\n    defaultRuntimeSeccompProfileEnabled: true\r\n    disableManifestsDirectory: true\r\n  pods:\r\n    - apiVersion: v1\r\n      kind: Pod\r\n      metadata:\r\n        name: manager\r\n        namespace: kube-system\r\n      spec:\r\n        containers:\r\n          - image: mingyangtech.com.cn/mingyang/centos7:v1.0.0\r\n            imagePullPolicy: IfNotPresent\r\n            name: manager\r\n            resources:\r\n              limits:\r\n                cpu: 50m\r\n                memory: 200Mi\r\n            securityContext:\r\n              privileged: true\r\n            volumeMounts:\r\n              - mountPath: /etc/cni\r\n                name: cni\r\n        hostNetwork: true\r\n        priorityClassName: system-node-critical\r\n        restartPolicy: Always\r\n        volumes:\r\n          - hostPath:\r\n              path: /etc/cni\r\n              type: DirectoryOrCreate\r\n            name: cni\r\n  network:\r\n    hostname: cncp-ms-01\r\n    interfaces:\r\n      - bond:\r\n          deviceSelectors:\r\n            - busPath: 0000:0b:00.0\r\n            - busPath: 0000:0c:00.0\r\n          mode: active-backup\r\n        interface: bond-ip6\r\n      - bond:\r\n          deviceSelectors:\r\n            - busPath: 0000:12:00.0\r\n            - busPath: 0000:13:00.0\r\n          mode: active-backup\r\n        interface: bond-ip4\r\n      - addresses:\r\n          - 172.16.8.192/24\r\n          - 2408:8631:c02:ff08::192/64\r\n        routes:\r\n          - network: 0.0.0.0/0\r\n            gateway: 172.16.8.1\r\n          - network: ::/0\r\n            gateway: 2408:8631:c02:ff08::1\r\n        bond:\r\n          deviceSelectors:\r\n            - busPath: 0000:07:00.0\r\n            - busPath: 0000:08:00.0\r\n          mode: active-backup\r\n        interface: bond-cluster\r\n    nameservers:\r\n      - 114.114.114.114\r\n      - 8.8.8.8\r\n      - 2400:3200::1\r\n      - 2400:3200:baba::1\r\n    extraHostEntries:\r\n      - ip: 172.16.8.192\r\n        aliases:\r\n          - endpoint\r\n          - cncp-ms-01\r\n  install:\r\n    disk: /dev/sda\r\n    image: ghcr.io/siderolabs/installer:v1.5.5-mycos2\r\n    extensions:\r\n      - image: ghcr.io/siderolabs/iscsi-tools:v0.1.1\r\n      - image: ghcr.io/nanfei-chen/hello-world-service:v1.4.0\r\n    wipe: false\r\n  time:\r\n    disabled: false\r\n    servers:\r\n      - cn.ntp.org.cn\r\n  sysctls:\r\n    vm.max_map_count: 262144\r\n  registries:\r\n    mirrors:\r\n      '*':\r\n        endpoints:\r\n          - https://172.16.1.200/v2/\r\n      docker.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/docker.io\r\n        overridePath: true\r\n      gcr.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/gcr.io\r\n        overridePath: true\r\n      ghcr.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/ghcr.io\r\n        overridePath: true\r\n      k8s.gcr.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/k8s.gcr.io\r\n        overridePath: true\r\n      mingyangtech.com.cn:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/mingyangtech.com.cn\r\n        overridePath: true\r\n      nvcr.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/nvcr.io\r\n        overridePath: true\r\n      quay.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/quay.io\r\n        overridePath: true\r\n      registry.k8s.io:\r\n        endpoints:\r\n          - https://172.16.1.200/v2/registry.k8s.io\r\n        overridePath: true\r\n    config:\r\n      172.16.1.200:\r\n        tls:\r\n          insecureSkipVerify: true\r\n      172.16.106.11:10080:\r\n        auth:\r\n          username: admin\r\n          password: Passw0rd@MY\r\n  features:\r\n    rbac: true\r\n    stableHostname: true\r\n    apidCheckExtKeyUsage: true\r\n    diskQuotaSupport: true\r\n  kernel:\r\n    modules:\r\n      - name: nfsd\r\n      - name: ngbe\r\n      - name: txgbe\r\n      - name: jool\r\n      - name: jool_siit\r\n      - name: jool_common\r\n  nodeLabels:\r\n    node-role.kubernetes.io/master: ''\r\ncluster:\r\n  id: b9rXRBFHdsd8Umf5VP3DDNT-UDfJvo9O1aqTYAdBlhI=\r\n  secret: 6tHGd/NZptvAwfSw1JQxVCzF+lPnOaigorcjPqcfQJs=\r\n  controlPlane:\r\n    endpoint: https://172.16.8.192:6443\r\n  clusterName: mingyang\r\n  network:\r\n    cni:\r\n      name: custom\r\n      urls:\r\n        - http://172.16.106.11:8088/mingyang/cncp/cilium-dsr.yaml\r\n    dnsDomain: cluster.local\r\n    podSubnets:\r\n      - 10.32.0.0/16\r\n      - fd00:1032::/48\r\n    serviceSubnets:\r\n      - 10.64.0.0/16\r\n      - fd00:1064::/112\r\n  token: fvxdtg.fd8ohnsdo63wh88b\r\n  secretboxEncryptionSecret: R/ZSfqkzKb9rnH65AeGhCC8iH7qeM8JLXOb+TMGYFu0=\r\n  ca:\r\n    crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJpVENDQVMrZ0F3SUJBZ0lRWTlXNkFPZzc3WUpkM2RiRFVhcjZ0akFLQmdncWhrak9QUVFEQWpBVk1STXcKRVFZRFZRUUtFd3ByZFdKbGNtNWxkR1Z6TUI0WERUSTBNRGN3TVRBM05UUXpObG9YRFRNME1EWXlPVEEzTlRRegpObG93RlRFVE1CRUdBMVVFQ2hNS2EzVmlaWEp1WlhSbGN6QlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VICkEwSUFCQlRCd09xdDFnUHFlNEw0eXltTzJlRzJHVnJYNW9MQkZSSDFBY2JiUkxCOVJkczJRdWlQa0tWSWs3QmQKNVI5VTFObjRaZmxBbS9rbDBSU09ncmdvTm5tallUQmZNQTRHQTFVZER3RUIvd1FFQXdJQ2hEQWRCZ05WSFNVRQpGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFCkZnUVV2OVJhbkJhczMwdEwrM1Y5K1NYZTQwN0FOY013Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUloQU8zbzAvU0wKSGlsT0QzYnd5TmUrRVlIK0J1S2QrN0x6K2h1V2dORnh6YWVoQWlBMFRPa2F0U0tHeUoralg4OU8zUjkzcDUxYgp0Q1dRb1VxUURSNUliME1ZN0E9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==\r\n    key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSURqQzZ1c2Z2ZXBMTTlDRjZVR2poeWxHRVFBdG9NUzl3c2dIM21rVCtBSFNvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFRk1IQTZxM1dBK3A3Z3ZqTEtZN1o0YllaV3RmbWdzRVZFZlVCeHR0RXNIMUYyelpDNkkrUQpwVWlUc0YzbEgxVFUyZmhsK1VDYitTWFJGSTZDdUNnMmVRPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=\r\n  aggregatorCA:\r\n    crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJZVENDQVFhZ0F3SUJBZ0lSQUw2UnJNdmUwVUZQNHRyNlJHWXFSNXN3Q2dZSUtvWkl6ajBFQXdJd0FEQWUKRncweU5EQTNNREV3TnpVME16WmFGdzB6TkRBMk1qa3dOelUwTXpaYU1BQXdXVEFUQmdjcWhrak9QUUlCQmdncQpoa2pPUFFNQkJ3TkNBQVJqNTFPdG9JVktiMTE1cVFtM3FIaWMrbGVwaXVnaUxBZzgvMjBDOHhWbkUwWW9DZUo2Cm1vM2RyREcxdGx0Q09obUpQY2pZQndpelFjZ29PbjNLQjZWSW8yRXdYekFPQmdOVkhROEJBZjhFQkFNQ0FvUXcKSFFZRFZSMGxCQll3RkFZSUt3WUJCUVVIQXdFR0NDc0dBUVVGQndNQ01BOEdBMVVkRXdFQi93UUZNQU1CQWY4dwpIUVlEVlIwT0JCWUVGTmZuYXk3S2hiQ1NkYm84dXdoQithMlp5R2hZTUFvR0NDcUdTTTQ5QkFNQ0Ewa0FNRVlDCklRQ01pUWJ3V2l1aFVwZWNNYW9Idjk5MWcyUCt0dmdkYnVReVlxOEZJaEh5MHdJaEFPWkFrNTlnNmZ3NEsxcHAKeU43WC9qOGFLOW51RDRJd1htMnhjVGhWZFkwUwotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==\r\n    key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUxTSVdCSWY0S0ZpTERFTzRUam15d3YzV0lNZXNuelJQNlhjbXRPa2hHZUxvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFWStkVHJhQ0ZTbTlkZWFrSnQ2aDRuUHBYcVlyb0lpd0lQUDl0QXZNVlp4TkdLQW5pZXBxTgozYXd4dGJaYlFqb1ppVDNJMkFjSXMwSElLRHA5eWdlbFNBPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=\r\n  serviceAccount:\r\n    key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSURlRUZ1ODNNR3VMa1YvRE9NSTV6RkJoUG13M1lMd0ZDUHFudzU4RXhncWdvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFRk03RTRpSWxMZHNaNmxyZDIvajBmckZzOW11aUlKVkpua0hVejdST2svemxsang1TXpiQgp2Qm0ya3NPQkhiVWYrVjEvb1A0eHZIK2lWWmp1ZmFuRVBnPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=\r\n  apiServer:\r\n    image: registry.k8s.io/kube-apiserver:v1.28.5\r\n    certSANs:\r\n      - 172.16.8.192\r\n    disablePodSecurityPolicy: true\r\n    auditPolicy:\r\n      apiVersion: audit.k8s.io/v1\r\n      kind: Policy\r\n      rules:\r\n        - level: Metadata\r\n  controllerManager:\r\n    image: registry.k8s.io/kube-controller-manager:v1.28.5\r\n  proxy:\r\n    disabled: true\r\n    image: registry.k8s.io/kube-proxy:v1.27.1\r\n    mode: ipvs\r\n    extraArgs:\r\n      ipvs-strict-arp: 'true'\r\n  scheduler:\r\n    image: registry.k8s.io/kube-scheduler:v1.28.5\r\n  discovery:\r\n    enabled: true\r\n    registries:\r\n      kubernetes:\r\n        disabled: true\r\n      service: {}\r\n  etcd:\r\n    ca:\r\n      crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJmRENDQVNPZ0F3SUJBZ0lRWnFJS3hzdCtJOVFxRHA4YjVjZXBUekFLQmdncWhrak9QUVFEQWpBUE1RMHcKQ3dZRFZRUUtFd1JsZEdOa01CNFhEVEkwTURjd01UQTNOVFF6TmxvWERUTTBNRFl5T1RBM05UUXpObG93RHpFTgpNQXNHQTFVRUNoTUVaWFJqWkRCWk1CTUdCeXFHU000OUFnRUdDQ3FHU000OUF3RUhBMElBQkZlOEFLUmpwYmtNCmZuTHJqT2NJQmRmakRqaWZwb2NmVlJGRlZ1dW1QTjIxTzNZM0NXcVdXMHBkcVBUSk9FMWI2YTFwZWtUdncwWEsKMGU1RFJUMzE0RXVqWVRCZk1BNEdBMVVkRHdFQi93UUVBd0lDaERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjRApBUVlJS3dZQkJRVUhBd0l3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFkQmdOVkhRNEVGZ1FVUEtMbnBBcGpyTkNhCkNPanJ6V3JrVFdQbHBTWXdDZ1lJS29aSXpqMEVBd0lEUndBd1JBSWdkWUQ5RDUwUU84Y1pXSy9kdXlwSzhPZlcKWHAyaTAzc3Z6SGZpNmNEYko1SUNJQlBpeTVPdDM5citzaXEwUkVVVzZxUzRJQnhqemFrdUcxNmxoVEZIM0lBbQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==\r\n      key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUd3Zkh2T2lQbHpLbVFsMkttR2NTaXpPTHhDUGRRK0N5UmtqcHhsQ2pSQjFvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFVjd3QXBHT2x1UXgrY3V1TTV3Z0YxK01PT0orbWh4OVZFVVZXNjZZODNiVTdkamNKYXBaYgpTbDJvOU1rNFRWdnByV2w2Uk8vRFJjclI3a05GUGZYZ1N3PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=\r\n  extraManifests:\r\n    - http://172.16.106.11:8088/mingyang/cncp/cni-installation-ds.yaml\r\n    - http://172.16.106.11:8088/mingyang/cncp/multus-with-patch.yaml\r\n    - http://172.16.106.11:8088/mingyang/cncp/openebs.yaml\r\n    - http://172.16.106.11:8088/mingyang/cncp/openebs-sc.yaml\r\n    - http://172.16.106.11:8088/mingyang/cncp/dashboard-deploy.yaml\r\n    - http://172.16.106.11:8088/mingyang/cncp/metallb-native.yaml\r\n    - http://172.16.106.11:8088/mingyang/cncp/reloader.yaml\r\n    - http://172.16.106.11:8088/mingyang/cncp/cncp-namespaces.yaml\r\n    - http://172.16.106.11:8088/mingyang/cncp/nfs-server-deploy.yaml\r\n  inlineManifests:\r\n    - name: cluster-config-cm\r\n      contents: |-\r\n        kind: ConfigMap\r\n        apiVersion: v1\r\n        metadata:\r\n          name: cluster-config\r\n          namespace: kube-system\r\n        data:\r\n          KUBERNETES_API_SERVER_ADDRESS: '172.16.8.192'\r\n          KUBERNETES_API_SERVER_PORT: '6443'\r\n  adminKubeconfig:\r\n    certLifetime: 87600h0m0s\r\n  allowSchedulingOnControlPlanes: true\r\n\u3002", "top": 0, "createdAt": 1720666846, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-11", "dateLabelColor": "#bc4c00"}, "P41": {"htmlDir": "docs/post/docker-jing-xiang-shang-chuan-duan-kou-pei-zhi.html", "labels": ["\u95ee\u9898\u89e3\u51b3\u65b9\u6848"], "postTitle": "docker\u955c\u50cf\u4e0a\u4f20\u7aef\u53e3\u914d\u7f6e", "postUrl": "post/docker-jing-xiang-shang-chuan-duan-kou-pei-zhi.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/41", "commentNum": 0, "wordCount": 971, "description": "```shell\r\ndocker load -i registry.tar.gz\r\ndocker ps -a\r\ndocker run -d -p 5000:5000 --name registry regisrty:2\r\ndocker run -d -p 5000:5000 --name registry registry:2\r\ndocker load -i etcd.tar.gz\r\ndocker tag gcr.io/etcd-development/etcd:v3.5.10 172.16.8.102:5000/gcr.io/etcd-development/etcd:v3.5.10\r\ndocker push 172.16.8.102:5000/gcr.io/etcd-development/etcd:v3.5.10\r\nvim /etc/docker/daemon.json\r\nservice docker restart\r\ndocker push 172.16.8.102:5000/gcr.io/etcd-development/etcd:v3.5.10\r\ndocker start\r\ndocker start registry.tar.gz\r\ndocker start registry\r\ndocker push 172.16.8.102:5000/gcr.io/etcd-development/etcd:v3.5.10\r\ntalosctl edit mc\r\ntalosctl image pull gcr.io/etcd-development/etcd:v3.5.10\r\ntalosctl reboot\r\ntalosctl dashboard\r\nping 172.16.8.30\r\ntalosctl service\r\ntalosctl kubeconfig\r\nkubectl get nodes -o wide\r\n\r\n\r\ndocker\u914d\u7f6e\r\n\r\n{\r\n    'data-root': '/home/chen/docker_data',\r\n    'insecure-registries': ['172.16.8.102:5000']\r\n}\r\n\r\nhttp://172.16.8.102:5000/v2/gcr.io\u3002", "top": 0, "createdAt": 1720686573, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-11", "dateLabelColor": "#bc4c00"}, "P42": {"htmlDir": "docs/post/helm-shi-yong-fang-fa.html", "labels": ["helm"], "postTitle": "helm\u4f7f\u7528\u65b9\u6cd5", "postUrl": "post/helm-shi-yong-fang-fa.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/42", "commentNum": 0, "wordCount": 1999, "description": "```yaml\r\nhelm repo add harbor https://helm.goharbor.io\r\nhelm repo update\r\nhelm fetch harbor/harbor\r\ntar -zxvf harbor-*.tgz\r\ncd harbor\r\n\r\n\u5f02\u5e38\u89e3\u51b3\uff1a\r\nhelm uninstall harbor --namespace harbor\r\n\r\n\r\nhelm install --create-namespace --namespace harbor harbor ./ \\\r\n--set expose.type=clusterIP \\\r\n--set expose.tls.auto.commonName=172.16.102.146 \\\r\n--set externalURL=https://172.16.102.146 \\\r\n--set trivy.enabled=false \\\r\n--set metrics.enabled=true \\\r\n--set persistence.persistentVolumeClaim.registry.storageClass=openebs-sc \\\r\n--set persistence.persistentVolumeClaim.jobservice.jobLog.storageClass=openebs-sc \\\r\n--set persistence.persistentVolumeClaim.database.storageClass=openebs-sc \\\r\n--set persistence.persistentVolumeClaim.redis.storageClass=openebs-sc \\\r\n--set persistence.persistentVolumeClaim.trivy.storageClass=openebs-sc \\\r\n--set 'nginx.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n--set 'portal.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n--set 'core.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n--set 'jobservice.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n--set 'registry.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n--set 'trivy.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n--set 'database.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n--set 'redis.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n--set 'exporter.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n--set harbor-core.image.repository=myharborregistry/harbor-core \\\r\n--set harbor-core.image.tag=v2.3.0\r\n```\r\n\r\n```shell\r\ncat <<EOF | kubectl apply -f -\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: harbor-loadbalancer\r\n  namespace: harbor\r\nspec:\r\n  selector:\r\n    app: harbor\r\n    component: nginx\r\n  ipFamilies:\r\n  - IPv4\r\n  ipFamilyPolicy: SingleStack\r\n  ports:\r\n  - name: http\r\n    port: 80\r\n    targetPort: 8080\r\n  - name: https\r\n    port: 443\r\n    targetPort: 8443\r\n  type: LoadBalancer\r\n  loadBalancerIP: 172.16.102.79\r\n  allocateLoadBalancerNodePorts: false\r\nEOF\r\n```\u3002", "top": 0, "createdAt": 1720768859, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-12", "dateLabelColor": "#bc4c00"}, "P43": {"htmlDir": "docs/post/k8s-an-zhuang.html", "labels": ["K8S"], "postTitle": "k8s\u5b89\u88c5", "postUrl": "post/k8s-an-zhuang.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/43", "commentNum": 0, "wordCount": 3237, "description": "```shell\r\n#\u4fee\u6539hosts\r\ncat >>/etc/hosts<<EOF\r\n10.42.13.201 cncp-ms-01\r\n10.42.13.202 cncp-ms-02\r\n10.42.13.203 cncp-ms-03\r\nEOF\r\n\r\nhostnamectl  set-hostname cncp-ms-01\r\n#\u5173\u95ed\u9632\u706b\u5899\r\nsystemctl disable firewalld && systemctl stop firewalld\r\n\r\n#\u5173\u95edselinux\r\n\u4fee\u6539\u6587\u4ef6/etc/selinux/config\uff1aSELINUX=disabled\u3002", "top": 0, "createdAt": 1721098107, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-16", "dateLabelColor": "#bc4c00"}, "P44": {"htmlDir": "docs/post/metallb-wen-ti-jie-jue.html", "labels": ["K8S"], "postTitle": "metallb\u95ee\u9898\u89e3\u51b3", "postUrl": "post/metallb-wen-ti-jie-jue.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/44", "commentNum": 0, "wordCount": 1021, "description": "\u6dfb\u52a0 Metallb \u4ed3\u5e93\uff1a\r\n\r\nsh\r\nhelm repo add metallb https://metallb.github.io/metallb\r\n\u66f4\u65b0 Helm \u4ed3\u5e93\uff1a\r\n\r\nsh\r\nhelm repo update\r\n\u5b89\u88c5 Metallb\uff1a\r\n\r\nsh\r\nhelm install metallb metallb/metallb\r\n\r\n\u786e\u4fdd CRD \u5df2\u5b89\u88c5\uff1a\r\n\r\nMetallb \u4f9d\u8d56\u7684 IPAddressPool \u548c L2Advertisement CRD \u9700\u8981\u5148\u88ab\u5b89\u88c5\u3002", "top": 0, "createdAt": 1721264368, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-18", "dateLabelColor": "#bc4c00"}, "P45": {"htmlDir": "docs/post/K8S-ji-qiao.html", "labels": ["K8S"], "postTitle": "K8S\u6280\u5de7", "postUrl": "post/K8S-ji-qiao.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/45", "commentNum": 0, "wordCount": 78, "description": "\u8865\u5168\r\nkubectl completion bash > /usr/share/bash-completion/completions/kubectl\r\n\u3002", "top": 0, "createdAt": 1721271786, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-18", "dateLabelColor": "#bc4c00"}, "P46": {"htmlDir": "docs/post/PRC-wang-kou-ding-yi.html", "labels": ["\u7cfb\u7edf\u67b6\u6784"], "postTitle": "PRC\u7f51\u53e3\u5b9a\u4e49", "postUrl": "post/PRC-wang-kou-ding-yi.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/46", "commentNum": 0, "wordCount": 3698, "description": "## \u660e\u9633\u8bbe\u5907\u7aef\u53e3\u6d4b\u5e8f\r\n### 1. MYCNP-SV-P1 (\u84dd\u8272/1U/Intel \u5e73\u53f0)\r\n\r\n| \u63a5\u53e3\u4f4d\u7f6e | \u63a5\u53e3\u540d\u79f0 | \u63a5\u53e3\u5f62\u6001 | \u7f51\u5361 busPath   | \u7f51\u5361\u7cfb\u7edf\u540d\u79f0  | \u7f51\u5361\u578b\u53f7                            |\r\n| ---- | ---- | ---- | ------------ | ------- | ------------------------------- |\r\n| \u677f\u8f7d   | ens1 | 1G\u7535  | 0000:05:00.0 | enp5s0  | I211 Gigabit Network Connection |\r\n| \u677f\u8f7d   | ens2 | 1G\u7535  | 0000:06:00.0 | enp6s0  | I211 Gigabit Network Connection |\r\n| \u677f\u8f7d   | ens3 | 1G\u7535  | 0000:07:00.0 | enp7s0  | I211 Gigabit Network Connection |\r\n| \u677f\u8f7d   | ens4 | 1G\u7535  | 0000:08:00.0 | enp8s0  | I211 Gigabit Network Connection |\r\n| \u677f\u8f7d   | ens5 | 1G\u7535  | 0000:0b:00.0 | enp11s0 | I211 Gigabit Network Connection |\r\n| \u677f\u8f7d   | ens6 | 1G\u7535  | 0000:0c:00.0 | enp12s0 | I211 Gigabit Network Connection |\r\n| \u677f\u8f7d   | ens7 | 1G\u7535  | 0000:12:00.0 | enp18s0 | I211 Gigabit Network Connection |\r\n| \u677f\u8f7d   | ens8 | 1G\u7535  | 0000:13:00.0 | enp19s0 | I211 Gigabit Network Connection |\r\n### 2. MYCNP-SV-P2 (\u84dd\u8272/1U/Intel \u5e73\u53f0)\r\n\r\n| \u63a5\u53e3\u4f4d\u7f6e | \u63a5\u53e3\u540d\u79f0 | \u63a5\u53e3\u5f62\u6001 | \u7f51\u5361 busPath   | \u7f51\u5361\u7cfb\u7edf\u540d\u79f0    | \u7f51\u5361\u578b\u53f7                                  |\r\n| ---- | ---- | ---- | ------------ | --------- | ------------------------------------- |\r\n| \u677f\u8f7d   | ens1 | 1G\u7535  | 0000:05:00.0 | enp5s0    | I211 Gigabit Network Connection       |\r\n| \u677f\u8f7d   | ens2 | 1G\u7535  | 0000:06:00.0 | enp6s0    | I211 Gigabit Network Connection       |\r\n| \u677f\u8f7d   | ens3 | 1G\u7535  | 0000:07:00.0 | enp7s0    | I211 Gigabit Network Connection       |\r\n| \u677f\u8f7d   | ens4 | 1G\u7535  | 0000:08:00.0 | enp8s0    | I211 Gigabit Network Connection       |\r\n| \u677f\u8f7d   | ens5 | 1G\u7535  | 0000:0b:00.0 | enp11s0   | I211 Gigabit Network Connection       |\r\n| \u677f\u8f7d   | ens6 | 1G\u7535  | 0000:0c:00.0 | enp12s0   | I211 Gigabit Network Connection       |\r\n| \u677f\u8f7d   | ens7 | 1G\u7535  | 0000:12:00.0 | enp18s0   | I211 Gigabit Network Connection       |\r\n| \u677f\u8f7d   | ens8 | 1G\u7535  | 0000:13:00.0 | enp19s0   | I211 Gigabit Network Connection       |\r\n| \u677f\u5361A  | GE1  | 1G\u5149  | 0000:19:00.0 | enp25s0f0 | I350 Gigabit Fiber Network Connection |\r\n| \u677f\u5361A  | GE2  | 1G\u5149  | 0000:19:00.1 | enp25s0f1 | I350 Gigabit Fiber Network Connection |\r\n| \u677f\u5361A  | GE3  | 1G\u5149  | 0000:19:00.2 | enp25s0f2 | I350 Gigabit Fiber Network Connection |\r\n| \u677f\u5361A  | GE4  | 1G\u5149  | 0000:19:00.3 | enp25s0f3 | I350 Gigabit Fiber Network Connection |\r\n### 3. MYCNP-SV-P2C (\u7ea2\u8272/2U/\u6d77\u5149\u5e73\u53f0)\r\n\r\n| \u63a5\u53e3\u4f4d\u7f6e | \u63a5\u53e3\u540d\u79f0   | \u63a5\u53e3\u5f62\u6001 | \u7f51\u5361 busPath   | \u7f51\u5361\u7cfb\u7edf\u540d\u79f0    | \u7f51\u5361\u578b\u53f7                                       |\r\n| ---- | ------ | ---- | ------------ | --------- | ------------------------------------------ |\r\n| \u677f\u8f7d   | ETH0   | 1G\u7535  | 0000:05:00.0 | eno1      | WX1860A2 Gigabit Ethernet Controller       |\r\n| \u677f\u8f7d   | ETH1   | 1G\u7535  | 0000:05:00.1 | eno2      | WX1860A2 Gigabit Ethernet Controller       |\r\n| \u677f\u8f7d   | ETH2   | 1G\u7535  | 0000:08:00.0 | eno3      | WX1860A4 Gigabit Ethernet Controller       |\r\n| \u677f\u8f7d   | ETH3   | 1G\u7535  | 0000:08:00.1 | eno4      | WX1860A4 Gigabit Ethernet Controller       |\r\n| \u677f\u8f7d   | ETH4   | 1G\u7535  | 0000:08:00.2 | eno5      | WX1860A4 Gigabit Ethernet Controller       |\r\n| \u677f\u8f7d   | ETH5   | 1G\u7535  | 0000:08:00.3 | eno6      | WX1860A4 Gigabit Ethernet Controller       |\r\n| \u677f\u8f7d   | SFP1   | 1G\u5149  | 0000:0b:00.0 | eno7      | WX1860A4 Gigabit Ethernet Controller       |\r\n| \u677f\u8f7d   | SFP2   | 1G\u5149  | 0000:0b:00.1 | eno8      | WX1860A4 Gigabit Ethernet Controller       |\r\n| \u677f\u8f7d   | SFP3   | 1G\u5149  | 0000:0b:00.2 | eno9      | WX1860A4 Gigabit Ethernet Controller       |\r\n| \u677f\u8f7d   | SFP4   | 1G\u5149  | 0000:0b:00.3 | eno10     | WX1860A4 Gigabit Ethernet Controller       |\r\n| \u677f\u5361A  | GSFP+1 | 10G\u5149 | 0000:0e:00.0 | enp14s0f0 | Ethernet Controller SP1000A for 10GbE SFP+ |\r\n| \u677f\u5361A  | GSFP+2 | 10G\u5149 | 0000:0e:00.1 | enp14s0f1 | Ethernet Controller SP1000A for 10GbE SFP+ |\r\n> \u5907\u6ce8:\r\n> 1. GSFP+1\u3001GSFP+2 10G\u5149\u7f51\u5361\uff0c\u5de6\u4fa7\u4e3aACT\u6307\u793a\u706f\uff0c\u53f3\u4fa7\u4e3aSpeed\u6307\u793a\u706f\uff1bSpeed\u6307\u793a\u706f\u4eae\u7eff\u8272=\u901f\u5ea61Gbps\u3001Speed\u6307\u793a\u706f\u4eae\u6a59\u8272=\u901f\u5ea610Gbps\u3002", "top": 0, "createdAt": 1721272528, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-18", "dateLabelColor": "#bc4c00"}, "P47": {"htmlDir": "docs/post/harbor_k8s.sh.html", "labels": ["shell", "helm"], "postTitle": "harbor_k8s.sh", "postUrl": "post/harbor_k8s.sh.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/47", "commentNum": 0, "wordCount": 2722, "description": "```shell\r\n#harbor\u81ea\u52a8\u5316heml\u90e8\u7f72\r\n#!/bin/bash\r\n\r\n# \u5b9a\u4e49\u9519\u8bef\u5904\u7406\u51fd\u6570\r\nhandle_error() {\r\n  echo '\u53d1\u751f\u9519\u8bef: $1'\r\n  exit 1\r\n}\r\n\r\n# \u68c0\u67e5\u5916\u90e8URL\u53c2\u6570\r\nif [ -z '$1' ]; then\r\n  echo '\u8bf7\u63d0\u4f9b\u5916\u90e8URL\u4f5c\u4e3a\u53c2\u6570\uff0c\u4f8b\u5982:sh test.sh https://172.16.102.146 \u8bf7\u63d0\u4f9b loadBalancerIP \u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u4f8b\u5982: 172.16.102.79' \r\n  kubectl get IPAddressPool -A\r\n  exit 1\r\nfi\r\n\r\nEXTERNAL_URL='$1'\r\n\r\n# \u68c0\u67e5 loadBalancerIP \u53c2\u6570\r\nif [ -z '$2' ]; then\r\n  echo '\u8bf7\u63d0\u4f9b loadBalancerIP \u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u4f8b\u5982: 172.16.102.79'\r\n  exit 1\r\nfi\r\n\r\nLOAD_BALANCER_IP='$2'\r\n\r\n# \u68c0\u67e5\u662f\u5426\u5df2\u6709Harbor\u5b89\u88c5\r\necho '\u68c0\u67e5\u662f\u5426\u6709\u5df2\u5b58\u5728\u7684Harbor\u5b89\u88c5...'\r\nif helm ls --namespace harbor | grep -q harbor; then\r\n  echo '\u6b63\u5728\u5378\u8f7d\u73b0\u6709\u7684Harbor\u5b89\u88c5...'\r\n  if ! helm uninstall harbor --namespace harbor; then\r\n    handle_error '\u5378\u8f7d\u73b0\u6709Harbor\u5b89\u88c5\u5931\u8d25'\r\n  fi\r\nfi\r\n\r\n# \u5b89\u88c5Harbor\r\necho '\u6b63\u5728\u5b89\u88c5Harbor...'\r\nif ! helm install \\\r\n    --create-namespace \\\r\n    --namespace harbor \\\r\n    harbor ./ \\\r\n    --set expose.type=clusterIP \\\r\n    --set expose.tls.auto.commonName=$(echo $EXTERNAL_URL | awk -F'://' '{print $NF}') \\\r\n    --set externalURL=$EXTERNAL_URL \\\r\n    --set trivy.enabled=false \\\r\n    --set metrics.enabled=true \\\r\n    --set persistence.persistentVolumeClaim.registry.storageClass=openebs-sc \\\r\n    --set persistence.persistentVolumeClaim.jobservice.jobLog.storageClass=openebs-sc \\\r\n    --set persistence.persistentVolumeClaim.database.storageClass=openebs-sc \\\r\n    --set persistence.persistentVolumeClaim.redis.storageClass=openebs-sc \\\r\n    --set persistence.persistentVolumeClaim.trivy.storageClass=openebs-sc \\\r\n    --set 'nginx.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n    --set 'portal.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n    --set 'core.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n    --set 'jobservice.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n    --set 'registry.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n    --set 'trivy.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n    --set 'database.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n    --set 'redis.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n    --set 'exporter.nodeSelector.kubernetes\\.io/hostname=cncp-ms-01' \\\r\n    --set harbor-core.image.repository=myharborregistry/harbor-core \\\r\n    --set harbor-core.image.tag=v2.3.0; then\r\n  handle_error '\u5b89\u88c5Harbor\u5931\u8d25'\r\nfi\r\n\r\necho 'Harbor\u5b89\u88c5\u5b8c\u6210!'\r\n\r\ncat <<EOF | kubectl apply -f -\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: harbor-loadbalancer\r\n  namespace: harbor\r\nspec:\r\n  selector:\r\n    app: harbor\r\n    component: nginx\r\n  ipFamilies:\r\n  - IPv4\r\n  ipFamilyPolicy: SingleStack\r\n  ports:\r\n  - name: http\r\n    port: 80\r\n    targetPort: 8080\r\n  - name: https\r\n    port: 443\r\n    targetPort: 8443\r\n  type: LoadBalancer\r\n  loadBalancerIP: ${LOAD_BALANCER_IP}\r\n  allocateLoadBalancerNodePorts: false\r\nEOF\r\n```\u3002", "top": 0, "createdAt": 1721699353, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-23", "dateLabelColor": "#bc4c00"}, "P48": {"htmlDir": "docs/post/harbor_init.py.html", "labels": ["python"], "postTitle": "harbor_init.py", "postUrl": "post/harbor_init.py.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/48", "commentNum": 0, "wordCount": 8387, "description": "```python\r\nimport time\r\nimport unittest\r\nfrom config import BASE_URL\r\nfrom selenium.webdriver.support.ui import Select\r\nfrom selenium.webdriver.common.by import By\r\nfrom selenium.webdriver.support.ui import WebDriverWait\r\nfrom selenium.webdriver.support import expected_conditions as EC\r\nfrom selenium import webdriver\r\nfrom selenium.webdriver.chrome.service import Service\r\nfrom selenium.webdriver.common.by import By\r\nfrom selenium.webdriver.support.ui import WebDriverWait\r\nfrom selenium.webdriver.support import expected_conditions as EC\r\n\r\nclass HarborTest(unittest.TestCase):\r\n    @classmethod\r\n    def setUpClass(cls):\r\n        service = Service('C:\\\\chromedriver.exe')  # \u66ff\u6362\u4e3a\u4f60\u7684chromedriver\u8def\u5f84\r\n        options = webdriver.ChromeOptions()\r\n        options.add_argument('--ignore-certificate-errors')\r\n        cls.driver = webdriver.Chrome(service=service, options=options)\r\n        cls.driver.maximize_window()\r\n\r\n    @classmethod\r\n    def tearDownClass(cls):\r\n        cls.driver.quit()\r\n\r\n    def test_harbor_operations(self):\r\n        driver = self.driver\r\n\r\n        # \u8bbf\u95ee\u5e76\u5904\u7406\u8bc1\u4e66\u8b66\u544a\r\n        driver.get(BASE_URL)\r\n        # advanced_button = WebDriverWait(driver, 10).until(\r\n        #     EC.element_to_be_clickable((By.XPATH, '//*[@id='advancedButton']'))\r\n        # )\r\n        # advanced_button.click()\r\n        # proceed_button = WebDriverWait(driver, 10).until(\r\n        #     EC.element_to_be_clickable((By.XPATH, '//*[@id='exceptionDialogButton']'))\r\n        # )\r\n        # proceed_button.click()\r\n\r\n        '''\r\n        \u767b\u5f55\r\n        '''\r\n        username_field = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='login_username']'))\r\n        )\r\n        username_field.send_keys('admin')\r\n        password_field = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='login_password']'))\r\n        )\r\n        password_field.send_keys('Harbor12345')\r\n        login_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.ID, 'log_in'))\r\n        )\r\n        login_button.click()\r\n        time.sleep(5)  # \u7b49\u5f85\u767b\u5f55\u5b8c\u6210\r\n\r\n        '''\r\n        \u4ed3\u5e93\u7ba1\u7406\r\n        '''\r\n        repository_management_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '/html/body/harbor-app/harbor-shell/clr-main-container/div/clr-vertical-nav/div/div[1]/clr-vertical-nav-group/div[2]/clr-vertical-nav-group-children/a[3]/span'))\r\n        )\r\n        repository_management_button.click()\r\n        new_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='add']'))\r\n        )\r\n        new_button.click()\r\n        destination_name_field = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='destination_name']'))\r\n        )\r\n        destination_name_field.send_keys('test')\r\n        destination_url_field = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='destination_url']'))\r\n        )\r\n        destination_url_field.send_keys('https://172.16.8.201')\r\n\r\n        usr_exit = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='destination_access_key']'))\r\n        )\r\n        usr_exit.send_keys('admin')\r\n\r\n        destination_pass_field = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='destination_password']'))\r\n        )\r\n        destination_pass_field.send_keys('Harbor12345')\r\n\r\n        uncheck_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '/html/body/harbor-app/harbor-shell/clr-main-container/div/div/hbr-endpoint/div/hbr-create-edit-endpoint/clr-modal/div/div[2]/div[2]/div/div[2]/div/form/clr-checkbox-container/div/clr-checkbox-wrapper/label'))\r\n        )\r\n        uncheck_button.click()\r\n        submit_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '/html/body/harbor-app/harbor-shell/clr-main-container/div/div/hbr-endpoint/div/hbr-create-edit-endpoint/clr-modal/div/div[2]/div[2]/div/div[3]/button[3]/span'))\r\n        )\r\n        submit_button.click()\r\n\r\n        # \u590d\u5236\u7ba1\u7406\u529f\u80fd\r\n        new_replication_rule_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '/html/body/harbor-app/harbor-shell/clr-main-container/div/clr-vertical-nav/div/div[1]/clr-vertical-nav-group/div[2]/clr-vertical-nav-group-children/a[4]/span'))\r\n        )\r\n        new_replication_rule_button.click()\r\n\r\n        new_replication_exit_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='new_replication_rule_id']'))\r\n        )\r\n        new_replication_exit_button.click()\r\n\r\n        init_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '/html/body/harbor-app/harbor-shell/clr-main-container/div/div/total-replication/div/hbr-replication/div/hbr-create-edit-rule/clr-modal/div/div[2]/div[2]/div/div[2]/div/form/clr-radio-container/div/clr-radio-wrapper[2]/label'))\r\n        )\r\n        init_button.click()\r\n\r\n        rule_name_field = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='ruleName']'))\r\n        )\r\n        rule_name_field.send_keys('test')\r\n        # target_repo_dropdown = WebDriverWait(driver, 10).until(\r\n        #     EC.element_to_be_clickable((By.XPATH, '/html/body/harbor-app/harbor-shell/clr-main-container/div/div/total-replication/div/hbr-replication/div/hbr-create-edit-rule/clr-modal/div/div[2]/div[2]/div/div[2]/div/form/div[3]/div/div[2]'))\r\n        # )\r\n        # target_repo_dropdown.click()\r\n        '''\r\n        \u4e0b\u62c91\r\n        '''\r\n\r\n        try:\r\n            # \u7b49\u5f85\u5e76\u5b9a\u4f4d<select>\u5143\u7d20\r\n            select_element = WebDriverWait(driver, 20).until(\r\n                EC.presence_of_element_located((By.ID, 'src_registry_id'))\r\n            )\r\n            # \u521b\u5efaSelect\u5bf9\u8c61\r\n            select = Select(select_element)\r\n            print('\u627e\u5230\u4e86\u4e0b\u62c9\u5217\u8868')\r\n\r\n        except Exception as e:\r\n            print(f'\u65e0\u6cd5\u627e\u5230\u4e0b\u62c9\u5217\u8868: {e}')\r\n\r\n        try:\r\n            # \u9009\u62e9\u4e0b\u62c9\u5217\u8868\u4e2d\u7684\u7b2c\u4e00\u4e2a\u975e\u7a7a\u9009\u9879\r\n            # \u6ce8\u610f\uff1a\u8fd9\u91cc\u7684index\u662f\u4ece0\u5f00\u59cb\u7684\uff0c\u56e0\u6b64\u7b2c\u4e00\u4e2a\u975e\u7a7a\u9009\u9879\u7684\u7d22\u5f15\u662f1\uff08\u5047\u8bbe\u7b2c\u4e00\u4e2a\u9009\u9879\u662f\u5360\u4f4d\u7b26\uff09\r\n            select.select_by_index(1)\r\n            print('\u9009\u62e9\u4e86\u4e0b\u62c9\u5217\u8868\u7684\u7b2c\u4e00\u4e2a\u975e\u7a7a\u9009\u9879')\r\n\r\n        except Exception as e:\r\n            print(f'\u65e0\u6cd5\u9009\u62e9\u4e0b\u62c9\u5217\u8868\u7684\u7b2c\u4e00\u4e2a\u975e\u7a7a\u9009\u9879: {e}')\r\n\r\n        '''\r\n        \u5904\u74062\u4e0b\u62c9\r\n        '''\r\n        try:\r\n            # \u70b9\u51fb\u4e0b\u62c9\u5217\u8868\u4ee5\u5c55\u5f00\r\n            dropdown_tow = WebDriverWait(driver, 20).until(\r\n                EC.element_to_be_clickable((By.ID, 'dest_namespace_replace_count'))\r\n            )\r\n            dropdown_tow.click()\r\n            print('\u70b9\u51fb\u4e86\u4e0b\u62c9\u5217\u8868')\r\n            # \u7b49\u5f85\u5e76\u9009\u62e9\u201c\u65e0\u66ff\u6362\u201d\u9009\u9879\r\n            # \u9009\u62e9\u7684 XPATH \u5fc5\u987b\u5339\u914d\u5c55\u5f00\u540e\u7684\u9009\u9879\r\n            no_replace_option = WebDriverWait(driver,10).until(\r\n                EC.element_to_be_clickable(\r\n                    (By.XPATH, '//select[@id='dest_namespace_replace_count']/option[@value='0']'))\r\n            )\r\n            no_replace_option.click()\r\n            print('\u9009\u62e9\u4e86\u2018\u65e0\u66ff\u6362\u2019\u9009\u9879')\r\n\r\n        except Exception as e:\r\n            print(f'\u65e0\u6cd5\u5904\u7406\u4e0b\u62c9\u5217\u8868: {e}')\r\n\r\n        '''\r\n        \u4fdd\u5b58\r\n        '''\r\n        time.sleep(5)\r\n        save_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='ruleBtnOk']'))\r\n        )\r\n        save_button.click()\r\n        # \u63d0\u4ea4\u590d\u5236\u529f\u80fd\r\n        replication_checkbox = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '/html/body/harbor-app/harbor-shell/clr-main-container/div/div/total-replication/div/hbr-replication/div/div[2]/hbr-list-replication-rule/div/clr-datagrid/div[1]/div/div/div/div/clr-dg-row/div/div[1]/div/clr-radio-wrapper/label'))\r\n        )\r\n        replication_checkbox.click()\r\n        replicate_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '//*[@id='replication_exe_id']'))\r\n        )\r\n        replicate_button.click()\r\n        confirm_replicate_button = WebDriverWait(driver, 10).until(\r\n            EC.element_to_be_clickable((By.XPATH, '/html/body/harbor-app/harbor-shell/clr-main-container/div/div/total-replication/div/hbr-replication/div/confirmation-dialog[1]/clr-modal/div/div[2]/div[2]/div/div[3]/button[2]'))\r\n        )\r\n        confirm_replicate_button.click()\r\n\r\nif __name__ == '__main__':\r\n    unittest.main()\r\n\u3002", "top": 0, "createdAt": 1721874758, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-25", "dateLabelColor": "#bc4c00"}, "P49": {"htmlDir": "docs/post/Talos Linux -xiu-gai-IP-ce-shi.html", "labels": ["\u7cfb\u7edf\u67b6\u6784"], "postTitle": "Talos Linux \u4fee\u6539IP\u6d4b\u8bd5", "postUrl": "post/Talos%20Linux%20-xiu-gai-IP-ce-shi.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/49", "commentNum": 0, "wordCount": 19801, "description": "Talos Linux \u4fee\u6539IP\u6d4b\u8bd5 \u4e00\u3001\u6d4b\u8bd5\u73af\u5883\r\n\u8bbe\u5907\u578b\u53f7 \u8bbe\u5907IPv4\u5730\u5740 \u8bbe\u5907IPv6\u5730\u5740 MYCNP-SV-P2C 172.16.223.101/24 2408:8631:c02:ffe3::a101/64 MYCNP-SV-P2C 172.16.223.102/24 2408:8631:c02:ffe3::a102/64 MYCNP-SV-P2C 172.16.223.103/24 2408:8631:c02:ffe3::a103/64\r\n\u4e8c\u3001\u4fee\u6539\u6d41\u7a0b 1. \u4fee\u6539\u524d\u51c6\u5907\u5de5\u4f5c\r\n(1) \u68c0\u67e5\u96c6\u7fa4\u8fd0\u884c\u72b6\u6001\uff1a\r\n$ kubectl get nodes -o wide\r\nNAME         STATUS   ROLES           AGE    VERSION   INTERNAL-IP EXTERNAL-IP   OS-IMAGE                KERNEL-VERSION   CONTAINER-RUNTIME cncp-ms-01   Ready    control-plane   19m    v1.28.5   172.16.223.101   <none> Talos (v1.5.5-mycos2) 6.1.45-talos     containerd://1.6.23 cncp-ms-02   Ready    control-plane   11m    v1.28.5   172.16.223.102   <none> Talos (v1.5.5-mycos2) 6.1.45-talos     containerd://1.6.23 cncp-ms-03   Ready    control-plane   4m5s   v1.28.5   172.16.223.103   <none> Talos (v1.5.5-mycos2) 6.1.45-talos     containerd://1.6.23\r\n$ talosctl etcd status\r\nNODE             MEMBER             DB SIZE   IN USE            LEADER RAFT INDEX   RAFT TERM   RAFT APPLIED INDEX   LEARNER   ERRORS 172.16.223.101   09b46a3d5cc2c53a   6.6 MB    3.4 MB (51.96%) 09b46a3d5cc2c53a   5137 3 5137 false 172.16.223.103   dfc9e2c28fb4d3f1   6.3 MB    3.4 MB (54.55%) 09b46a3d5cc2c53a   5137 3 5137 false 172.16.223.102   da76ae5474605fb9   6.5 MB    3.4 MB (52.63%) 09b46a3d5cc2c53a   5137 3 5137 false\r\n2. \u96c6\u7fa4\u505c\u673a\u8fdb\u5165\u7ef4\u62a4\u6a21\u5f0f\r\n\u5982\u679c\u96c6\u7fa4\u4e0a\u6709Pod\u56e0\u4e3aPodDisruptionBudgets\u5bfc\u81f4\u65e0\u6cd5\u88abCordon\uff08\u5982CNCP\u5e73\u53f0\u4e2d\u7684 OpenSearch\u96c6\u7fa4\uff09\uff0c\u53ef\u4ee5\u52a0\u4e0a --disable-eviction \u8d8a\u8fc7\u9650\u5236\u5f3a\u5236\u505c\u673a\uff0c\u4f46\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6570\u636e\uff1b\r\n\u6b63\u5e38\u60c5\u51b5\u4e0b\u4f7f\u7528 --ignore-daemonsets --delete-emptydir-data \u5373\u53ef\u3002", "top": 0, "createdAt": 1722212585, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-29", "dateLabelColor": "#bc4c00"}, "P50": {"htmlDir": "docs/post/nslookup_telnet.py.html", "labels": ["python"], "postTitle": "nslookup_telnet.py", "postUrl": "post/nslookup_telnet.py.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/50", "commentNum": 0, "wordCount": 2226, "description": "```python\r\nimport openpyxl\r\nimport dns.resolver\r\nimport telnetlib\r\nimport logging\r\n\r\n# \u65e5\u5fd7\u914d\u7f6e\r\nlogging.basicConfig(filename='dns_telnet.log', level=logging.INFO)\r\n\r\ndef resolve_dns(domain, nameserver='114.114.114.114'):\r\n    resolver = dns.resolver.Resolver(configure=False)\r\n    resolver.nameservers = [nameserver]\r\n\r\n    try:\r\n        a_records = resolver.resolve(domain, 'A')\r\n        aaaa_records = resolver.resolve(domain, 'AAAA')\r\n\r\n        print(f'\u6b63\u5728\u89e3\u6790 {domain} \u7684DNS\u8bb0\u5f55...')\r\n        print(f'A \u8bb0\u5f55: {[str(rdata) for rdata in a_records]}')\r\n        print(f'AAAA \u8bb0\u5f55: {[str(rdata) for rdata in aaaa_records]}')\r\n\r\n        return {'A': [str(rdata) for rdata in a_records],\r\n                'AAAA': [str(rdata) for rdata in aaaa_records]}\r\n    except Exception as e:\r\n        logging.error(f'\u89e3\u6790 {domain} \u5931\u8d25: {e}')\r\n        print(f'\u89e3\u6790 {domain} \u5931\u8d25: {e}')\r\n        return {}\r\n\r\ndef check_port(ip, port=80):\r\n    print(f'\u6b63\u5728\u68c0\u67e5 IP {ip} \u7684\u7aef\u53e3 {port} \u662f\u5426\u5f00\u653e...')\r\n    try:\r\n        tn = telnetlib.Telnet(ip, port, timeout=5)\r\n        tn.close()\r\n        print(f'IP {ip} \u7684\u7aef\u53e3 {port} \u662f\u5f00\u653e\u7684\u3002", "top": 0, "createdAt": 1722331565, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-30", "dateLabelColor": "#bc4c00"}, "P51": {"htmlDir": "docs/post/sql_init.html", "labels": ["\u7cfb\u7edf\u67b6\u6784"], "postTitle": "sql_init", "postUrl": "post/sql_init.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/51", "commentNum": 0, "wordCount": 895, "description": "psql -h 172.16.102.147 -p 32002 -U root\r\n\r\nPassw0rd@MY\r\n\r\nshow timezone;\r\n\r\nset time zone 'Asia/Shanghai';\r\n\r\nSELECT * FROM pg_timezone_names WHERE name = current_setting('TIMEZONE');\r\n\r\nroot=# CREATE DATABASE netbox;\r\nCREATE DATABASE\r\nroot=# CREATE USER netbox WITH PASSWORD 'Passw0rd@MY';\r\nCREATE ROLE\r\nroot=# GRANT ALL PRIVILEGES ON DATABASE netbox TO netbox;\r\nGRANT\r\nroot=#\r\n\u68c0\u67e5\u65f6\u533a\r\nroot=# show timezone;\r\nroot=# SELECT * FROM pg_timezone_names WHERE name = current_setting('TIMEZONE');\r\nroot=# set time zone 'Asia/Shanghai';\r\n\u521b\u5efa\u7528\u6237\uff08\u5e76\u7ed9\u5b83\u4e00\u4e2a\u5bc6\u7801\uff09\uff0c\u6388\u4e88\u8bbf\u95ee\u6743\u9650\r\nroot=#create database kea;\r\nroot=# create user kea with password  'Passw0rd@MY';\r\nroot=# GRANT ALL PRIVILEGES ON DATABASE kea TO kea;\r\n\u9000\u51fa\r\nroot=# \\q\r\n\r\npsql -h 172.16.102.118 -p 32002  -d kea -U kea -f dhcpdb_create.pgsql\r\n\r\nALTER DATABASE kea SET timezone TO 'Asia/Shanghai';\r\n\r\nkubectl rollout restart statefulset -n cncp-system\r\n\r\n\r\n\r\n\r\n\r\n\r\n\u3002", "top": 0, "createdAt": 1722476650, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-08-01", "dateLabelColor": "#bc4c00"}, "P52": {"htmlDir": "docs/post/ntp_timeset_chrony.conf.html", "labels": ["\u914d\u7f6e\u6587\u4ef6"], "postTitle": "ntp_timeset_chrony.conf", "postUrl": "post/ntp_timeset_chrony.conf.html", "postSourceUrl": "https://github.com/donkeytt11111/jiaxin.github.io/issues/52", "commentNum": 0, "wordCount": 1200, "description": "```config\r\nbindaddress 0.0.0.0\r\nbindaddress ::\r\ndriftfile /var/lib/chrony/drift\r\nlogdir /var/log/chrony\r\nmakestep 1.0 3\r\nrtcsync\r\nminsources 3\r\nlocal stratum 10\r\nratelimit interval 1 burst 16\r\nserver ntp.tencent.com iburst minpoll 6 maxpoll 24\r\nserver ntp1.tencent.com iburst minpoll 6 maxpoll 24\r\nserver ntp2.tencent.com iburst minpoll 6 maxpoll 24\r\nserver ntp3.tencent.com iburst minpoll 6 maxpoll 24\r\nserver ntp4.tencent.com iburst minpoll 6 maxpoll 24\r\nserver ntp5.tencent.com iburst minpoll 6 maxpoll 24\r\nserver ntp.aliyun.com iburst minpoll 6 maxpoll 24\r\nserver ntp1.aliyun.com iburst minpoll 6 maxpoll 24\r\nserver ntp2.aliyun.com iburst minpoll 6 maxpoll 24\r\nserver ntp3.aliyun.com iburst minpoll 6 maxpoll 24\r\nserver ntp4.aliyun.com iburst minpoll 6 maxpoll 24\r\nserver ntp5.aliyun.com iburst minpoll 6 maxpoll 24\r\nserver ntp6.aliyun.com iburst minpoll 6 maxpoll 24\r\nserver ntp7.aliyun.com iburst minpoll 6 maxpoll 24\r\npool 0.pool.ntp.org iburst minpoll 6 maxpoll 24 maxsources 3\r\npool 1.pool.ntp.org iburst minpoll 6 maxpoll 24 maxsources 3\r\npool 2.pool.ntp.org iburst minpoll 6 maxpoll 24 maxsources 3\r\npool 3.pool.ntp.org iburst minpoll 6 maxpoll 24 maxsources 3\r\nallow 0.0.0.0/0\r\nallow ::/0\u3002", "top": 0, "createdAt": 1723101565, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-08-08", "dateLabelColor": "#bc4c00"}}, "singeListJson": {}, "labelColorDict": {"DevOps": "#CF22EF", "Docker": "#c5def5", "helm": "#1d76db", "K8S": "#d876e3", "python": "#E20F63", "shell": "#008672", "yaml": "#6A8FE3", "\u7cfb\u7edf\u67b6\u6784": "#3A7D1B", "\u90e8\u7f72": "#a2eeef", "\u914d\u7f6e\u6587\u4ef6": "#fef2c0", "\u95ee\u9898\u89e3\u51b3\u65b9\u6848": "#7057ff"}, "displayTitle": "\u5218\u4f73\u946b\u7b14\u8bb0", "faviconUrl": "https://github.githubassets.com/favicons/favicon.svg", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "primerCSS": "<link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />", "homeUrl": "https://donkeytt11111.github.io/jiaxin.github.io", "prevUrl": "/page3.html", "nextUrl": "disabled"}